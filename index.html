<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no">
    <title>TAU AFRICA INTERNATIONAL</title>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <style>
        /* Safari/iOS Compatibility Fixes */
* {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
}

body {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

/* Fix buttons on iOS */
button, input[type="submit"], input[type="button"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    cursor: pointer;
}

/* Fix inputs on iOS */
input, select, textarea {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    border-radius: 10px;
}

/* Fix modal scrolling on iOS */
.modal {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

.modal-content {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

/* Fix for Safari date input */
input[type="date"] {
    -webkit-appearance: none;
    appearance: none;
    min-height: 44px;
}

/* Fix button clicks on iOS */
.btn, .level-btn, .house-btn, .corporate-btn {
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
}
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298, #87ceeb);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #000080, #4169e1, #87ceeb);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .emancipation-scroll {
            position: absolute;
            bottom: 5px;
            left: 0;
            width: 100%;
            height: 20px;
            overflow: hidden;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 10px;
        }

        .emancipation-text {
            display: inline-block;
            white-space: nowrap;
            font-size: 12px;
            font-weight: bold;
            color: #ffd700;
            animation: scrollText 15s linear infinite;
            line-height: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        @keyframes scrollText {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .logo {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #87ceeb, #4169e1);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border: 4px solid #ffd700;
        }

        .main-title {
            font-size: 2.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 2px;
        }

        .vision {
            font-size: 1.2rem;
            font-style: italic;
            opacity: 0.9;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .social-link {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .social-link:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .wings-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .wing {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .wing:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .auffi {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .valenta {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .wing-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .wing-description {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .houses-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .house-btn, .corporate-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: bold;
        }

        .house-btn:hover, .corporate-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .galaxy-banner {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            margin-top: 15px;
        }

        .main-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .section {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2a5298;
            margin-bottom: 15px;
            text-align: center;
        }

        .btn {
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-block;
            text-decoration: none;
        }

        .btn:hover {
            background: linear-gradient(45deg, #2a5298, #4169e1);
            transform: scale(1.05);
        }

        .btn-register {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            font-size: 1.1rem;
            padding: 15px 30px;
        }

        .btn-kabiru {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            font-weight: bold;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: #000;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2a5298;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #4169e1;
            outline: none;
        }

        .payment-info {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .level-btn {
            padding: 10px;
            border: 2px solid #4169e1;
            background: rgba(65, 105, 225, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .level-btn.selected {
            background: #4169e1;
            color: white;
        }

        .kabiru-section {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            text-align: center;
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
        }

        .payment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .payment-widget {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .payment-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 16px;
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4169e1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1001;
            display: none;
            max-width: 350px;
        }

        .success { background: #2ecc71; }
        .error { background: #e74c3c; }

        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .ai-assistant {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 100;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .ai-chat-window {
            position: fixed;
            bottom: 170px;
            right: 30px;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 200;
        }

        .ai-chat-header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 15px 20px;
            border-radius: 20px 20px 0 0;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 300px;
        }

        .ai-message {
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 15px;
            margin: 10px 0;
            max-width: 80%;
        }

        .user-message {
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            color: white;
            margin-left: auto;
        }

        .ai-chat-input {
            display: flex;
            padding: 15px;
            border-top: 1px solid #eee;
        }

        .ai-chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        .ai-chat-input button {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            margin-left: 10px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .wings-container {
                grid-template-columns: 1fr;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .houses-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-window {
                width: 90%;
                right: 5%;
                left: 5%;
            }
            
            .social-links {
                gap: 10px;
            }
            
            .social-link {
                font-size: 12px;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">üåç TAU</div>
            <h1 class="main-title">TAU AFRICA INTERNATIONAL</h1>
            <p class="vision">Community ‚Ä¢ Value ‚Ä¢ Corporate ‚Ä¢ Sovereignty</p>
            
            <!-- Social Media Links -->
            <div class="social-links">
                <a href="https://x.com/grouptauafrica?t=pFlJ-gky_A7Dp3e0lbZ5Sg&s=09" target="_blank" class="social-link">
                    üê¶ Twitter/X
                </a>
                <a href="https://www.tiktok.com/@tau.africa.nairob?_t=ZM-8zwbvmFtmt2&_r=1" target="_blank" class="social-link">
                    üéµ TikTok
                </a>
                <a href="https://youtube.com/@tauafrica8922?si=wwgxc2AvYHYwsHTh" target="_blank" class="social-link">
                    üì∫ YouTube
                </a>
                <span class="social-link" style="opacity: 0.7;">
                    üìò Facebook (Coming Soon)
                </span>
            </div>
            
            <div class="emancipation-scroll">
                <div class="emancipation-text">EMANCIPATION PROCLAMATIONS ‚Ä¢ FREEDOM FOR ALL AFRICANS ‚Ä¢ UNITY IN DIVERSITY ‚Ä¢ ECONOMIC LIBERATION ‚Ä¢ SPIRITUAL AWAKENING ‚Ä¢ SOCIAL JUSTICE</div>
            </div>
        </div>

        <!-- Two Wings -->
        <div class="wings-container">
            <!-- AUFFI Wing -->
            <div class="wing auffi">
                <h2 class="wing-title">üåç AUFFI</h2>
                <p class="wing-description">Africa Unity Freedom Fund Initiative. The Pan African Digital value Currency for uniting and awakening Africa socially, economically and spiritually. A movement that return Oloo's Sovereignty back home to Africa, bringing together the children of Oloo and the Galaxy restoration to rebuild Africa</p>
                
                <div class="houses-grid">
                    <div class="house-btn" onclick="showNotification('Galaxy 0 house - join with G0 Card!', 'success')">Galaxy 0 [Secretariat Board G0]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 1 house - join with G1 Card!', 'success')">Galaxy 1 [Representative Board]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 2 house - join with G2 Card!', 'success')">Galaxy 2 [Coordination Board  ]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 3 house - join with G3 Card!', 'success')">Galaxy 3 [Implementation Board]</div>
                </div>
                
                <div class="galaxy-banner">
                    Auffi - Pan African Trust Graph & R4<br> [REPARTRIATION - RESURRECTION-RESTORATION - RECONNECTION] (sovereignty). Our digital Ecosystem uses human & environmental values to create the Africa's Sovereign Wealth, and subsequently bring back Sovereignty to black people and humanity. join the Kabiru Mining App to mine your values in building The African digital currency (Kabiru)
                </div>
                
                <button class="btn" onclick="openModal('parSirai')">Par Sirai Center</button>
            </div>

            <!-- Valenta Wing -->
            <div class="wing valenta">
                <h2 class="wing-title">üè¢ VALENTA</h2>
                <p class="wing-description">Value Enter Africa - Our Corporate Holding company, building Kabiru Digital currency for Africa value harnessing, erecting a sustainable Kabiru digital ecosystem, & Empowering African communities through Education - Economic and Social Literacy. Come let us build our sovereignty together, and make Africa great again</p>

                <div class="houses-grid">
                    <div class="corporate-btn" onclick="openModal('corporate')">Corporate company</div>
                    <div class="corporate-btn" onclick="openModal('trustGraph')">Generation Trust Graph</div>
                    <div class="corporate-btn" onclick="openModal('foundation')">Family Foundation</div>
                    <div class="corporate-btn" onclick="openModal('holdings')">Holding Company</div>
                </div>
            </div>
        </div>

        <!-- Main Sections -->
        <div class="main-sections">
            <!-- Membership Registration -->
            <div class="section">
                <h3 class="section-title">üë• MEMBERSHIP</h3>
                <p>Join our community through TASK & TALK teams</p>
                <button class="btn btn-register" onclick="openModal('taskRegistration')">Join TASK Team</button>
                <button class="btn btn-register" onclick="openModal('talkRegistration')">Join TALK Team</button>
                <p style="margin-top: 15px; font-weight: bold; color: #e74c3c;">TASK Fee: KSH 500 | TALK Fee: KSH 2,000</p>
            </div>

            <!-- Activity Area -->
            <div class="section">
                <h3 class="section-title">üìö ACTIVITIES</h3>
                <p>Training workshops, job creation & research services</p>
                <button class="btn" onclick="openModal('training')">Join member training</button>
                <button class="btn" onclick="openModal('workshop')">Host corporate Workshop</button>
                <button class="btn" onclick="openModal('research')">Research Services</button>
                <button class="btn" onclick="openModal('jobCreation')">Job Creation workshop</button>
            </div>

            <!-- Jobs Area -->
            <div class="section">
                <h3 class="section-title">üíº TASKS</h3>
                <p>Connect job seekers with verified opportunities</p>
                <button class="btn" onclick="openModal('insertJob')">Insert value</button>
                <button class="btn" onclick="openModal('retrieveJob')">Search value</button>
                <button class="btn" onclick="openModal('availableJobs')">Browse value</button>
                <button class="btn" onclick="openModal('applyJob')">seek value</button>
            </div>

            <!-- Community -->
            <div class="section">
                <h3 class="section-title">ü§ù COMMUNITY</h3>
                <p>Community support programs</p>
                <button class="btn" onclick="openModal('community')">Join Programs</button>
                <div style="margin-top: 10px; font-size: 0.9rem;">
                    Agriculture ‚Ä¢ Climate ‚Ä¢ Environment<br>
                    Water & Sanitation ‚Ä¢ Education ‚Ä¢ Child Care
                </div>
            </div>

            <!-- Interactive Forum -->
            <div class="section">
                <h3 class="section-title">üí¨ MEMBER FORUM</h3>
                <p>Connect, share ideas, and collaborate with fellow members</p>
                <button class="btn" onclick="openModal('forum')">Access Forum</button>
                <div style="margin-top: 10px; font-size: 0.9rem;">
                    Discussions ‚Ä¢ Job Sharing ‚Ä¢ Training Materials<br>
                    Voice Calls ‚Ä¢ Messaging ‚Ä¢ Networking
                </div>
            </div>
        </div>

        <!-- Kabiru Mining Section -->
        <div class="kabiru-section">
            <h2>‚ö° KABIRU MINING</h2>
            <p>Mine Kabiru coins by proving and validating real values</p>
            <button class="btn-kabiru" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')">Access Kabiru Mining App</button>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Floating Member Access Button -->
    <div class="floating-btn" onclick="showMemberLogin()" title="Member Access">üë§</div>

    <!-- AI Assistant -->
    <div class="ai-assistant" onclick="toggleAIChat()" title="AI Assistant - Get Help">ü§ñ</div>

    <!-- AI Chat Window -->
    <div class="ai-chat-window" id="aiChatWindow">
        <div class="ai-chat-header">
            <span>TAU AI Assistant</span>
            <span onclick="toggleAIChat()" style="cursor: pointer;">‚úñ</span>
        </div>
        <div class="ai-chat-messages" id="aiChatMessages">
            <div class="ai-message">
                Hello! I'm your TAU Africa AI assistant. I can help you with:
                <br>‚Ä¢ Navigating the app
                <br>‚Ä¢ Understanding registration process
                <br>‚Ä¢ Payment procedures
                <br>‚Ä¢ Technical support
                <br>‚Ä¢ General questions about TAU Africa
                <br><br>How can I assist you today?
            </div>
        </div>
        <div class="ai-chat-input">
            <input type="text" id="aiChatInput" placeholder="Ask me anything..." onkeypress="handleAIChatKeyPress(event)">
            <button onclick="sendAIMessage()">‚û§</button>
        </div>
    </div>

<script>
// Initialize EmailJS with iOS compatibility
(function() {
    try {
        emailjs.init({
            publicKey: "GhjI14eQVGgOli0j1",
        });
        console.log('‚úÖ EmailJS initialized successfully');
    } catch (error) {
        console.error('‚ùå EmailJS initialization failed:', error);
        alert('Email system initialization failed. Please refresh the page.');
    }
})();
    
// Global variables
let currentModal = null;
let selectedLevel = '';
let selectedCategory = '';

// ===== FIXED EMAIL SENDING FUNCTION =====
function sendEmailToOrganization(formData, subject) {
    console.log('üìß Attempting to send email...');
    console.log('Subject:', subject);
    console.log('Form Data:', formData);

    // Create detailed message content
    let messageContent = `${subject}\n\n`;
    for (let key in formData) {
        if (formData.hasOwnProperty(key)) {
            messageContent += `${key}: ${formData[key]}\n`;
        }
    }
    messageContent += `\nSubmitted: ${new Date().toLocaleString()}`;

    const templateParams = {
        from_name: formData.fullName || formData.name || formData.contactName || 'TAU Africa User',
        from_email: formData.email || 'noreply@tauafrica.com',
        subject: subject,
        message: messageContent,
        phone: formData.phone || 'Not provided',
        location: formData.location || formData.country || 'Not provided'
    };

    console.log('üì® Sending email with template: template_bqxztig');
    console.log('üì® Template params:', templateParams);

    return emailjs.send('service_xfira7g', 'template_bqxztig', templateParams)
        .then(function(response) {
            console.log('‚úÖ SUCCESS! Email sent:', response.status, response.text);
            console.log('‚úÖ Full response:', response);
            return true;
        })
        .catch(function(error) {
            console.error('‚ùå FAILED! Email error:', error);
            console.error('‚ùå Error status:', error.status);
            console.error('‚ùå Error text:', error.text);
            console.error('‚ùå Full error object:', error);
            return false;
        });
}

// ===== M-PESA PAYMENT INTEGRATION =====
function initiateMpesaPayment(amount, phoneNumber, formData, successCallback) {
    showPaymentModal(amount, phoneNumber, formData, successCallback);
}

function showPaymentModal(amount, phoneNumber, formData, successCallback) {
    const paymentModal = document.createElement('div');
    paymentModal.className = 'payment-modal';
    paymentModal.innerHTML = `
        <div class="payment-widget">
            <h3>üì± M-PESA Payment</h3>
            <div class="payment-step">
                <h4>Amount: KSH ${amount}</h4>
                <p>Phone: ${phoneNumber}</p>
                <p style="color: #666; font-size: 0.9em;">A payment prompt will be sent to your phone</p>
            </div>
            <div id="paymentSteps">
                <div style="margin: 20px 0; padding: 15px; background: #f0f8ff; border-radius: 10px;">
                    <p><strong>Payment Process:</strong></p>
                    <ol style="text-align: left; margin-top: 10px;">
                        <li>Check your phone for M-PESA prompt</li>
                        <li>Enter your M-PESA PIN</li>
                        <li>Confirm the payment</li>
                        <li>Wait for confirmation</li>
                    </ol>
                </div>
                <input type="text" class="payment-input" placeholder="Enter confirmation code (if received)" id="confirmationCode">
                <button class="btn" onclick="simulatePayment(${amount}, '${phoneNumber}')">Confirm Payment</button>
            </div>
            <button class="btn" style="background: #e74c3c; margin-top: 20px;" onclick="cancelPayment()">Cancel Payment</button>
        </div>
    `;
    paymentModal.formData = formData;
    paymentModal.successCallback = successCallback;
    document.body.appendChild(paymentModal);
}

function simulatePayment(amount, phoneNumber) {
    const paymentModal = document.querySelector('.payment-modal');
    const confirmationCode = document.getElementById('confirmationCode').value;
    
    if (confirmationCode.length < 4) {
        showNotification('Please enter a valid confirmation code', 'error');
        return;
    }

    paymentModal.innerHTML = `
        <div class="payment-widget">
            <h3>Processing Payment...</h3>
            <div class="spinner"></div>
            <p>Verifying M-PESA transaction</p>
            <p style="font-size: 0.9em; color: #666;">Transaction ID: MPX${Date.now()}</p>
        </div>
    `;

    setTimeout(() => {
        if (Math.random() > 0.05) {
            const storedFormData = paymentModal.formData;
            const callback = paymentModal.successCallback;
            
            paymentModal.remove();
            
            if (callback === 'processTaskSuccess') {
                processTaskSuccess(storedFormData);
            } else if (callback === 'processTalkSuccess') {
                processTalkSuccess(storedFormData);
            } else if (callback === 'processJobCreationSuccess') {
                processJobCreationSuccess(storedFormData);
            }
            
            showNotification(`M-PESA payment of KSH ${amount} successful! Transaction ID: MPX${Date.now()}`, 'success');
        } else {
            paymentModal.remove();
            showNotification('Payment failed. Please try again or contact support.', 'error');
        }
    }, 3000);
}

function cancelPayment() {
    document.querySelector('.payment-modal')?.remove();
    showNotification('Payment cancelled', 'error');
}

// ===== NOTIFICATION SYSTEM =====
function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    notification.innerHTML = message;
    notification.className = `notification ${type}`;
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 6000);
}

// ===== MODAL MANAGEMENT =====
function openModal(type) {
    closeAllModals();
    
    const modalContent = getModalContent(type);
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = modalContent;
    document.body.appendChild(modal);
    currentModal = modal;
}

function closeAllModals() {
    const modals = document.querySelectorAll('.modal, .payment-modal');
    modals.forEach(modal => modal.remove());
    currentModal = null;
}

// ===== SELECTION FUNCTIONS =====
function selectLevel(level, element) {
    const buttons = document.querySelectorAll('.level-btn');
    buttons.forEach(btn => btn.classList.remove('selected'));
    const target = element || (window.event && window.event.target);
    if (target) {
        target.classList.add('selected');
    }
    selectedLevel = level;
    const levelInput = document.getElementById('supportLevel');
    if (levelInput) levelInput.value = level;
    
    const enhanced = document.getElementById('enhancedRequirements');
    if (enhanced && (level === 'middle' || level === 'upper' || level === 'high' || level === 'top')) {
        enhanced.style.display = 'block';
    }
}

function selectCategory(category, element) {
    const buttons = document.querySelectorAll('.level-btn');
    buttons.forEach(btn => btn.classList.remove('selected'));
    const target = element || (window.event && window.event.target);
    if (target) {
        target.classList.add('selected');
    }
    selectedCategory = category;
    const categoryInput = document.getElementById('taskCategory');
    if (categoryInput) categoryInput.value = category;
}

// ===== FORM SUBMISSION HANDLERS =====
function processTaskRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email || !selectedCategory) {
        showNotification('Please fill all required fields and select a category', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    data.category = selectedCategory;
    initiateMpesaPayment(500, data.phone, data, 'processTaskSuccess');
}

function processTalkRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email || !selectedLevel) {
        showNotification('Please fill all required fields and select a support level', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    data.supportLevel = selectedLevel;
    initiateMpesaPayment(2000, data.phone, data, 'processTalkSuccess');
}

function processJobCreationTraining(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email) {
        showNotification('Please fill all required fields', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    initiateMpesaPayment(1500, data.phone, data, 'processJobCreationSuccess');
}

// ===== TAU AFRICA DATABASE SYNC MODULE =====
// Database Configuration
const DB_CONFIG = {
    dbKey: 'tauAfricaDB',
    apiEndpoint: window.location.origin, // Same domain sync
    autoSync: true,
    enableEmailNotifications: true
};

// Generate unique member ID with referral tracking
function generateMemberID(team, referralCode = null) {
    const prefix = team === 'TASK' ? 'TSK' : team === 'TALK' ? 'TLK' : 'JOB';
    const timestamp = Date.now().toString().slice(-6);
    const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
    const id = `${prefix}-${timestamp}-${random}`;
    
    // Track referral if provided
    if (referralCode) {
        trackReferral(referralCode, id);
    }
    
    return id;
}

// Generate referral code for member
function generateReferralCode(memberId) {
    return btoa(memberId).substring(0, 8).toUpperCase();
}

// Track referral and award iKbp points
function trackReferral(referralCode, newMemberId) {
    try {
        const referrals = JSON.parse(localStorage.getItem('tauReferrals') || '{}');
        
        // Find referrer by code
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const referrer = members.find(m => m.referralCode === referralCode);
        
        if (referrer) {
            if (!referrals[referrer.id]) {
                referrals[referrer.id] = {
                    memberId: referrer.id,
                    referredMembers: [],
                    totalEarnings: 0
                };
            }
            
            // Award 500 iKbp (50 KSH) per successful referral
            const earnings = 500;
            referrals[referrer.id].referredMembers.push({
                memberId: newMemberId,
                date: new Date().toISOString(),
                earnings: earnings
            });
            referrals[referrer.id].totalEarnings += earnings;
            
            localStorage.setItem('tauReferrals', JSON.stringify(referrals));
            
            // Send notification to referrer
            sendReferralNotification(referrer, earnings);
        }
    } catch (error) {
        console.error('Referral tracking error:', error);
    }
}

// Send referral notification
function sendReferralNotification(referrer, earnings) {
    emailjs.send('service_xfira7g', 'template_bqxztig', {
        to_email: referrer.email,
        to_name: referrer.fullName,
        subject: 'üéâ Referral Bonus Earned!',
        message: `Congratulations! You've earned ${earnings} iKbp (${earnings/10} KSH) from your referral. Your total earnings: ${getReferralEarnings(referrer.id)} iKbp.`
    }).catch(err => console.error('Referral email error:', err));
}

// Get total referral earnings
function getReferralEarnings(memberId) {
    const referrals = JSON.parse(localStorage.getItem('tauReferrals') || '{}');
    return referrals[memberId]?.totalEarnings || 0;
}

// Core Database Sync Function
function syncToDatabase(formData, team, referralCode = null) {
    try {
        const dbKey = DB_CONFIG.dbKey;
        const existingMembers = JSON.parse(localStorage.getItem(dbKey) || '[]');
        
        // Generate unique Member ID
        const memberId = generateMemberID(team, referralCode);
        
        // Generate referral code for new member
        const memberReferralCode = generateReferralCode(memberId);
        
        // Create comprehensive member object
        const member = {
            id: memberId,
            referralCode: memberReferralCode,
            team: team,
            fullName: formData.fullName || formData.name,
            email: formData.email,
            phone: formData.phone,
            location: formData.location,
            paymentStatus: 'Paid',
            dateJoined: new Date().toISOString().split('T')[0],
            status: 'Active',
            fee: team === 'TASK' ? 500 : team === 'TALK' ? 2000 : 1500,
            accountCreated: new Date().toISOString(),
            lastLogin: null,
            activities: [],
            tasks: [],
            jobs: [],
            iKbpBalance: 0, // Initial Kabiru points
            referredBy: referralCode || null
        };
        
        // Add team-specific fields
        if (team === 'TASK') {
            member.dateOfBirth = formData.dateOfBirth;
            member.gender = formData.gender;
            member.nationality = formData.nationality;
            member.category = formData.category;
            member.valueDescription = formData.valueDescription;
            member.experience = formData.experience;
            member.certifications = formData.certifications;
            member.languages = formData.languages;
            member.goodConduct = formData.goodConduct;
            member.healthStatus = formData.healthStatus;
            member.trackRecord = formData.trackRecord;
            member.familySupport = formData.familySupport;
            member.education = formData.education;
            member.emergencyContact = formData.emergencyContact;
            member.referralSource = formData.referralSource;
        } else if (team === 'TALK') {
            member.organizationType = formData.organizationType;
            member.website = formData.website;
            member.supportLevel = formData.supportLevel;
            member.supportTypes = formData.supportTypes;
            member.focusAreas = formData.focusAreas;
            member.geographicFocus = formData.geographicFocus;
            member.investmentCriteria = formData.investmentCriteria;
            member.previousInvestments = formData.previousInvestments;
            member.goodConduct = formData.goodConduct;
            member.healthStatus = formData.healthStatus;
            member.financialTrack = formData.financialTrack;
            member.netWorth = formData.netWorth;
            member.familyFinancial = formData.familyFinancial;
        } else if (team === 'JOB_CREATION') {
            member.ageRange = formData.ageRange;
            member.employmentStatus = formData.employmentStatus;
            member.businessIdea = formData.businessIdea;
            member.targetMarket = formData.targetMarket;
            member.startupFunds = formData.startupFunds;
            member.education = formData.education;
            member.relevantSkills = formData.relevantSkills;
            member.focus = formData.focus;
            member.learningFormat = formData.learningFormat;
            member.businessTimeline = formData.businessTimeline;
        }
        
        // Add to database
        existingMembers.push(member);
        localStorage.setItem(dbKey, JSON.stringify(existingMembers));
        
        // Store member credentials for login
        storeMemberCredentials(member);
        
        // Trigger database event for real-time sync
        window.dispatchEvent(new CustomEvent('tauMemberAdded', { 
            detail: member 
        }));
        
        console.log('‚úÖ Member synced to database:', memberId);
        return { success: true, memberId, member };
        
    } catch (error) {
        console.error('‚ùå Database sync error:', error);
        return { success: false, error: error.message };
    }
}

// Store member credentials for authentication
function storeMemberCredentials(member) {
    const credentials = JSON.parse(localStorage.getItem('tauCredentials') || '{}');
    credentials[member.id] = {
        email: member.email,
        phone: member.phone.slice(-4), // Last 4 digits for security
        fullName: member.fullName
    };
    localStorage.setItem('tauCredentials', JSON.stringify(credentials));
}

// Authenticate member
function authenticateMember(identifier, phoneLastFour) {
    try {
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const member = members.find(m => 
            (m.id === identifier || m.email === identifier) && 
            m.phone.slice(-4) === phoneLastFour
        );
        
        if (member) {
            // Update last login
            member.lastLogin = new Date().toISOString();
            const memberIndex = members.findIndex(m => m.id === member.id);
            members[memberIndex] = member;
            localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
            
            // Store session
            sessionStorage.setItem('tauCurrentUser', JSON.stringify(member));
            return { success: true, member };
        }
        
        return { success: false, error: 'Invalid credentials' };
    } catch (error) {
        console.error('Authentication error:', error);
        return { success: false, error: error.message };
    }
}

// Get current logged-in member
function getCurrentMember() {
    const sessionData = sessionStorage.getItem('tauCurrentUser');
    return sessionData ? JSON.parse(sessionData) : null;
}

// Logout member
function logoutMember() {
    sessionStorage.removeItem('tauCurrentUser');
    return true;
}

// Update member data
function updateMemberData(memberId, updates) {
    try {
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const memberIndex = members.findIndex(m => m.id === memberId);
        
        if (memberIndex !== -1) {
            members[memberIndex] = { ...members[memberIndex], ...updates };
            localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
            
            // Update session if current user
            const currentUser = getCurrentMember();
            if (currentUser && currentUser.id === memberId) {
                sessionStorage.setItem('tauCurrentUser', JSON.stringify(members[memberIndex]));
            }
            
            return { success: true, member: members[memberIndex] };
        }
        
        return { success: false, error: 'Member not found' };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Add activity to member
function addMemberActivity(memberId, activity) {
    try {
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const member = members.find(m => m.id === memberId);
        
        if (member) {
            if (!member.activities) member.activities = [];
            
            const activityRecord = {
                id: `ACT-${Date.now()}`,
                type: activity.type,
                description: activity.description,
                dateAdded: new Date().toISOString(),
                status: 'Active',
                iKbpEarned: 0
            };
            
            member.activities.push(activityRecord);
            updateMemberData(memberId, { activities: member.activities });
            
            return { success: true, activity: activityRecord };
        }
        
        return { success: false, error: 'Member not found' };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Add task to member
function addMemberTask(memberId, task) {
    try {
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const member = members.find(m => m.id === memberId);
        
        if (member) {
            if (!member.tasks) member.tasks = [];
            
            const taskRecord = {
                id: `TSK-${Date.now()}`,
                title: task.title,
                description: task.description,
                category: task.category,
                dateAssigned: new Date().toISOString(),
                dueDate: task.dueDate || null,
                status: 'Assigned',
                iKbpReward: task.reward || 100,
                completedDate: null
            };
            
            member.tasks.push(taskRecord);
            updateMemberData(memberId, { tasks: member.tasks });
            
            return { success: true, task: taskRecord };
        }
        
        return { success: false, error: 'Member not found' };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Complete task and award iKbp
function completeTask(memberId, taskId) {
    try {
        const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
        const member = members.find(m => m.id === memberId);
        
        if (member && member.tasks) {
            const task = member.tasks.find(t => t.id === taskId);
            
            if (task && task.status !== 'Completed') {
                task.status = 'Completed';
                task.completedDate = new Date().toISOString();
                
                // Award iKbp points
                member.iKbpBalance = (member.iKbpBalance || 0) + task.iKbpReward;
                
                updateMemberData(memberId, { 
                    tasks: member.tasks,
                    iKbpBalance: member.iKbpBalance
                });
                
                return { 
                    success: true, 
                    task, 
                    newBalance: member.iKbpBalance,
                    earned: task.iKbpReward
                };
            }
        }
        
        return { success: false, error: 'Task not found or already completed' };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Post job/value to public portal
function postJobToPortal(jobData, posterId) {
    try {
        const jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
        
        const job = {
            id: `JOB-${Date.now()}`,
            posterId: posterId,
            ...jobData,
            datePosted: new Date().toISOString(),
            status: 'Active',
            applications: []
        };
        
        jobs.push(job);
        localStorage.setItem('tauJobsPortal', JSON.stringify(jobs));
        
        // Award poster 50 iKbp for contributing
        const result = updateMemberData(posterId, {
            iKbpBalance: (getCurrentMember().iKbpBalance || 0) + 50
        });
        
        return { success: true, job, iKbpEarned: 50 };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Get jobs from portal
function getJobsFromPortal(filters = {}) {
    try {
        let jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
        
        // Apply filters
        if (filters.category) {
            jobs = jobs.filter(j => j.category === filters.category);
        }
        if (filters.location) {
            jobs = jobs.filter(j => j.location.toLowerCase().includes(filters.location.toLowerCase()));
        }
        if (filters.status) {
            jobs = jobs.filter(j => j.status === filters.status);
        }
        
        return { success: true, jobs };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Apply for job
function applyForJob(jobId, memberId, applicationData) {
    try {
        const jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
        const job = jobs.find(j => j.id === jobId);
        
        if (job) {
            const application = {
                id: `APP-${Date.now()}`,
                memberId: memberId,
                ...applicationData,
                dateApplied: new Date().toISOString(),
                status: 'Pending'
            };
            
            job.applications.push(application);
            localStorage.setItem('tauJobsPortal', JSON.stringify(jobs));
            
            return { success: true, application };
        }
        
        return { success: false, error: 'Job not found' };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Send welcome email with credentials
function sendWelcomeEmailWithCredentials(member) {
    const templateParams = {
        to_email: member.email,
        to_name: member.fullName,
        subject: 'üéâ Welcome to TAU Africa - Your Account Details',
        message: `
Welcome to TAU Africa Foundation!

Your account has been successfully created:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Member ID: ${member.id}
Team: ${member.team}
Referral Code: ${member.referralCode}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

LOGIN INSTRUCTIONS:
1. Use your Member ID or Email: ${member.email}
2. Use last 4 digits of your phone: ${member.phone.slice(-4)}

REFERRAL REWARDS:
Share your referral code and earn 500 iKbp (50 KSH) for each successful referral!
Your referral link: ${window.location.origin}?ref=${member.referralCode}

ACCESS YOUR ACCOUNT:
‚Ä¢ Main Portal: ${window.location.origin}
‚Ä¢ Database: [Your Database URL]
‚Ä¢ Kabiru Mining: https://magero1985.github.io/Kabiru-Mining-Portal-/

Start earning Kabiru points (iKbp) by:
‚Ä¢ Completing tasks
‚Ä¢ Participating in activities
‚Ä¢ Referring new members
‚Ä¢ Contributing to the community

Current Balance: ${member.iKbpBalance} iKbp (${member.iKbpBalance/10} KSH)

Welcome to the movement!
TAU Africa Foundation
        `
    };
    
    return emailjs.send('service_xfira7g', 'template_bqxztig', templateParams);
}

// Export functions for use in Main App
window.TauDB = {
    sync: syncToDatabase,
    authenticate: authenticateMember,
    getCurrentMember,
    logout: logoutMember,
    updateMember: updateMemberData,
    addActivity: addMemberActivity,
    addTask: addMemberTask,
    completeTask,
    postJob: postJobToPortal,
    getJobs: getJobsFromPortal,
    applyJob: applyForJob,
    sendWelcomeEmail: sendWelcomeEmailWithCredentials,
    getReferralEarnings,
    generateReferralCode
};

console.log('‚úÖ TAU Database Sync Module Loaded');
// ===== UPDATED SUCCESS HANDLERS FOR MAIN APP =====

// Check for referral code in URL
function checkReferralCode() {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('ref');
}

// ===== TASK TEAM SUCCESS =====
function processTaskSuccess(formData) {
    console.log('Processing TASK registration with database sync...');
    
    const referralCode = checkReferralCode();
    
    // üî• SYNC TO DATABASE WITH REFERRAL TRACKING
    const syncResult = window.TauDB.sync(formData, 'TASK', referralCode);
    
    if (syncResult.success) {
        const member = syncResult.member;
        
        // Send welcome email with credentials
        window.TauDB.sendWelcomeEmail(member)
            .then(() => {
                console.log('‚úÖ Welcome email sent');
            })
            .catch(err => {
                console.error('Email error:', err);
            });
        
        // Send to organization
        sendEmailToOrganization(formData, 'NEW TASK TEAM REGISTRATION - PAYMENT CONFIRMED')
            .then(() => {
                console.log('‚úÖ Organization notified');
            });
        
        // Show success with member details
        showNotification(
            `‚úÖ Registration Complete!\n\n` +
            `Member ID: ${member.id}\n` +
            `Referral Code: ${member.referralCode}\n\n` +
            `Share your referral code and earn 500 iKbp (50 KSH) per referral!`,
            'success'
        );
        
        // Show detailed modal with credentials
        showSuccessModal(member);
        
        closeAllModals();
    } else {
        showNotification(`‚ö†Ô∏è Registration processed but sync failed: ${syncResult.error}`, 'error');
    }
}

// ===== TALK TEAM SUCCESS =====
function processTalkSuccess(formData) {
    console.log('Processing TALK registration with database sync...');
    
    const referralCode = checkReferralCode();
    
    // üî• SYNC TO DATABASE WITH REFERRAL TRACKING
    const syncResult = window.TauDB.sync(formData, 'TALK', referralCode);
    
    if (syncResult.success) {
        const member = syncResult.member;
        
        // Send welcome email with credentials
        window.TauDB.sendWelcomeEmail(member)
            .then(() => {
                console.log('‚úÖ Welcome email sent');
            })
            .catch(err => {
                console.error('Email error:', err);
            });
        
        // Send to organization
        sendEmailToOrganization(formData, 'NEW TALK TEAM REGISTRATION - PAYMENT CONFIRMED')
            .then(() => {
                console.log('‚úÖ Organization notified');
            });
        
        // Show success with member details
        showNotification(
            `‚úÖ Registration Complete!\n\n` +
            `Member ID: ${member.id}\n` +
            `Referral Code: ${member.referralCode}\n\n` +
            `Share your referral code and earn 500 iKbp (50 KSH) per referral!`,
            'success'
        );
        
        // Show detailed modal with credentials
        showSuccessModal(member);
        
        closeAllModals();
    } else {
        showNotification(`‚ö†Ô∏è Registration processed but sync failed: ${syncResult.error}`, 'error');
    }
}

// ===== JOB CREATION SUCCESS =====
function processJobCreationSuccess(formData) {
    console.log('Processing Job Creation enrollment with database sync...');
    
    const referralCode = checkReferralCode();
    
    // üî• SYNC TO DATABASE
    const syncResult = window.TauDB.sync(formData, 'JOB_CREATION', referralCode);
    
    if (syncResult.success) {
        const member = syncResult.member;
        
        // Send welcome email with credentials
        window.TauDB.sendWelcomeEmail(member)
            .then(() => {
                console.log('‚úÖ Welcome email sent');
            })
            .catch(err => {
                console.error('Email error:', err);
            });
        
        // Send to organization
        sendEmailToOrganization(formData, 'JOB CREATION TRAINING ENROLLMENT - PAYMENT CONFIRMED')
            .then(() => {
                console.log('‚úÖ Organization notified');
            });
        
        showNotification(
            `‚úÖ Training Enrollment Complete!\n\n` +
            `Member ID: ${member.id}\n` +
            `Referral Code: ${member.referralCode}`,
            'success'
        );
        
        showSuccessModal(member);
        
        closeAllModals();
    } else {
        showNotification(`‚ö†Ô∏è Enrollment processed but sync failed: ${syncResult.error}`, 'error');
    }
}

// ===== SUCCESS MODAL WITH CREDENTIALS =====
function showSuccessModal(member) {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <h2 style="color: #2ecc71; text-align: center;">üéâ Registration Successful!</h2>
            
            <div style="background: linear-gradient(45deg, #4169e1, #87ceeb); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                <h3>Your Member ID</h3>
                <h1 style="font-size: 2.5rem; margin: 15px 0; letter-spacing: 2px;">${member.id}</h1>
                <p style="font-size: 1.1rem;">Save this ID - You'll need it to login!</p>
            </div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">üìß Login Credentials</h4>
                <p><strong>Email:</strong> ${member.email}</p>
                <p><strong>Phone (last 4 digits):</strong> ${member.phone.slice(-4)}</p>
                <p style="margin-top: 15px;"><strong>Team:</strong> ${member.team}</p>
                <p><strong>Membership Fee:</strong> KSH ${member.fee}</p>
            </div>
            
            <div style="background: linear-gradient(45deg, #ffd700, #ffed4e); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #333; margin-bottom: 10px;">üí∞ Referral Program</h4>
                <p style="color: #333;"><strong>Your Referral Code:</strong></p>
                <h2 style="color: #333; margin: 10px 0; letter-spacing: 3px;">${member.referralCode}</h2>
                <p style="color: #333; font-size: 0.9rem;">Share this code and earn 500 iKbp (50 KSH) for each successful referral!</p>
                <button class="btn" onclick="copyReferralLink('${member.referralCode}')" style="margin-top: 10px;">
                    üìã Copy Referral Link
                </button>
            </div>
            
            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #1976d2;">üì® Welcome Email Sent</h4>
                <p>Check your email (${member.email}) for:</p>
                <ul style="margin-top: 10px;">
                    <li>Complete login instructions</li>
                    <li>Your referral link</li>
                    <li>Getting started guide</li>
                    <li>Kabiru Mining access</li>
                </ul>
            </div>
            
            <div style="margin-top: 30px;">
                <button class="btn" onclick="proceedToLogin()" style="width: 100%; font-size: 1.1rem;">
                    üöÄ Access Your Account Now
                </button>
                <button class="btn btn-secondary" onclick="this.closest('.modal').remove()" style="width: 100%; margin-top: 10px;">
                    Close
                </button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// Copy referral link
function copyReferralLink(referralCode) {
    const link = `${window.location.origin}?ref=${referralCode}`;
    navigator.clipboard.writeText(link).then(() => {
        showNotification('‚úÖ Referral link copied to clipboard!', 'success');
    }).catch(() => {
        prompt('Copy your referral link:', link);
    });
}

// Proceed to login
function proceedToLogin() {
    closeAllModals();
    showRealMemberLogin();
}

// ===== REAL MEMBER LOGIN (NO DEMO) =====
function showRealMemberLogin() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2 style="color: #2a5298; text-align: center;">Member Login</h2>
            <p style="text-align: center; color: #666;">Access your TAU Africa account</p>
            
            <form onsubmit="processRealLogin(event)" style="margin-top: 30px;">
                <div class="form-group">
                    <label>Member ID or Email *</label>
                    <input type="text" id="loginIdentifier" required placeholder="Enter your Member ID or Email">
                </div>
                
                <div class="form-group">
                    <label>Phone Number (Last 4 digits) *</label>
                    <input type="text" id="loginPhone" required placeholder="Last 4 digits" maxlength="4" pattern="[0-9]{4}">
                    <small>Use the last 4 digits of your registered phone number</small>
                </div>
                
                <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">
                    üîê Login to Dashboard
                </button>
            </form>
            
            <div style="text-align: center; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                <p style="font-size: 0.9rem; color: #666;">Don't have an account?</p>
                <button class="btn btn-small" onclick="closeAllModals(); openModal('taskRegistration')" style="margin: 5px;">
                    Join TASK Team
                </button>
                <button class="btn btn-small" onclick="closeAllModals(); openModal('talkRegistration')" style="margin: 5px;">
                    Join TALK Team
                </button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// Process real login
function processRealLogin(event) {
    event.preventDefault();
    
    const identifier = document.getElementById('loginIdentifier').value.trim();
    const phoneLastFour = document.getElementById('loginPhone').value.trim();
    
    const result = window.TauDB.authenticate(identifier, phoneLastFour);
    
    if (result.success) {
        showNotification('‚úÖ Login successful! Loading your dashboard...', 'success');
        
        setTimeout(() => {
            closeAllModals();
            showRealMemberDashboard(result.member);
        }, 1000);
    } else {
        showNotification('‚ùå Invalid credentials. Please check your Member ID/Email and phone number.', 'error');
    }
}

// Update the floating member access button
function showMemberLogin() {
    showRealMemberLogin();
}

// Add to window load
document.addEventListener('DOMContentLoaded', function() {
    // Check for referral code
    const ref = checkReferralCode();
    if (ref) {
        showNotification(`üéÅ You're using referral code: ${ref}. The referrer will earn 500 iKbp when you complete registration!`, 'info');
    }
});

console.log('‚úÖ Main App Success Handlers Updated - Real Authentication Enabled');
// ===== OTHER FORM SUBMISSIONS WITH FIXED EMAIL =====
function processTrainingRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting training registration...');
    sendEmailToOrganization(data, 'TRAINING PROGRAM REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Training registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processWorkshopProposal(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting workshop proposal...');
    sendEmailToOrganization(data, 'WORKSHOP PROPOSAL SUBMISSION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Workshop proposal submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processResearchRequest(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting research request...');
    sendEmailToOrganization(data, 'RESEARCH SERVICES REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Research request submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobPosting(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job posting...');
    sendEmailToOrganization(data, 'NEW JOB POSTING')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Job posting submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobSearch(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job search...');
    sendEmailToOrganization(data, 'JOB SEARCH REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Job search submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobApplication(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job application...');
    sendEmailToOrganization(data, 'JOB APPLICATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Application submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processCommunityRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting community registration...');
    sendEmailToOrganization(data, 'COMMUNITY PROGRAM REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Community registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processCorporateRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting corporate registration...');
    sendEmailToOrganization(data, 'CORPORATE REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Corporate registration submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processParSiraiRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Par Sirai registration...');
    sendEmailToOrganization(data, 'PAR SIRAI CENTER REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Par Sirai registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processTrustGraphAccess(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Trust Graph access...');
    sendEmailToOrganization(data, 'TRUST GRAPH ACCESS REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Trust Graph access requested! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processFoundationInquiry(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Foundation inquiry...');
    sendEmailToOrganization(data, 'FOUNDATION INQUIRY')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Foundation inquiry submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processHoldingsInquiry(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Holdings inquiry...');
    sendEmailToOrganization(data, 'COMPANY HOLDINGS INQUIRY')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Holdings inquiry submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

// ===== AI ASSISTANT FUNCTIONS =====
function toggleAIChat() {
    const chatWindow = document.getElementById('aiChatWindow');
    if (chatWindow.style.display === 'none' || !chatWindow.style.display) {
        chatWindow.style.display = 'flex';
    } else {
        chatWindow.style.display = 'none';
    }
}

function handleAIChatKeyPress(event) {
    if (event.key === 'Enter') {
        sendAIMessage();
    }
}

function sendAIMessage() {
    const input = document.getElementById('aiChatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    const messagesContainer = document.getElementById('aiChatMessages');
    
    const userMessage = document.createElement('div');
    userMessage.className = 'ai-message user-message';
    userMessage.textContent = message;
    messagesContainer.appendChild(userMessage);
    
    input.value = '';
    
    setTimeout(() => {
        const aiResponse = generateAIResponse(message);
        const aiMessage = document.createElement('div');
        aiMessage.className = 'ai-message';
        aiMessage.innerHTML = aiResponse;
        messagesContainer.appendChild(aiMessage);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }, 1000);
    
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function generateAIResponse(userMessage) {
    const message = userMessage.toLowerCase();
    
    if (message.includes('register') || message.includes('join')) {
        return `To register with TAU Africa, you can choose between:<br>
        ‚Ä¢ <strong>TASK Team (KSH 500)</strong> - For service providers and skilled professionals<br>
        ‚Ä¢ <strong>TALK Team (KSH 2,000)</strong> - For investors and financial supporters<br>
        ‚Ä¢ <strong>Job Creation Training (KSH 1,500)</strong> - For aspiring entrepreneurs<br>
        <br>Click the relevant buttons in the Membership section to get started!`;
    }
    
    if (message.includes('payment') || message.includes('mpesa')) {
        return `Our payment process uses M-PESA:<br>
        1. Enter your M-PESA number (254XXXXXXXXX format)<br>
        2. You'll receive a payment prompt on your phone<br>
        3. Enter your M-PESA PIN to confirm<br>
        4. Wait for confirmation<br>
        <br>All payments are secure and processed instantly!`;
    }
    
    if (message.includes('kabiru') || message.includes('mining')) {
        return `Kabiru is our digital currency! You can:<br>
        ‚Ä¢ Mine Kabiru by validating real values in the community<br>
        ‚Ä¢ Use the mining portal<br>
        ‚Ä¢ Earn through community contributions<br>
        ‚Ä¢ Convert to other currencies through our ecosystem`;
    }
    
    if (message.includes('help') || message.includes('support')) {
        return `I'm here to help! You can ask me about:<br>
        ‚Ä¢ Registration processes and payments<br>
        ‚Ä¢ Kabiru mining and digital currency<br>
        ‚Ä¢ Community programs and training<br>
        ‚Ä¢ Technical issues with the app<br>
        ‚Ä¢ Business registration services<br>
        <br>What specific area would you like help with?`;
    }
    
    return `Thank you for your question! Here are some ways I can help:<br>
    ‚Ä¢ Registration and membership information<br>
    ‚Ä¢ Payment and M-PESA guidance<br>
    ‚Ä¢ Kabiru mining and digital currency<br>
    ‚Ä¢ Community programs and forum access<br>
    ‚Ä¢ Technical support<br>
    <br>Please ask a specific question, or contact <strong>grouptauafrica@gmail.com</strong> for detailed support.`;
}

// ===== MEMBER LOGIN FUNCTIONS =====
function showMemberLogin() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>Member Login</h2>
            <p>Access your TAU Africa member dashboard</p>
            
            <form onsubmit="simulateLogin(event)">
                <div class="form-group">
                    <label>Email or Member ID</label>
                    <input type="text" name="loginId" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required>
                </div>
                <button type="submit" class="btn">Login to Dashboard</button>
                
                <div style="text-align: center; margin-top: 20px;">
                    <p>New member? Complete registration through TASK or TALK teams first!</p>
                </div>
            </form>
            
            <div style="background: #f0f8ff; padding: 15px; border-radius: 10px; margin-top: 20px;">
                <h4>Demo Access:</h4>
                <p>Use any email/password to see dashboard preview</p>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

function simulateLogin(event) {
    event.preventDefault();
    showNotification('Login successful! Loading dashboard...', 'success');
    setTimeout(() => {
        closeAllModals();
        showMemberDashboard();
    },
});
    // ===== REAL MEMBER DASHBOARD - FULL FEATURED =====

function showRealMemberDashboard(member) {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.style.overflowY = 'auto';
    
    // Refresh member data to get latest
    const currentMember = window.TauDB.getCurrentMember();
    const displayMember = currentMember || member;
    
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 1200px; padding: 20px;">
            <span class="close" onclick="memberLogout(); this.parentElement.parentElement.remove()">&times;</span>
            
            <!-- Header -->
            <div style="background: linear-gradient(45deg, #4169e1, #87ceeb); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                <h1 style="margin: 0 0 10px 0;">Welcome, ${displayMember.fullName}! üëã</h1>
                <p style="margin: 0; opacity: 0.9;">Member ID: <strong>${displayMember.id}</strong> | Team: <strong>${displayMember.team}</strong></p>
                <p style="margin: 10px 0 0 0; font-size: 0.9rem;">Last login: ${displayMember.lastLogin ? new Date(displayMember.lastLogin).toLocaleString() : 'First login'}</p>
            </div>
            
            <!-- Dashboard Tabs -->
            <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #eee; flex-wrap: wrap;">
                <button class="dashboard-tab active" onclick="switchDashboardTab('overview', this)">üìä Overview</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('profile', this)">üë§ Profile</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('activities', this)">üìö Activities</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('tasks', this)">‚úÖ Tasks</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('jobs', this)">üíº Jobs</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('referrals', this)">üí∞ Referrals</button>
                <button class="dashboard-tab" onclick="switchDashboardTab('forum', this)">üí¨ Forum</button>
            </div>
            
            <!-- Overview Tab -->
            <div id="dashboard-overview" class="dashboard-tab-content">
                ${createOverviewTab(displayMember)}
            </div>
            
            <!-- Profile Tab -->
            <div id="dashboard-profile" class="dashboard-tab-content" style="display: none;">
                ${createProfileTab(displayMember)}
            </div>
            
            <!-- Activities Tab -->
            <div id="dashboard-activities" class="dashboard-tab-content" style="display: none;">
                ${createActivitiesTab(displayMember)}
            </div>
            
            <!-- Tasks Tab -->
            <div id="dashboard-tasks" class="dashboard-tab-content" style="display: none;">
                ${createTasksTab(displayMember)}
            </div>
            
            <!-- Jobs Tab -->
            <div id="dashboard-jobs" class="dashboard-tab-content" style="display: none;">
                ${createJobsTab(displayMember)}
            </div>
            
            <!-- Referrals Tab -->
            <div id="dashboard-referrals" class="dashboard-tab-content" style="display: none;">
                ${createReferralsTab(displayMember)}
            </div>
            
            <!-- Forum Tab -->
            <div id="dashboard-forum" class="dashboard-tab-content" style="display: none;">
                ${createForumTab(displayMember)}
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Add dashboard styling
    addDashboardStyles();
}

// Switch dashboard tabs
function switchDashboardTab(tabName, button) {
    // Update tab buttons
    document.querySelectorAll('.dashboard-tab').forEach(btn => btn.classList.remove('active'));
    button.classList.add('active');
    
    // Update content
    document.querySelectorAll('.dashboard-tab-content').forEach(content => {
        content.style.display = 'none';
    });
    document.getElementById('dashboard-' + tabName).style.display = 'block';
    
    // Refresh data for specific tabs
    if (tabName === 'tasks') {
        refreshTasksDisplay();
    } else if (tabName === 'jobs') {
        refreshJobsDisplay();
    }
}

// Create Overview Tab
function createOverviewTab(member) {
    const totalEarnings = window.TauDB.getReferralEarnings(member.id);
    const activeTasks = (member.tasks || []).filter(t => t.status !== 'Completed').length;
    const completedTasks = (member.tasks || []).filter(t => t.status === 'Completed').length;
    
    return `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <!-- iKbp Balance Card -->
            <div style="background: linear-gradient(135deg, #ffd700, #ffed4e); padding: 25px; border-radius: 15px; text-align: center; color: #333;">
                <h3 style="margin: 0 0 10px 0;">üí∞ Kabiru Points</h3>
                <h1 style="margin: 0; font-size: 2.5rem;">${member.iKbpBalance || 0}</h1>
                <p style="margin: 10px 0 0 0;">iKbp ‚âà KSH ${((member.iKbpBalance || 0) / 10).toFixed(2)}</p>
                <button class="btn" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')" style="margin-top: 15px; background: #333; width: 100%;">
                    ‚ö° Mine More Kabiru
                </button>
            </div>
            
            <!-- Tasks Card -->
            <div style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                <h3 style="margin: 0 0 10px 0;">‚úÖ Tasks</h3>
                <h1 style="margin: 0; font-size: 2.5rem;">${activeTasks}</h1>
                <p style="margin: 10px 0 0 0;">Active | ${completedTasks} Completed</p>
                <button class="btn" onclick="switchDashboardTab('tasks', document.querySelectorAll('.dashboard-tab')[3])" style="margin-top: 15px; width: 100%;">
                    View Tasks
                </button>
            </div>
            
            <!-- Activities Card -->
            <div style="background: linear-gradient(135deg, #ff6b6b, #ee5a24); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                <h3 style="margin: 0 0 10px 0;">üìö Activities</h3>
                <h1 style="margin: 0; font-size: 2.5rem;">${(member.activities || []).length}</h1>
                <p style="margin: 10px 0 0 0;">Enrolled Programs</p>
                <button class="btn" onclick="switchDashboardTab('activities', document.querySelectorAll('.dashboard-tab')[2])" style="margin-top: 15px; width: 100%;">
                    Manage Activities
                </button>
            </div>
            
            <!-- Referrals Card -->
            <div style="background: linear-gradient(135deg, #2ecc71, #27ae60); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                <h3 style="margin: 0 0 10px 0;">üéÅ Referrals</h3>
                <h1 style="margin: 0; font-size: 2.5rem;">${totalEarnings}</h1>
                <p style="margin: 10px 0 0 0;">iKbp Earned</p>
                <button class="btn" onclick="switchDashboardTab('referrals', document.querySelectorAll('.dashboard-tab')[5])" style="margin-top: 15px; width: 100%;">
                    View Referrals
                </button>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
            <h3 style="color: #2a5298; margin-bottom: 20px;">‚ö° Quick Actions</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <button class="btn" onclick="viewDatabaseAccount()">üóÑÔ∏è View Database Account</button>
                <button class="btn btn-success" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')">‚ö° Kabiru Mining</button>
                <button class="btn" onclick="copyReferralLink('${member.referralCode}')">üìã Copy Referral Link</button>
                <button class="btn" onclick="contactSupport()">üí¨ Contact Support</button>
            </div>
        </div>
        
        <!-- Recent Activity -->
        <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee;">
            <h3 style="color: #2a5298; margin-bottom: 20px;">üìä Recent Activity</h3>
            ${createRecentActivityList(member)}
        </div>
    `;
}

// Create Profile Tab
function createProfileTab(member) {
    return `
        <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee;">
            <h3 style="color: #2a5298; margin-bottom: 20px;">üë§ Your Profile</h3>
            
            <div style="display: grid; gap: 15px;">
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Member ID:</strong>
                    <span>${member.id}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Full Name:</strong>
                    <span>${member.fullName}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Email:</strong>
                    <span>${member.email}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Phone:</strong>
                    <span>${member.phone}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Location:</strong>
                    <span>${member.location}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Team:</strong>
                    <span>${member.team}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Date Joined:</strong>
                    <span>${member.dateJoined}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Status:</strong>
                    <span style="color: #2ecc71; font-weight: bold;">${member.status}</span>
                </div>
                <div style="display: grid; grid-template-columns: 150px 1fr; padding: 15px; border-bottom: 1px solid #eee;">
                    <strong style="color: #2a5298;">Referral Code:</strong>
                    <span style="font-weight: bold; color: #ffd700;">${member.referralCode}</span>
                </div>
            </div>
            
            <div style="margin-top: 30px;">
                <button class="btn" onclick="viewDatabaseAccount()" style="width: 100%;">
                    üóÑÔ∏è View Complete Profile in Database
                </button>
            </div>
        </div>
    `;
}

// Create Activities Tab
function createActivitiesTab(member) {
    const activities = member.activities || [];
    
    return `
        <div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: #2a5298; margin: 0;">üìö My Activities</h3>
                <button class="btn btn-small" onclick="addNewActivity()">‚ûï Add Activity</button>
            </div>
            
            ${activities.length === 0 ? `
                <div style="background: #f8f9fa; padding: 40px; border-radius: 15px; text-align: center;">
                    <h3 style="color: #999;">No Activities Yet</h3>
                    <p>Join programs and activities to start earning iKbp!</p>
                    <button class="btn" onclick="addNewActivity()">Browse Available Activities</button>
                </div>
            ` : `
                <div style="display: grid; gap: 15px;">
                    ${activities.map(activity => `
                        <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #eee;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <h4 style="color: #2a5298; margin: 0 0 10px 0;">${activity.type}</h4>
                                    <p style="margin: 0 0 10px 0; color: #666;">${activity.description}</p>
                                    <p style="margin: 0; font-size: 0.9rem; color: #999;">
                                        Started: ${new Date(activity.dateAdded).toLocaleDateString()} | 
                                        Status: <span style="color: #2ecc71; font-weight: bold;">${activity.status}</span>
                                    </p>
                                    ${activity.iKbpEarned > 0 ? `
                                        <p style="margin: 10px 0 0 0; color: #ffd700; font-weight: bold;">
                                            üí∞ Earned: ${activity.iKbpEarned} iKbp
                                        </p>
                                    ` : ''}
                                </div>
                                <div>
                                    <button class="btn btn-small" onclick="trackActivity('${activity.id}')">üìä Track</button>
                                    <button class="btn btn-small" onclick="removeActivity('${activity.id}')" style="background: #e74c3c; margin-top: 5px;">Remove</button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `}
            
            <!-- Available Activities -->
            <div style="margin-top: 30px; padding: 25px; background: #e3f2fd; border-radius: 15px;">
                <h4 style="color: #1976d2; margin-bottom: 15px;">üåü Available Activities</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <button class="btn" onclick="enrollActivity('Training Workshop')">üìö Training</button>
                    <button class="btn" onclick="enrollActivity('Job Creation')">üíº Job Creation</button>
                    <button class="btn" onclick="enrollActivity('Research Services')">üî¨ Research</button>
                    <button class="btn" onclick="enrollActivity('Community Program')">ü§ù Community</button>
                </div>
            </div>
        </div>
    `;
}

// Continue in next artifact due to length...
console.log('‚úÖ Member Dashboard Part 1 Loaded');
    // ===== MEMBER DASHBOARD PART 2 - Tasks, Jobs, Referrals, Forum =====

// Create Tasks Tab
function createTasksTab(member) {
    const tasks = member.tasks || [];
    const activeTasks = tasks.filter(t => t.status !== 'Completed');
    const completedTasks = tasks.filter(t => t.status === 'Completed');
    
    return `
        <div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: #2a5298; margin: 0;">‚úÖ My Tasks</h3>
                <button class="btn btn-small" onclick="browseAvailableTasks()">üîç Browse Tasks</button>
            </div>
            
            <!-- Task Stats -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; text-align: center;">
                    <h2 style="color: #1976d2; margin: 0;">${activeTasks.length}</h2>
                    <p style="margin: 5px 0 0 0; color: #666;">Active Tasks</p>
                </div>
                <div style="background: #c8e6c9; padding: 15px; border-radius: 10px; text-align: center;">
                    <h2 style="color: #2e7d32; margin: 0;">${completedTasks.length}</h2>
                    <p style="margin: 5px 0 0 0; color: #666;">Completed</p>
                </div>
                <div style="background: #fff3e0; padding: 15px; border-radius: 10px; text-align: center;">
                    <h2 style="color: #e65100; margin: 0;">${completedTasks.reduce((sum, t) => sum + (t.iKbpReward || 0), 0)}</h2>
                    <p style="margin: 5px 0 0 0; color: #666;">iKbp Earned</p>
                </div>
            </div>
            
            ${tasks.length === 0 ? `
                <div style="background: #f8f9fa; padding: 40px; border-radius: 15px; text-align: center;">
                    <h3 style="color: #999;">No Tasks Assigned Yet</h3>
                    <p>Browse available tasks to start earning iKbp!</p>
                    <button class="btn" onclick="browseAvailableTasks()">Browse Available Tasks</button>
                </div>
            ` : `
                <!-- Active Tasks -->
                ${activeTasks.length > 0 ? `
                    <h4 style="color: #2a5298; margin: 20px 0 15px 0;">üéØ Active Tasks</h4>
                    <div style="display: grid; gap: 15px; margin-bottom: 25px;">
                        ${activeTasks.map(task => `
                            <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #4169e1;">
                                <div style="display: flex; justify-content: space-between; align-items: start;">
                                    <div style="flex: 1;">
                                        <h4 style="color: #2a5298; margin: 0 0 10px 0;">${task.title}</h4>
                                        <p style="margin: 0 0 10px 0; color: #666;">${task.description}</p>
                                        <div style="display: flex; gap: 15px; font-size: 0.9rem; color: #999; margin-bottom: 10px;">
                                            <span>üìÅ ${task.category}</span>
                                            <span>üìÖ Assigned: ${new Date(task.dateAssigned).toLocaleDateString()}</span>
                                            ${task.dueDate ? `<span>‚è∞ Due: ${new Date(task.dueDate).toLocaleDateString()}</span>` : ''}
                                        </div>
                                        <p style="margin: 0; color: #ffd700; font-weight: bold;">
                                            üí∞ Reward: ${task.iKbpReward} iKbp (${(task.iKbpReward/10).toFixed(2)} KSH)
                                        </p>
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 5px;">
                                        <button class="btn btn-small btn-success" onclick="markTaskComplete('${task.id}')">‚úì Complete</button>
                                        <button class="btn btn-small" onclick="viewTaskDetails('${task.id}')">View Details</button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                <!-- Completed Tasks -->
                ${completedTasks.length > 0 ? `
                    <h4 style="color: #2a5298; margin: 20px 0 15px 0;">‚úÖ Completed Tasks</h4>
                    <div style="display: grid; gap: 15px;">
                        ${completedTasks.map(task => `
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border: 2px solid #2ecc71;">
                                <div style="display: flex; justify-content: space-between; align-items: start;">
                                    <div style="flex: 1;">
                                        <h4 style="color: #2a5298; margin: 0 0 10px 0;">${task.title}</h4>
                                        <p style="margin: 0 0 10px 0; color: #666;">${task.description}</p>
                                        <div style="display: flex; gap: 15px; font-size: 0.9rem; color: #999;">
                                            <span>‚úì Completed: ${new Date(task.completedDate).toLocaleDateString()}</span>
                                            <span style="color: #2ecc71; font-weight: bold;">üí∞ Earned: ${task.iKbpReward} iKbp</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `}
        </div>
    `;
}

// Create Jobs Tab
function createJobsTab(member) {
    return `
        <div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: #2a5298; margin: 0;">üíº Jobs & Values Portal</h3>
            </div>
            
            <!-- Job Actions -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <button class="btn" onclick="postNewJob()">üìù Post New Job/Value</button>
                <button class="btn" onclick="searchJobs()">üîç Search Jobs</button>
                <button class="btn" onclick="browseAllJobs()">üìã Browse All Jobs</button>
                <button class="btn" onclick="viewMyApplications()">üì® My Applications</button>
            </div>
            
            <!-- My Posted Jobs -->
            <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee; margin-bottom: 20px;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">üìù My Posted Jobs/Values</h4>
                <div id="myPostedJobs">
                    ${displayMyPostedJobs(member.id)}
                </div>
            </div>
            
            <!-- Available Jobs -->
            <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">üåü Available Jobs/Values</h4>
                <div id="availableJobs">
                    ${displayAvailableJobs()}
                </div>
            </div>
        </div>
    `;
}

// Create Referrals Tab
function createReferralsTab(member) {
    const referralData = JSON.parse(localStorage.getItem('tauReferrals') || '{}');
    const myReferrals = referralData[member.id] || { referredMembers: [], totalEarnings: 0 };
    const referralLink = `${window.location.origin}?ref=${member.referralCode}`;
    
    return `
        <div>
            <h3 style="color: #2a5298; margin-bottom: 20px;">üí∞ Referral Program</h3>
            
            <!-- Referral Stats -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <div style="background: linear-gradient(135deg, #ffd700, #ffed4e); padding: 25px; border-radius: 15px; text-align: center;">
                    <h2 style="color: #333; margin: 0 0 10px 0;">${myReferrals.totalEarnings}</h2>
                    <p style="color: #333; margin: 0;">Total iKbp Earned</p>
                    <p style="color: #333; margin: 5px 0 0 0; font-size: 0.9rem;">‚âà KSH ${(myReferrals.totalEarnings/10).toFixed(2)}</p>
                </div>
                <div style="background: linear-gradient(135deg, #2ecc71, #27ae60); padding: 25px; border-radius: 15px; text-align: center; color: white;">
                    <h2 style="margin: 0 0 10px 0;">${myReferrals.referredMembers.length}</h2>
                    <p style="margin: 0;">Successful Referrals</p>
                    <p style="margin: 5px 0 0 0; font-size: 0.9rem;">500 iKbp per referral</p>
                </div>
            </div>
            
            <!-- Referral Link -->
            <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="margin: 0 0 15px 0;">üéÅ Your Referral Code</h4>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    <h1 style="margin: 0; font-size: 2.5rem; letter-spacing: 3px;">${member.referralCode}</h1>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px; word-break: break-all;">
                    <p style="margin: 0; font-size: 0.9rem;">${referralLink}</p>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="btn" onclick="copyReferralLink('${member.referralCode}')" style="background: white; color: #667eea;">
                        üìã Copy Link
                    </button>
                    <button class="btn" onclick="shareReferralLink('${member.referralCode}')" style="background: white; color: #667eea;">
                        üì§ Share
                    </button>
                </div>
            </div>
            
            <!-- How It Works -->
            <div style="background: #e3f2fd; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="color: #1976d2; margin-bottom: 15px;">üí° How Referrals Work</h4>
                <ul style="margin: 0; padding-left: 20px; color: #333;">
                    <li style="margin-bottom: 10px;">Share your referral code with friends and family</li>
                    <li style="margin-bottom: 10px;">They register using your code</li>
                    <li style="margin-bottom: 10px;">You earn <strong>500 iKbp (50 KSH)</strong> for each successful registration</li>
                    <li style="margin-bottom: 10px;">Convert your iKbp to cash at Kabiru Mining Portal</li>
                    <li>No limit on referrals - earn unlimited rewards!</li>
                </ul>
            </div>
            
            <!-- Referral History -->
            ${myReferrals.referredMembers.length > 0 ? `
                <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee;">
                    <h4 style="color: #2a5298; margin-bottom: 15px;">üìä Referral History</h4>
                    <div style="display: grid; gap: 10px;">
                        ${myReferrals.referredMembers.map(ref => `
                            <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <p style="margin: 0; font-weight: bold;">${ref.memberId}</p>
                                    <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #666;">
                                        ${new Date(ref.date).toLocaleDateString()}
                                    </p>
                                </div>
                                <div style="text-align: right;">
                                    <p style="margin: 0; color: #2ecc71; font-weight: bold;">+${ref.earnings} iKbp</p>
                                    <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #666;">‚âà KSH ${(ref.earnings/10).toFixed(2)}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            ` : `
                <div style="background: #f8f9fa; padding: 40px; border-radius: 15px; text-align: center;">
                    <h3 style="color: #999;">No Referrals Yet</h3>
                    <p>Start sharing your referral code to earn iKbp!</p>
                </div>
            `}
        </div>
    `;
}

// Create Forum Tab
function createForumTab(member) {
    return `
        <div>
            <h3 style="color: #2a5298; margin-bottom: 20px;">üí¨ Member Forum</h3>
            
            <!-- Forum Categories -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; cursor: pointer;" onclick="openForumCategory('general')">
                    <h4 style="margin: 0 0 10px 0;">üí¨ General Discussions</h4>
                    <p style="margin: 0; opacity: 0.9;">Connect with other members</p>
                </div>
                <div style="background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; padding: 25px; border-radius: 15px; cursor: pointer;" onclick="openForumCategory('jobs')">
                    <h4 style="margin: 0 0 10px 0;">üíº Job Sharing</h4>
                    <p style="margin: 0; opacity: 0.9;">Share and find opportunities</p>
                </div>
                <div style="background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; padding: 25px; border-radius: 15px; cursor: pointer;" onclick="openForumCategory('training')">
                    <h4 style="margin: 0 0 10px 0;">üìö Training & Resources</h4>
                    <p style="margin: 0; opacity: 0.9;">Learn and share knowledge</p>
                </div>
                <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 25px; border-radius: 15px; cursor: pointer;" onclick="openForumCategory('networking')">
                    <h4 style="margin: 0 0 10px 0;">ü§ù Networking</h4>
                    <p style="margin: 0; opacity: 0.9;">Build connections</p>
                </div>
            </div>
            
            <!-- Forum Features -->
            <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">‚ú® Forum Features</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="padding: 15px; background: white; border-radius: 10px;">
                        <h5 style="margin: 0 0 10px 0; color: #2a5298;">üí¨ Discussions</h5>
                        <p style="margin: 0; font-size: 0.9rem; color: #666;">Join conversations with members</p>
                    </div>
                    <div style="padding: 15px; background: white; border-radius: 10px;">
                        <h5 style="margin: 0 0 10px 0; color: #2a5298;">üìû Voice Calls</h5>
                        <p style="margin: 0; font-size: 0.9rem; color: #666;">Connect via voice chat</p>
                    </div>
                    <div style="padding: 15px; background: white; border-radius: 10px;">
                        <h5 style="margin: 0 0 10px 0; color: #2a5298;">üí¨ Messaging</h5>
                        <p style="margin: 0; font-size: 0.9rem; color: #666;">Direct messages to members</p>
                    </div>
                    <div style="padding: 15px; background: white; border-radius: 10px;">
                        <h5 style="margin: 0 0 10px 0; color: #2a5298;">üéØ Groups</h5>
                        <p style="margin: 0; font-size: 0.9rem; color: #666;">Join interest-based groups</p>
                    </div>
                </div>
            </div>
            
            <!-- Recent Forum Activity -->
            <div style="background: white; padding: 25px; border-radius: 15px; border: 2px solid #eee;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">üî• Recent Activity</h4>
                <div style="text-align: center; padding: 40px; color: #999;">
                    <h3>Forum Launching Soon!</h3>
                    <p>Real-time discussions, networking, and collaboration</p>
                    <button class="btn" onclick="joinForumWaitlist()">üì¢ Join Waitlist</button>
                </div>
            </div>
        </div>
    `;
}

// Helper functions
function createRecentActivityList(member) {
    const activities = [];
    
    if (member.tasks && member.tasks.length > 0) {
        const recentTask = member.tasks[member.tasks.length - 1];
        activities.push(`‚Ä¢ Task "${recentTask.title}" ${recentTask.status === 'Completed' ? 'completed' : 'assigned'}`);
    }
    
    if (member.activities && member.activities.length > 0) {
        activities.push(`‚Ä¢ ${member.activities.length} active programs`);
    }
    
    activities.push(`‚Ä¢ Account created on ${new Date(member.accountCreated).toLocaleDateString()}`);
    
    if (activities.length === 0) {
        return '<p style="color: #999;">No recent activity</p>';
    }
    
    return `<ul style="margin: 0; padding-left: 20px;">${activities.map(a => `<li style="margin-bottom: 10px;">${a}</li>`).join('')}</ul>`;
}

function displayMyPostedJobs(memberId) {
    const jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
    const myJobs = jobs.filter(j => j.posterId === memberId);
    
    if (myJobs.length === 0) {
        return '<p style="color: #999; text-align: center;">You haven't posted any jobs yet</p>';
    }
    
    return myJobs.map(job => `
        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
            <h5 style="margin: 0 0 10px 0;">${job.title}</h5>
            <p style="margin: 0; font-size: 0.9rem; color: #666;">Posted: ${new Date(job.datePosted).toLocaleDateString()} | ${job.applications.length} applications</p>
        </div>
    `).join('');
}

function displayAvailableJobs() {
    const jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
    const activeJobs = jobs.filter(j => j.status === 'Active').slice(0, 5);
    
    if (activeJobs.length === 0) {
        return '<p style="color: #999; text-align: center;">No jobs available at the moment</p>';
    }
    
    return activeJobs.map(job => `
        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <div style="flex: 1;">
                <h5 style="margin: 0 0 5px 0;">${job.title}</h5>
                <p style="margin: 0; font-size: 0.9rem; color: #666;">${job.category} ‚Ä¢ ${job.location}</p>
            </div>
            <button class="btn btn-small" onclick="viewJobDetails('${job.id}')">View Details</button>
        </div>
    `).join('');
}

console.log('‚úÖ Member Dashboard Part 2 Loaded - Tasks, Jobs, Referrals, Forum');
    // ===== DASHBOARD INTERACTIVE FUNCTIONS =====

// Member logout
function memberLogout() {
    if (confirm('Are you sure you want to logout?')) {
        window.TauDB.logout();
        closeAllModals();
        showNotification('‚úÖ Logged out successfully', 'success');
    }
}

// View database account
function viewDatabaseAccount() {
    const member = window.TauDB.getCurrentMember();
    if (!member) {
        showNotification('‚ùå Please login first', 'error');
        return;
    }
    
    // Open database in new window with member session
    const dbUrl = prompt(
        'Enter your Database URL:',
        'YOUR_DATABASE_URL_HERE'
    );
    
    if (dbUrl) {
        window.open(dbUrl, '_blank');
        showNotification('Opening your database account...', 'info');
    }
}

// Contact support
function contactSupport() {
    const member = window.TauDB.getCurrentMember();
    const subject = `Support Request from ${member.fullName} (${member.id})`;
    const body = `Member ID: ${member.id}%0D%0AName: ${member.fullName}%0D%0AEmail: ${member.email}%0D%0A%0D%0ARequest:%0D%0A`;
    window.location.href = `mailto:grouptauafrica@gmail.com?subject=${subject}&body=${body}`;
}

// Share referral link
function shareReferralLink(code) {
    const link = `${window.location.origin}?ref=${code}`;
    const text = `Join TAU Africa and help build Africa's future! Use my referral code: ${code}`;
    
    if (navigator.share) {
        navigator.share({
            title: 'Join TAU Africa',
            text: text,
            url: link
        }).catch(err => console.log('Share cancelled'));
    } else {
        copyReferralLink(code);
    }
}

// ===== ACTIVITIES FUNCTIONS =====

// Add new activity
function addNewActivity() {
    const member = window.TauDB.getCurrentMember();
    if (!member) return;
    
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üìö Add New Activity</h2>
            <form onsubmit="enrollNewActivity(event)">
                <div class="form-group">
                    <label>Activity Type *</label>
                    <select name="type" required>
                        <option value="">Select activity</option>
                        <option value="Training Workshop">Training Workshop</option>
                        <option value="Job Creation">Job Creation Program</option>
                        <option value="Research Services">Research Services</option>
                        <option value="Community Program">Community Program</option>
                        <option value="Agricultural Initiative">Agricultural Initiative</option>
                        <option value="Climate Action">Climate Action</option>
                        <option value="Education Program">Education Program</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea name="description" rows="3" placeholder="Describe your goals for this activity"></textarea>
                </div>
                <button type="submit" class="btn">Add Activity</button>
            </form>
        </div>
    `;
    document.body.appendChild(modal);
}

// Enroll in activity
function enrollNewActivity(event) {
    event.preventDefault();
    const member = window.TauDB.getCurrentMember();
    if (!member) return;
    
    const formData = new FormData(event.target);
    const activity = {
        type: formData.get('type'),
        description: formData.get('description') || 'Enrolled in program'
    };
    
    const result = window.TauDB.addActivity(member.id, activity);
    
    if (result.success) {
        showNotification('‚úÖ Activity added successfully!', 'success');
        closeAllModals();
        // Refresh dashboard
        showRealMemberDashboard(window.TauDB.getCurrentMember());
    } else {
        showNotification('‚ùå Failed to add activity', 'error');
    }
}

// Quick enroll activity
function enrollActivity(activityType) {
    const member = window.TauDB.getCurrentMember();
    if (!member) return;
    
    const result = window.TauDB.addActivity(member.id, {
        type: activityType,
        description: `Enrolled in ${activityType} program`
    });
    
    if (result.success) {
        showNotification(`‚úÖ Enrolled in ${activityType}!`, 'success');
        // Refresh activities tab
        switchDashboardTab('activities', document.querySelectorAll('.dashboard-tab')[2]);
    }
}

// Track activity
function trackActivity(activityId) {
    showNotification('Activity tracking feature coming soon!', 'info');
}

// Remove activity
function removeActivity(activityId) {
    if (confirm('Remove this activity from your list?')) {
        const member = window.TauDB.getCurrentMember();
        if (!member) return;
        
        member.activities = member.activities.filter(a => a.id !== activityId);
        window.TauDB.updateMember(member.id, { activities: member.activities });
        
        showNotification('Activity removed', 'success');
        showRealMemberDashboard(window.TauDB.getCurrentMember());
    }
}

// ===== TASKS FUNCTIONS =====

// Browse available tasks
function browseAvailableTasks() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üîç Available Tasks</h2>
            <p>Select tasks to add to your dashboard</p>
            
            <div style="display: grid; gap: 15px; margin-top: 20px;">
                ${generateAvailableTasks()}
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// Generate available tasks
function generateAvailableTasks() {
    const taskTemplates = [
        { title: 'Complete Profile Setup', category: 'Onboarding', reward: 100, description: 'Fill out all profile information' },
        { title: 'Refer 3 Members', category: 'Growth', reward: 500, description: 'Successfully refer 3 new members' },
        { title: 'Attend Training Workshop', category: 'Training', reward: 200, description: 'Participate in next training session' },
        { title: 'Submit Community Feedback', category: 'Engagement', reward: 50, description: 'Share your thoughts on TAU Africa' },
        { title: 'Post 5 Jobs', category: 'Contribution', reward: 250, description: 'Help others by posting job opportunities' },
        { title: 'Complete Market Research', category: 'Research', reward: 300, description: 'Conduct market research in your area' },
        { title: 'Join Community Program', category: 'Community', reward: 150, description: 'Actively participate in community initiative' },
        { title: 'Write Success Story', category: 'Content', reward: 200, description: 'Share your TAU Africa experience' }
    ];
    
    return taskTemplates.map(task => `
        <div style="padding: 20px; background: white; border-radius: 10px; border: 2px solid #eee;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div style="flex: 1;">
                    <h4 style="color: #2a5298; margin: 0 0 10px 0;">${task.title}</h4>
                    <p style="margin: 0 0 10px 0; color: #666;">${task.description}</p>
                    <div style="display: flex; gap: 15px; font-size: 0.9rem;">
                        <span>üìÅ ${task.category}</span>
                        <span style="color: #ffd700; font-weight: bold;">üí∞ ${task.reward} iKbp</span>
                    </div>
                </div>
                <button class="btn btn-small" onclick="acceptTask('${task.title}', '${task.category}', ${task.reward}, '${task.description}')">
                    Accept Task
                </button>
            </div>
        </div>
    `).join('');
}

// Accept task
function acceptTask(title, category, reward, description) {
    const member = window.TauDB.getCurrentMember();
    if (!member) return;
    
    const result = window.TauDB.addTask(member.id, {
        title,
        category,
        reward,
        description,
        dueDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString() // 7 days from now
    });
    
    if (result.success) {
        showNotification(`‚úÖ Task "${title}" added! Complete it to earn ${reward} iKbp`, 'success');
        closeAllModals();
        showRealMemberDashboard(window.TauDB.getCurrentMember());
    }
}

// Mark task complete
function markTaskComplete(taskId) {
    if (confirm('Mark this task as complete?')) {
        const member = window.TauDB.getCurrentMember();
        if (!member) return;
        
        const result = window.TauDB.completeTask(member.id, taskId);
        
        if (result.success) {
            showNotification(
                `üéâ Task completed! You earned ${result.earned} iKbp!\nNew balance: ${result.newBalance} iKbp (${(result.newBalance/10).toFixed(2)} KSH)`,
                'success'
            );
            showRealMemberDashboard(window.TauDB.getCurrentMember());
        } else {
            showNotification('‚ùå Failed to complete task', 'error');
        }
    }
}

// View task details
function viewTaskDetails(taskId) {
    const member = window.TauDB.getCurrentMember();
    const task = member.tasks.find(t => t.id === taskId);
    
    if (!task) return;
    
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>${task.title}</h2>
            <div style="margin: 20px 0;">
                <p><strong>Category:</strong> ${task.category}</p>
                <p><strong>Description:</strong> ${task.description}</p>
                <p><strong>Status:</strong> ${task.status}</p>
                <p><strong>Date Assigned:</strong> ${new Date(task.dateAssigned).toLocaleDateString()}</p>
                ${task.dueDate ? `<p><strong>Due Date:</strong> ${new Date(task.dueDate).toLocaleDateString()}</p>` : ''}
                <p><strong>Reward:</strong> ${task.iKbpReward} iKbp (${(task.iKbpReward/10).toFixed(2)} KSH)</p>
                ${task.completedDate ? `<p><strong>Completed:</strong> ${new Date(task.completedDate).toLocaleDateString()}</p>` : ''}
            </div>
            ${task.status !== 'Completed' ? `
                <button class="btn" onclick="markTaskComplete('${taskId}'); this.closest('.modal').remove();">
                    Mark as Complete
                </button>
            ` : ''}
        </div>
    `;
    document.body.appendChild(modal);
}

// Refresh tasks display
function refreshTasksDisplay() {
    const member = window.TauDB.getCurrentMember();
    if (member) {
        document.getElementById('dashboard-tasks').innerHTML = createTasksTab(member);
    }
}

// ===== JOBS FUNCTIONS =====

// Post new job
function postNewJob() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üìù Post New Job/Value</h2>
            <p>Share opportunities with the community and earn 50 iKbp!</p>
            
            <form onsubmit="submitNewJob(event)">
                <div class="form-group">
                    <label>Job Title *</label>
                    <input type="text" name="title" required>
                </div>
                <div class="form-group">
                    <label>Category *</label>
                    <select name="category" required>
                        <option value="">Select category</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales & Customer Service</option>
                        <option>Education & Training</option>
                        <option>Engineering</option>
                        <option>Finance & Accounting</option>
                        <option>Agriculture & Food</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" name="location" required>
                </div>
                <div class="form-group">
                    <label>Description *</label>
                    <textarea name="description" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Requirements</label>
                    <textarea name="requirements" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Salary Range</label>
                    <input type="text" name="salary" placeholder="e.g., KSH 50,000 - 80,000">
                </div>
                <button type="submit" class="btn">Post Job & Earn 50 iKbp</button>
            </form>
        </div>
    `;
    document.body.appendChild(modal);
}

// Submit new job
function submitNewJob(event) {
    event.preventDefault();
    const member = window.TauDB.getCurrentMember();
    if (!member) return;
    
    const formData = new FormData(event.target);
    const jobData = {
        title: formData.get('title'),
        category: formData.get('category'),
        location: formData.get('location'),
        description: formData.get('description'),
        requirements: formData.get('requirements'),
        salary: formData.get('salary')
    };
    
    const result = window.TauDB.postJob(jobData, member.id);
    
    if (result.success) {
        showNotification(`‚úÖ Job posted successfully! You earned ${result.iKbpEarned} iKbp`, 'success');
        closeAllModals();
        showRealMemberDashboard(window.TauDB.getCurrentMember());
    }
}

// Search jobs
function searchJobs() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üîç Search Jobs</h2>
            
            <div style="display: grid; gap: 15px; margin: 20px 0;">
                <input type="text" id="jobSearchQuery" placeholder="Search by title, category, location..." style="padding: 12px; border: 2px solid #ddd; border-radius: 10px;">
                <button class="btn" onclick="performJobSearch()">Search</button>
            </div>
            
            <div id="searchResults"></div>
        </div>
    `;
    document.body.appendChild(modal);
}

// Perform job search
function performJobSearch() {
    const query = document.getElementById('jobSearchQuery').value.toLowerCase();
    const allJobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
    
    const results = allJobs.filter(job => 
        job.title.toLowerCase().includes(query) ||
        job.category.toLowerCase().includes(query) ||
        job.location.toLowerCase().includes(query)
    );
    
    const resultsDiv = document.getElementById('searchResults');
    if (results.length === 0) {
        resultsDiv.innerHTML = '<p style="text-align: center; color: #999;">No jobs found</p>';
    } else {
        resultsDiv.innerHTML = `
            <h4>Found ${results.length} job(s)</h4>
            ${results.map(job => `
                <div style="padding: 15px; background: #f8f9fa; border-radius: 10px; margin: 10px 0;">
                    <h4>${job.title}</h4>
                    <p>${job.category} ‚Ä¢ ${job.location}</p>
                    <button class="btn btn-small" onclick="viewJobDetails('${job.id}')">View Details</button>
                </div>
            `).join('')}
        `;
    }
}

// Browse all jobs
function browseAllJobs() {
    const result = window.TauDB.getJobs();
    
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>üìã All Available Jobs</h2>
            
            <div style="margin: 20px 0;">
                ${result.jobs.length === 0 ? `
                    <p style="text-align: center; color: #999;">No jobs available at the moment</p>
                ` : result.jobs.map(job => `
                    <div style="padding: 20px; background: white; border-radius: 10px; border: 2px solid #eee; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 10px 0;">${job.title}</h4>
                                <p style="margin: 0; color: #666;">${job.description}</p>
                                <p style="margin: 10px 0 0 0; font-size: 0.9rem; color: #999;">
                                    ${job.category} ‚Ä¢ ${job.location} ‚Ä¢ Posted ${new Date(job.datePosted).toLocaleDateString()}
                                </p>
                            </div>
                            <button class="btn btn-small" onclick="applyToJob('${job.id}')">Apply</button>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// View job details
function viewJobDetails(jobId) {
    const jobs = JSON.parse(localStorage.getItem('tauJobsPortal') || '[]');
    const job = jobs.find(j => j.id === jobId);
    
    if (!job) return;
    
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>${job.title}</h2>
            <div style="margin: 20px 0;">
                <p><strong>Category:</strong> ${job.category}</p>
                <p><strong>Location:</strong> ${job.location}</p>
                <p><strong>Description:</strong> ${job.description}</p>
                ${job.requirements ? `<p><strong>Requirements:</strong> ${job.requirements}</p>` : ''}
                ${job.salary ? `<p><strong>Salary:</strong> ${job.salary}</p>` : ''}
                <p><strong>Posted:</strong> ${new Date(job.datePosted).toLocaleDateString()}</p>
                <p><strong>Applications:</strong> ${job.applications.length}</p>
            </div>
            <button class="btn" onclick="applyToJob('${jobId}'); this.closest('.modal').remove();">
                Apply for This Job
            </button>
        </div>
    `;
    document.body.appendChild(modal);
}

// Apply to job
function applyToJob(jobId) {
    const member = window.TauDB.getCurrentMember();
    if (!member) {
        showNotification('Please login to apply', 'error');
        return;
    }
    
    const applicationData = {
        applicantName: member.fullName,
        applicantEmail: member.email,
        applicantPhone: member.phone,
        coverLetter: 'Application submitted via TAU Africa portal'
    };
    
    const result = window.TauDB.applyJob(jobId, member.id, applicationData);
    
    if (result.success) {
        showNotification('‚úÖ Application submitted successfully!', 'success');
    } else {
        showNotification('‚ùå Failed to submit application', 'error');
    }
}

// View my applications
function viewMyApplications() {
    showNotification('My Applications feature coming soon!', 'info');
}

// Refresh jobs display
function refreshJobsDisplay() {
    const member = window.TauDB.getCurrentMember();
    if (member) {
        document.getElementById('dashboard-jobs').innerHTML = createJobsTab(member);
    }
}

// ===== FORUM FUNCTIONS =====

// Open forum category
function openForumCategory(category) {
    showNotification(`${category} forum launching soon!`, 'info');
}

// Join forum waitlist
function joinForumWaitlist() {
    showNotification('‚úÖ You\'ve been added to the forum waitlist!', 'success');
}

// Add dashboard styles
function addDashboardStyles() {
    if (document.getElementById('dashboardStyles')) return;
    
    const style = document.createElement('style');
    style.id = 'dashboardStyles';
    style.textContent = `
        .dashboard-tab {
            padding: 12px 20px;
            cursor: pointer;
            border: none;
            background: transparent;
            color: #666;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-size: 14px;
        }
        .dashboard-tab.active {
            color: #4169e1;
            border-bottom-color: #4169e1;
        }
        .dashboard-tab:hover {
            color: #4169e1;
            background: rgba(65, 105, 225, 0.05);
        }
        .dashboard-tab-content {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    `;
    document.head.appendChild(style);
}

console.log('‚úÖ Dashboard Interactive Functions Loaded');
// ===== EVENT LISTENERS =====
document.addEventListener('click', function(event) {
    if (event.target.classList.contains('modal')) {
        closeAllModals();
    }
});

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeAllModals();
        document.getElementById('aiChatWindow').style.display = 'none';
    }
});

// ===== INITIALIZE APP =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('========================================');
    console.log('TAU AFRICA INTERNATIONAL - INITIALIZED');
    console.log('========================================');
    console.log('‚úÖ EmailJS Status: ACTIVE & CONFIGURED');
    console.log('‚úÖ Service ID: service_xfira7g');
    console.log('‚úÖ Template ID: template_q2lu285');
    console.log('‚úÖ Recipient: grouptauafrica@gmail.com');
    console.log('‚úÖ M-PESA Payment: READY');
    console.log('‚úÖ All Forms: FUNCTIONAL WITH EMAIL');
    console.log('‚úÖ AI Assistant: ACTIVE');
    console.log('========================================');
    
    showNotification('‚úÖ Welcome to TAU Africa International! Email system is now ACTIVE - all forms will send to grouptauafrica@gmail.com', 'success');
});
        
// ===== GET MODAL CONTENT BASED ON TYPE =====
function getModalContent(type) {
    switch(type) {
        case 'taskRegistration':
            return createTaskRegistrationModal();
        case 'talkRegistration':
            return createTalkRegistrationModal();
        case 'corporate':
            return createCorporateModal();
        case 'training':
            return createTrainingModal();
        case 'workshop':
            return createWorkshopModal();
        case 'research':
            return createResearchModal();
        case 'jobCreation':
            return createJobCreationModal();
        case 'insertJob':
            return createInsertJobModal();
        case 'retrieveJob':
            return createRetrieveJobModal();
        case 'availableJobs':
            return createAvailableJobsModal();
        case 'applyJob':
            return createApplyJobModal();
        case 'community':
            return createCommunityModal();
        case 'parSirai':
            return createParSiraiModal();
        case 'trustGraph':
            return createTrustGraphModal();
        case 'foundation':
            return createFoundationModal();
        case 'holdings':
            return createHoldingsModal();
        case 'forum':
            return createForumModal();
        default:
            return '<div class="modal-content"><span class="close" onclick="closeAllModals()">&times;</span><h2>Feature Coming Soon</h2><p>This feature is under development.</p></div>';
    }
}

// ===== COMPREHENSIVE TASK REGISTRATION MODAL =====
function createTaskRegistrationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>Join TASK Team</h2>
            <p>Declare the values or services you're offering to the TAU Africa community</p>
            
            <div class="payment-info">
                <h3>Registration Fee: KSH 500</h3>
                <p>Secure M-PESA payment required ‚Ä¢ One-time membership fee</p>
            </div>
            
            <form onsubmit="processTaskRegistration(event)" id="taskForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required placeholder="Enter your full legal name">
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" required placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX" pattern="254[0-9]{9}">
                    <small>Format: 254XXXXXXXXX (include country code)</small>
                </div>
                
                <div class="form-group">
                    <label>Country/Location *</label>
                    <input type="text" name="location" required placeholder="City, Country">
                </div>

                <div class="form-group">
                    <label>Date of Birth *</label>
                    <input type="date" name="dateOfBirth" required>
                </div>

                <div class="form-group">
                    <label>Gender *</label>
                    <select name="gender" required>
                        <option value="">Select gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                        <option value="Prefer not to say">Prefer not to say</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Nationality *</label>
                    <input type="text" name="nationality" required placeholder="Your nationality">
                </div>
                
                <div class="form-group">
                    <label>Value Category *</label>
                    <div class="level-selection">
                        <div class="level-btn" onclick="selectCategory('skills', this)">Skills & Crafts</div>
                        <div class="level-btn" onclick="selectCategory('knowledge', this)">Knowledge & Expertise</div>
                        <div class="level-btn" onclick="selectCategory('service', this)">Professional Service</div>
                        <div class="level-btn" onclick="selectCategory('profession', this)">Licensed Profession</div>
                        <div class="level-btn" onclick="selectCategory('creativity', this)">Creative Arts</div>
                        <div class="level-btn" onclick="selectCategory('leadership', this)">Leadership & Management</div>
                        <div class="level-btn" onclick="selectCategory('business', this)">Business & Entrepreneurship</div>
                    </div>
                    <input type="hidden" name="category" id="taskCategory" required>
                </div>
                
                <div class="form-group">
                    <label>Describe Your Value/Service *</label>
                    <textarea name="valueDescription" rows="4" placeholder="Provide a detailed description of what you offer, your expertise, and how it benefits the community" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experience" required>
                        <option value="">Select level</option>
                        <option value="Beginner">Beginner (0-2 years)</option>
                        <option value="Intermediate">Intermediate (2-5 years)</option>
                        <option value="Advanced">Advanced (5-10 years)</option>
                        <option value="Expert">Expert (10+ years)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Professional Certifications/Licenses</label>
                    <textarea name="certifications" rows="2" placeholder="List any professional certifications, licenses, or credentials you hold"></textarea>
                </div>

                <div class="form-group">
                    <label>Languages Spoken *</label>
                    <input type="text" name="languages" required placeholder="e.g., English, Swahili, French">
                </div>
                
                <h3 style="color: #2a5298; margin: 25px 0 15px 0;">Proof of Innocence & Capabilities</h3>
                
                <div class="form-group">
                    <label>Certificate of Good Conduct Status *</label>
                    <select name="goodConduct" required>
                        <option value="">Select status</option>
                        <option value="Available">Available - Can provide immediately</option>
                        <option value="Will obtain">Will obtain upon request</option>
                        <option value="In process">Currently in process of obtaining</option>
                        <option value="Not applicable">Not applicable in my country</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Health Records Status *</label>
                    <select name="healthStatus" required>
                        <option value="">Select status</option>
                        <option value="Excellent">Excellent health - Can provide medical certificate</option>
                        <option value="Good">Good health - Regular checkups</option>
                        <option value="Will provide">Will provide upon request</option>
                        <option value="Private">Prefer to keep private</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Track Record/References</label>
                    <textarea name="trackRecord" rows="3" placeholder="Previous work experience, achievements, client testimonials, or references (include contact information if possible)"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Family/Support System</label>
                    <textarea name="familySupport" rows="2" placeholder="Brief description of your family situation and support system"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Educational Qualifications</label>
                    <textarea name="education" rows="2" placeholder="Degrees, certificates, training completed, institutions attended"></textarea>
                </div>

                <div class="form-group">
                    <label>Emergency Contact *</label>
                    <input type="text" name="emergencyContact" required placeholder="Name and phone number">
                </div>

                <div class="form-group">
                    <label>How did you hear about TAU Africa? *</label>
                    <select name="referralSource" required>
                        <option value="">Select source</option>
                        <option value="Social Media">Social Media (Twitter/X, TikTok, YouTube)</option>
                        <option value="Friend/Family">Friend or Family Member</option>
                        <option value="Community Event">Community Event</option>
                        <option value="Online Search">Online Search</option>
                        <option value="Business Network">Business Network</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 500)</button>
            </form>
        </div>
    `;
}

// ===== COMPREHENSIVE TALK REGISTRATION MODAL =====
function createTalkRegistrationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>Join TALK Team</h2>
            <p>Declare financial support, grants, or investments you're offering to the African development ecosystem</p>
            
            <div class="payment-info">
                <h3>Registration Fee: KSH 2,000</h3>
                <p>Secure M-PESA payment ‚Ä¢ Deposit goes to Valenta Liquid Pool Reserve for Kabiru value conversion</p>
            </div>
            
            <form onsubmit="processTalkRegistration(event)" id="talkForm">
                <div class="form-group">
                    <label>Full Name/Organization Name *</label>
                    <input type="text" name="fullName" required placeholder="Individual name or organization">
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" required placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX" pattern="254[0-9]{9}">
                </div>
                
                <div class="form-group">
                    <label>Country/Location *</label>
                    <input type="text" name="location" required>
                </div>

                <div class="form-group">
                    <label>Organization Type *</label>
                    <select name="organizationType" required>
                        <option value="">Select type</option>
                        <option value="Individual Investor">Individual Investor</option>
                        <option value="Corporation">Corporation</option>
                        <option value="Foundation">Foundation/NGO</option>
                        <option value="Government Agency">Government Agency</option>
                        <option value="Investment Fund">Investment Fund</option>
                        <option value="Development Bank">Development Bank</option>
                        <option value="Family Office">Family Office</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Website/LinkedIn Profile</label>
                    <input type="url" name="website" placeholder="https://example.com">
                </div>
                
                <div class="form-group">
                    <label>Financial Support Level *</label>
                    <div class="level-selection">
                        <div class="level-btn" onclick="selectLevel('ground', this)">Ground Level (&lt; $1,000)</div>
                        <div class="level-btn" onclick="selectLevel('middle', this)">Middle Level ($1,000-$5,000)</div>
                        <div class="level-btn" onclick="selectLevel('upper', this)">Upper Level ($5,000-$10,000)</div>
                        <div class="level-btn" onclick="selectLevel('high', this)">High Level ($10,000-$50,000)</div>
                        <div class="level-btn" onclick="selectLevel('top', this)">Top Level ($50,000+)</div>
                    </div>
                    <input type="hidden" name="supportLevel" id="supportLevel" required>
                </div>
                
                <div class="form-group">
                    <label>Type of Financial Support *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <label><input type="checkbox" name="supportTypes" value="Grants"> Grants</label>
                        <label><input type="checkbox" name="supportTypes" value="Equity Investment"> Equity Investment</label>
                        <label><input type="checkbox" name="supportTypes" value="Debt Financing"> Debt Financing</label>
                        <label><input type="checkbox" name="supportTypes" value="Venture Capital"> Venture Capital</label>
                        <label><input type="checkbox" name="supportTypes" value="Angel Investment"> Angel Investment</label>
                        <label><input type="checkbox" name="supportTypes" value="Crowdfunding"> Crowdfunding</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Focus Areas/Industries *</label>
                    <textarea name="focusAreas" rows="3" placeholder="What sectors, industries, or types of projects do you want to support? (e.g., Agriculture, Technology, Education, Healthcare)" required></textarea>
                </div>

                <div class="form-group">
                    <label>Geographic Focus</label>
                    <input type="text" name="geographicFocus" placeholder="Specific countries or regions of interest">
                </div>

                <div class="form-group">
                    <label>Investment Criteria</label>
                    <textarea name="investmentCriteria" rows="3" placeholder="What criteria do you use when evaluating investment opportunities?"></textarea>
                </div>

                <div class="form-group">
                    <label>Previous African Investments</label>
                    <textarea name="previousInvestments" rows="2" placeholder="Brief description of previous investments or support in Africa"></textarea>
                </div>
                
                <div id="enhancedRequirements" style="display: none;">
                    <h3 style="color: #2a5298; margin: 25px 0 15px 0;">Enhanced Requirements (Middle Level & Above)</h3>
                    
                    <div class="form-group">
                        <label>Certificate of Good Conduct *</label>
                        <select name="goodConduct">
                            <option value="">Select status</option>
                            <option value="Available">Available - Can provide</option>
                            <option value="Will obtain">Will obtain upon request</option>
                            <option value="Not applicable">Not applicable in my country</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Health Records Status *</label>
                        <select name="healthStatus">
                            <option value="">Select status</option>
                            <option value="Excellent">Excellent health - Can provide certificate</option>
                            <option value="Good">Good health - Regular checkups</option>
                            <option value="Will provide">Will provide upon request</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Financial Track Record *</label>
                        <textarea name="financialTrack" rows="3" placeholder="Previous investments, business ventures, financial background, investment performance"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Net Worth Range (Optional)</label>
                        <select name="netWorth">
                            <option value="">Prefer not to disclose</option>
                            <option value="Under $100K">Under $100,000</option>
                            <option value="$100K-$500K">$100,000 - $500,000</option>
                            <option value="$500K-$1M">$500,000 - $1,000,000</option>
                            <option value="$1M-$5M">$1,000,000 - $5,000,000</option>
                            <option value="$5M-$10M">$5,000,000 - $10,000,000</option>
                            <option value="Over $10M">Over $10,000,000</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Family/Organizational Financial Support</label>
                        <textarea name="familyFinancial" rows="2" placeholder="Family financial situation or organizational financial backing"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 2,000)</button>
            </form>
        </div>
    `;
}

// ===== JOB CREATION TRAINING MODAL - COMPREHENSIVE =====
function createJobCreationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üíº Job Creation Training Program</h2>
            <p>Comprehensive entrepreneurship and job creation program designed for African innovators</p>
            
            <div class="payment-info">
                <h3>Training Fee: KSH 1,500</h3>
                <p>6-week intensive program ‚Ä¢ Digital materials ‚Ä¢ Certification ‚Ä¢ Mentorship support</p>
            </div>
            
            <form onsubmit="processJobCreationTraining(event)" id="jobCreationForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX">
                </div>
                
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" name="location" required>
                </div>

                <div class="form-group">
                    <label>Age Range *</label>
                    <select name="ageRange" required>
                        <option value="">Select age range</option>
                        <option value="18-25">18-25 years</option>
                        <option value="26-35">26-35 years</option>
                        <option value="36-45">36-45 years</option>
                        <option value="46-55">46-55 years</option>
                        <option value="56+">56+ years</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Current Employment Status *</label>
                    <select name="employmentStatus" required>
                        <option value="">Select status</option>
                        <option value="Unemployed">Unemployed</option>
                        <option value="Underemployed">Underemployed</option>
                        <option value="Student">Student</option>
                        <option value="Self-employed">Self-employed</option>
                        <option value="Employed">Employed (seeking additional income)</option>
                        <option value="Recent Graduate">Recent Graduate</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Business Idea/Interest Area *</label>
                    <textarea name="businessIdea" rows="3" placeholder="What type of business or job creation are you interested in? Be specific about your vision." required></textarea>
                </div>

                <div class="form-group">
                    <label>Target Market/Customers *</label>
                    <textarea name="targetMarket" rows="2" placeholder="Who will be your customers or beneficiaries?" required></textarea>
                </div>

                <div class="form-group">
                    <label>Available Capital/Startup Funds</label>
                    <select name="startupFunds">
                        <option value="">Select range</option>
                        <option value="No funds">No funds available</option>
                        <option value="Under KSH 10K">Under KSH 10,000</option>
                        <option value="KSH 10K-50K">KSH 10,000 - 50,000</option>
                        <option value="KSH 50K-100K">KSH 50,000 - 100,000</option>
                        <option value="KSH 100K-500K">KSH 100,000 - 500,000</option>
                        <option value="Over KSH 500K">Over KSH 500,000</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Educational Background *</label>
                    <select name="education" required>
                        <option value="">Select level</option>
                        <option value="Primary School">Primary School</option>
                        <option value="Secondary School">Secondary School</option>
                        <option value="College Diploma">College Diploma</option>
                        <option value="University Degree">University Degree</option>
                        <option value="Postgraduate">Postgraduate</option>
                        <option value="Vocational Training">Vocational Training</option>
                        <option value="Self-taught">Self-taught</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Relevant Skills/Experience</label>
                    <textarea name="relevantSkills" rows="2" placeholder="List any skills or experience relevant to your business idea"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Training Focus Areas (Select all that apply) *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                        <label><input type="checkbox" name="focus" value="Business Planning"> Business Planning</label>
                        <label><input type="checkbox" name="focus" value="Financial Management"> Financial Management</label>
                        <label><input type="checkbox" name="focus" value="Marketing & Sales"> Marketing & Sales</label>
                        <label><input type="checkbox" name="focus" value="Digital Skills"> Digital Skills</label>
                        <label><input type="checkbox" name="focus" value="Leadership"> Leadership</label>
                        <label><input type="checkbox" name="focus" value="Networking"> Networking</label>
                        <label><input type="checkbox" name="focus" value="Legal Compliance"> Legal Compliance</label>
                        <label><input type="checkbox" name="focus" value="Product Development"> Product Development</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Preferred Learning Format *</label>
                    <select name="learningFormat" required>
                        <option value="">Select format</option>
                        <option value="Online only">Online only</option>
                        <option value="In-person only">In-person only</option>
                        <option value="Hybrid">Hybrid (Online + In-person)</option>
                        <option value="Self-paced">Self-paced online</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Timeline to Start Business *</label>
                    <select name="businessTimeline" required>
                        <option value="">Select timeline</option>
                        <option value="Within 3 months">Within 3 months</option>
                        <option value="3-6 months">3-6 months</option>
                        <option value="6-12 months">6-12 months</option>
                        <option value="Over 1 year">Over 1 year</option>
                        <option value="Just exploring">Just exploring options</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 1,500)</button>
            </form>
        </div>
    `;
}
        // TAU AFRICA INTERNATIONAL - PART 4: REMAINING MODALS (FINAL PART)
// PASTE THIS INSIDE <script> TAGS AFTER PART 3

// ===== TRAINING MODAL =====
function createTrainingModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìö Join Training Programs</h2>
            
            <form onsubmit="processTrainingRegistration(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Training Category *</label>
                    <select name="trainingCategory" required>
                        <option value="">Select training area</option>
                        <option>Digital Skills & Technology</option>
                        <option>Business & Entrepreneurship</option>
                        <option>Financial Literacy</option>
                        <option>Leadership Development</option>
                        <option>Agricultural Innovation</option>
                        <option>Pan-African Studies</option>
                        <option>Health & Wellness</option>
                        <option>Creative Arts</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="level" required>
                        <option value="">Select level</option>
                        <option>Beginner</option>
                        <option>Intermediate</option>
                        <option>Advanced</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Learning Goals *</label>
                    <textarea name="goals" rows="3" placeholder="What do you hope to achieve through this training?" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Preferred Training Format</label>
                    <select name="format">
                        <option>Online</option>
                        <option>In-person</option>
                        <option>Hybrid</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Register for Training</button>
            </form>
        </div>
    `;
}

// ===== WORKSHOP MODAL =====
function createWorkshopModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üéØ Host a Workshop</h2>
            
            <form onsubmit="processWorkshopProposal(event)">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="hostName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Workshop Title *</label>
                    <input type="text" name="workshopTitle" required>
                </div>
                
                <div class="form-group">
                    <label>Workshop Category *</label>
                    <select name="category" required>
                        <option value="">Select category</option>
                        <option>Business & Entrepreneurship</option>
                        <option>Technology & Innovation</option>
                        <option>Arts & Culture</option>
                        <option>Health & Wellness</option>
                        <option>Education & Skills</option>
                        <option>Pan-African Studies</option>
                        <option>Financial Literacy</option>
                        <option>Agriculture & Food Security</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Workshop Description *</label>
                    <textarea name="description" rows="4" placeholder="Detailed description of workshop content and objectives" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Target Audience *</label>
                    <textarea name="audience" rows="2" placeholder="Who should attend this workshop?" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Duration *</label>
                    <select name="duration" required>
                        <option value="">Select duration</option>
                        <option>2 hours</option>
                        <option>Half day (4 hours)</option>
                        <option>Full day (8 hours)</option>
                        <option>2 days</option>
                        <option>3-5 days</option>
                        <option>1 week</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Your Expertise/Qualifications *</label>
                    <textarea name="expertise" rows="3" placeholder="Your background and qualifications for hosting this workshop" required></textarea>
                </div>
                
                <button type="submit" class="btn">Submit Workshop Proposal</button>
            </form>
        </div>
    `;
}

// ===== RESEARCH SERVICES MODAL =====
function createResearchModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üî¨ Research Services</h2>
            
            <form onsubmit="processResearchRequest(event)">
                <div class="form-group">
                    <label>Organization/Individual Name *</label>
                    <input type="text" name="clientName" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Research Type *</label>
                    <select name="researchType" required>
                        <option value="">Select research type</option>
                        <option>Market Research</option>
                        <option>Academic Research</option>
                        <option>Policy Research</option>
                        <option>Social Impact Assessment</option>
                        <option>Business Intelligence</option>
                        <option>Pan-African Studies</option>
                        <option>Economic Analysis</option>
                        <option>Cultural Research</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Research Topic/Subject *</label>
                    <input type="text" name="topic" placeholder="Brief description of research topic" required>
                </div>
                
                <div class="form-group">
                    <label>Detailed Research Requirements *</label>
                    <textarea name="requirements" rows="4" placeholder="Specific research questions, methodology preferences, deliverables expected" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Timeline *</label>
                    <select name="timeline" required>
                        <option value="">Select timeline</option>
                        <option>1-2 weeks</option>
                        <option>1 month</option>
                        <option>2-3 months</option>
                        <option>3-6 months</option>
                        <option>6+ months</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Budget Range (USD)</label>
                    <select name="budget">
                        <option value="">Select budget range</option>
                        <option>Under $1,000</option>
                        <option>$1,000 - $5,000</option>
                        <option>$5,000 - $10,000</option>
                        <option>$10,000 - $25,000</option>
                        <option>$25,000+</option>
                        <option>To be discussed</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Submit Research Request</button>
            </form>
        </div>
    `;
}

// ===== INSERT JOB MODAL =====
function createInsertJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìù Post a Job Opening</h2>
            
            <form onsubmit="processJobPosting(event)">
                <div class="form-group">
                    <label>Company/Organization Name *</label>
                    <input type="text" name="companyName" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Job Title *</label>
                    <input type="text" name="jobTitle" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category *</label>
                    <select name="jobCategory" required>
                        <option value="">Select category</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales & Customer Service</option>
                        <option>Education & Training</option>
                        <option>Engineering</option>
                        <option>Finance & Accounting</option>
                        <option>Agriculture & Food</option>
                        <option>Manufacturing</option>
                        <option>Transportation & Logistics</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Job Type *</label>
                    <select name="jobType" required>
                        <option value="">Select type</option>
                        <option>Full-time</option>
                        <option>Part-time</option>
                        <option>Contract</option>
                        <option>Freelance</option>
                        <option>Internship</option>
                        <option>Temporary</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Job Description *</label>
                    <textarea name="jobDescription" rows="4" placeholder="Detailed job description, responsibilities, requirements" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Required Qualifications *</label>
                    <textarea name="qualifications" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experienceLevel" required>
                        <option value="">Select level</option>
                        <option>Entry Level (0-2 years)</option>
                        <option>Mid Level (2-5 years)</option>
                        <option>Senior Level (5-10 years)</option>
                        <option>Executive Level (10+ years)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Salary Range (Optional)</label>
                    <input type="text" name="salary" placeholder="e.g., KSH 50,000 - 80,000">
                </div>
                
                <button type="submit" class="btn">Post Job Opening</button>
            </form>
        </div>
    `;
}

// ===== JOB SEARCH MODAL =====
function createRetrieveJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üîç Job Search Portal</h2>
            
            <form onsubmit="processJobSearch(event)">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="searcherName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category</label>
                    <select name="category">
                        <option value="">All categories</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales & Customer Service</option>
                        <option>Education & Training</option>
                        <option>Engineering</option>
                        <option>Finance & Accounting</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Preferred Location</label>
                    <input type="text" name="location" placeholder="City, Country or Remote">
                </div>
                
                <div class="form-group">
                    <label>Experience Level</label>
                    <select name="experience">
                        <option value="">Any level</option>
                        <option>Entry Level</option>
                        <option>Mid Level</option>
                        <option>Senior Level</option>
                        <option>Executive Level</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Job Type</label>
                    <select name="jobType">
                        <option value="">Any type</option>
                        <option>Full-time</option>
                        <option>Part-time</option>
                        <option>Contract</option>
                        <option>Freelance</option>
                        <option>Internship</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Search Jobs</button>
            </form>
        </div>
    `;
}

// ===== AVAILABLE JOBS MODAL =====
function createAvailableJobsModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìã Available Jobs</h2>
            <p>Browse current job opportunities</p>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>Sample Job Listings:</h3>
                <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px;">
                    <h4>Software Developer - Tech Startup</h4>
                    <p><strong>Location:</strong> Nairobi, Kenya</p>
                    <p><strong>Requirements:</strong> 2+ years experience, JavaScript, React</p>
                    <button class="btn" onclick="openModal('applyJob')">Apply Now</button>
                </div>
                <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px;">
                    <h4>Marketing Manager - NGO</h4>
                    <p><strong>Location:</strong> Lagos, Nigeria</p>
                    <p><strong>Requirements:</strong> Marketing degree, 3+ years experience</p>
                    <button class="btn" onclick="openModal('applyJob')">Apply Now</button>
                </div>
            </div>
            
            <div style="text-align: center;">
                <p>More jobs available to registered members</p>
                <button class="btn" onclick="openModal('taskRegistration')">Join TASK Team to Access All Jobs</button>
            </div>
        </div>
    `;
}

// ===== APPLY FOR JOB MODAL =====
function createApplyJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìã Job Application</h2>
            
            <form onsubmit="processJobApplication(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Location/Address *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Position Applying For *</label>
                    <input type="text" name="position" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category *</label>
                    <select name="jobCategory" required>
                        <option value="">Select category</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales</option>
                        <option>Education</option>
                        <option>Engineering</option>
                        <option>Finance</option>
                        <option>Agriculture</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experience" required>
                        <option value="">Select level</option>
                        <option>Entry Level (0-2 years)</option>
                        <option>Mid Level (2-5 years)</option>
                        <option>Senior Level (5-10 years)</option>
                        <option>Executive Level (10+ years)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Key Skills *</label>
                    <textarea name="skills" rows="3" placeholder="List your relevant skills" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Work Experience *</label>
                    <textarea name="workExperience" rows="4" placeholder="Describe your relevant work experience" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Education *</label>
                    <textarea name="education" rows="3" placeholder="Your educational background" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Why are you interested in this position? *</label>
                    <textarea name="interest" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Availability *</label>
                    <select name="availability" required>
                        <option value="">Select availability</option>
                        <option>Immediately</option>
                        <option>Within 2 weeks</option>
                        <option>Within 1 month</option>
                        <option>To be discussed</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Submit Application</button>
            </form>
        </div>
    `;
}

// ===== COMMUNITY PROGRAMS MODAL =====
function createCommunityModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>ü§ù Join Community Programs</h2>
            
            <form onsubmit="processCommunityRegistration(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Location/Community *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Program Interest (Select all that apply) *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                        <label><input type="checkbox" name="programs" value="Agriculture"> Agriculture</label>
                        <label><input type="checkbox" name="programs" value="Climate"> Climate Action</label>
                        <label><input type="checkbox" name="programs" value="Environment"> Environment</label>
                        <label><input type="checkbox" name="programs" value="Water"> Water & Sanitation</label>
                        <label><input type="checkbox" name="programs" value="Education"> Education</label>
                        <label><input type="checkbox" name="programs" value="ChildCare"> Child Care</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Role Preference *</label>
                    <select name="role" required>
                        <option value="">How would you like to contribute?</option>
                        <option>Volunteer Worker</option>
                        <option>Community Organizer</option>
                        <option>Technical Advisor</option>
                        <option>Funding/Donor</option>
                        <option>Program Coordinator</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Available Time Commitment</label>
                    <select name="timeCommitment">
                        <option>2-4 hours per week</option>
                        <option>5-10 hours per week</option>
                        <option>10-20 hours per week</option>
                        <option>Full-time volunteer</option>
                        <option>Project-based</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Your Skills/Experience</label>
                    <textarea name="skills" rows="3" placeholder="What skills or experience can you contribute?"></textarea>
                </div>
                
                <button type="submit" class="btn">Join Community Programs</button>
            </form>
        </div>
    `;
}

// ===== CORPORATE REGISTRATION MODAL =====
function createCorporateModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üè¢ Corporate Registration - Valenta Holdings</h2>
            
            <div class="payment-info">
                <h3>Corporate Registration Package</h3>
                <p>Comprehensive business registration and setup services</p>
            </div>
            
            <form onsubmit="processCorporateRegistration(event)">
                <div class="form-group">
                    <label>Company Name *</label>
                    <input type="text" name="companyName" required>
                </div>
                
                <div class="form-group">
                    <label>Business Type *</label>
                    <select name="businessType" required>
                        <option value="">Select business type</option>
                        <option>Limited Company</option>
                        <option>Partnership</option>
                        <option>Sole Proprietorship</option>
                        <option>NGO/Foundation</option>
                        <option>Cooperative</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Industry Sector *</label>
                    <select name="sector" required>
                        <option value="">Select sector</option>
                        <option>Technology & Innovation</option>
                        <option>Agriculture & Food</option>
                        <option>Healthcare & Pharmaceuticals</option>
                        <option>Education & Training</option>
                        <option>Finance & Banking</option>
                        <option>Manufacturing</option>
                        <option>Retail & Commerce</option>
                        <option>Energy & Environment</option>
                        <option>Tourism & Hospitality</option>
                        <option>Media & Entertainment</option>
                        <option>Construction & Real Estate</option>
                        <option>Transportation & Logistics</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Training for Trade Program</label>
                    <select name="trainingTrade">
                        <option value="">Not applicable</option>
                        <option>Yes - Include training for employees</option>
                        <option>Yes - Include skills development</option>
                        <option>Yes - Include professional certification</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Contact Person *</label>
                    <input type="text" name="contactName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Country *</label>
                    <input type="text" name="country" required>
                </div>
                
                <div class="form-group">
                    <label>Business Address *</label>
                    <textarea name="address" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Business Description *</label>
                    <textarea name="businessDescription" rows="4" placeholder="Describe your business activities, products, services" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Expected Initial Investment (USD)</label>
                    <select name="investment">
                        <option value="">Select range</option>
                        <option>Under $10,000</option>
                        <option>$10,000 - $50,000</option>
                        <option>$50,000 - $100,000</option>
                        <option>$100,000 - $500,000</option>
                        <option>$500,000 - $1,000,000</option>
                        <option>Over $1,000,000</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Expected Number of Employees</label>
                    <select name="employees">
                        <option value="">Select range</option>
                        <option>1-5 employees</option>
                        <option>6-20 employees</option>
                        <option>21-50 employees</option>
                        <option>51-100 employees</option>
                        <option>100+ employees</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Pan-African Vision Alignment</label>
                    <textarea name="alignment" rows="3" placeholder="How does your business align with Pan-African development goals?"></textarea>
                </div>
                
                <button type="submit" class="btn">Submit Corporate Registration</button>
            </form>
        </div>
    `;
}

// ===== PAR SIRAI MODAL =====
function createParSiraiModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üèõÔ∏è Par Sirai Center</h2>
            <p>Center for Knowledge and Spirituality within AUFFI</p>
            
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Welcome to Par Sirai Center</h3>
                    <p>The spiritual and intellectual heart of Pan-African awakening</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üìö Knowledge Repository</h4>
                        <p>Access to Pan-African history, philosophy, and wisdom traditions</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üßò Spiritual Practices</h4>
                        <p>Meditation, prayer, and consciousness development programs</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üë• Community Circles</h4>
                        <p>Discussion groups and learning circles for spiritual growth</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üåü Awakening Programs</h4>
                        <p>Structured programs for social and spiritual consciousness</p>
                    </div>
                </div>
                
                <form onsubmit="processParSiraiRegistration(event)" style="margin-top: 30px;">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Interest Area *</label>
                        <select name="interest" required>
                            <option value="">Select area</option>
                            <option>Pan-African Book of Oloo</option>
                            <option>Spiritual Life of Oloo</option>
                            <option>Philosophy & Wisdom of Oloo</option>
                            <option>African Community Leadership</option>
                            <option>African Cultural Heritage</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Join Par Sirai Center</button>
                </form>
            </div>
        </div>
    `;
}

// ===== TRUST GRAPH MODAL =====
function createTrustGraphModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üîó Trust Graph Ledger</h2>
            <div style="padding: 20px; text-align: center;">
                <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
                    <h3>Blockchain-Based Trust System</h3>
                    <p>Building transparent and verifiable trust networks across Africa</p>
                </div>
                <p style="margin: 20px 0;">The Trust Graph Ledger is currently in development. This system will enable:</p>
                <ul style="text-align: left; max-width: 500px; margin: 0 auto;">
                    <li>Verified identity and reputation tracking</li>
                    <li>Transparent transaction histories</li>
                    <li>Community-validated trust scores</li>
                    <li>Decentralized governance mechanisms</li>
                </ul>
            </div>
            
            <form onsubmit="processTrustGraphAccess(event)" id="trustGraphForm">
                <div class="form-group">
                    <label>Organization Name *</label>
                    <input type="text" name="organization" required>
                </div>
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Access Level *</label>
                    <select name="accessLevel" required>
                        <option value="">Select level</option>
                        <option value="Basic">Basic Access</option>
                        <option value="Business">Corporate Access</option>
                        <option value="Enterprise">Sovereign Access</option>
                    </select>
                </div>
                <button type="submit" class="btn">Request Access</button>
            </form>
        </div>
    `;
}

// ===== FOUNDATION MODAL =====
function createFoundationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üåç TAU Africa Foundation</h2>
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Foundation for Sustainable Development</h3>
                    <p>Empowering African communities through strategic partnerships</p>
                </div>
                
                <form onsubmit="processFoundationInquiry(event)">
                    <div class="form-group">
                        <label>Organization/Individual Name *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Inquiry Type *</label>
                        <select name="inquiryType" required>
                            <option value="">Select inquiry type</option>
                            <option>Grant Application</option>
                            <option>Partnership Opportunity</option>
                            <option>Donation/Contribution</option>
                            <option>Program Collaboration</option>
                            <option>General Information</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message *</label>
                        <textarea name="message" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit Foundation Inquiry</button>
                </form>
            </div>
        </div>
    `;
}

// ===== HOLDINGS MODAL =====
function createHoldingsModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üè¢ Company Holdings</h2>
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #9b59b6, #8e44ad); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Valenta Holdings Portfolio</h3>
                    <p>Strategic investments in African development</p>
                </div>
                
                <div style="display: grid; gap: 15px; margin: 20px 0;">
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>Kabiru Digital Currency</h4>
                        <p>Revolutionary blockchain-based currency for African trade</p>
                    </div>
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>AUFFI Community Network</h4>
                        <p>Pan-African social and spiritual unity platform</p>
                    </div>
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>Agricultural Innovation Centers</h4>
                        <p>Modern farming techniques and food security</p>
                    </div>
                </div>
                
                <form onsubmit="processHoldingsInquiry(event)">
                    <div class="form-group">
                        <label>Name/Organization *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Interest *</label>
                        <select name="interest" required>
                            <option value="">Select interest</option>
                            <option>Investment Opportunities</option>
                            <option>Partnership Proposals</option>
                            <option>Acquisition Inquiries</option>
                            <option>Joint Ventures</option>
                            <option>General Information</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message *</label>
                        <textarea name="message" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit Holdings Inquiry</button>
                </form>
            </div>
        </div>
    `;
}

// ===== FORUM MODAL =====
function createForumModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üí¨ Member Forum</h2>
            <p>Connect with fellow TAU Africa members</p>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>Forum Features:</h3>
                <ul style="text-align: left;">
                    <li>Discussion boards by topic</li>
                    <li>Job sharing and networking</li>
                    <li>Training materials access</li>
                    <li>Voice calls and messaging</li>
                    <li>Business collaboration</li>
                </ul>
                
                <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px;">
                    <strong>Notice:</strong> Forum access requires active TASK or TALK membership
                </div>
            </div>
            
            <div style="text-align: center;">
                <button class="btn" onclick="openModal('taskRegistration')">Join TASK Team</button>
                <button class="btn" onclick="openModal('talkRegistration')">Join TALK Team</button>
                <button class="btn" onclick="showMemberLogin()">Member Login</button>
            </div>
        </div>
    `;
}
</script>
</body>
    </html>
