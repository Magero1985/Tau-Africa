<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pan African Knowledge Challenge - TAU Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #f1f1f1;
            min-height: 100vh;
            padding: 20px;
        }
/* ============================================
   ACHIEVEMENT SYSTEM STYLES - ADD THIS
   ============================================ */

.achievement-showcase {
    background: rgba(30, 60, 114, 0.7);
    padding: 20px;
    border-radius: 15px;
    margin-bottom: 20px;
    border: 2px solid #4cc9f0;
}

.current-rank {
    text-align: center;
    padding: 15px;
    background: linear-gradient(135deg, #e1701a, #f7a440);
    border-radius: 10px;
    margin-bottom: 15px;
}

.current-rank h3 {
    font-size: 1.8rem;
    color: white;
    margin-bottom: 5px;
}

.current-rank .rank-icon {
    font-size: 3rem;
    margin-bottom: 10px;
}

.badges-earned {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 15px;
}

.badge {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    background: linear-gradient(135deg, #4361ee, #3a56d4);
    border: 3px solid #f7a440;
    cursor: pointer;
    transition: transform 0.3s ease;
    position: relative;
}

.badge:hover {
    transform: scale(1.2);
}

.badge.locked {
    opacity: 0.3;
    filter: grayscale(100%);
}

.badge-tooltip {
    position: absolute;
    bottom: -40px;
    background: rgba(0,0,0,0.9);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 0.8rem;
    white-space: nowrap;
    display: none;
    z-index: 1000;
}

.badge:hover .badge-tooltip {
    display: block;
}

/* Kemetic Progress Bar */
.kemetic-progress {
    background: linear-gradient(90deg, 
        #8b7355 0%, 
        #f7a440 25%, 
        #e1701a 50%, 
        #f7a440 75%, 
        #8b7355 100%
    );
    height: 8px;
    margin: 20px 0;
    border-radius: 4px;
    position: relative;
}

.kemetic-progress::before,
.kemetic-progress::after {
    content: 'ìÇÄ';
    position: absolute;
    font-size: 1.5rem;
    color: #f7a440;
}

.kemetic-progress::before {
    left: -30px;
}

.kemetic-progress::after {
    right: -30px;
}
        /* ============================================
   CERTIFICATE MODAL STYLES - ADD THIS
   ============================================ */

.certificate-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    justify-content: center;
    align-items: center;
    z-index: 2000;
}

.certificate {
    background: linear-gradient(135deg, #f5f5dc 0%, #e8e4d0 100%);
    padding: 40px;
    border-radius: 20px;
    max-width: 800px;
    width: 90%;
    border: 8px double #8b7355;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

.certificate-header {
    text-align: center;
    border-bottom: 3px solid #8b7355;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.certificate-title {
    font-size: 2.5rem;
    color: #8b7355;
    font-weight: bold;
    margin-bottom: 10px;
}

.certificate-body {
    text-align: center;
    color: #4a4a4a;
    line-height: 1.8;
    margin-bottom: 30px;
}

.certificate-recipient {
    font-size: 2rem;
    color: #e1701a;
    font-weight: bold;
    margin: 20px 0;
}

.certificate-seals {
    display: flex;
    justify-content: space-around;
    margin-top: 30px;
}

.seal {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 4px solid #8b7355;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle, #f7a440, #e1701a);
    font-size: 0.8rem;
    text-align: center;
    color: white;
    font-weight: bold;
}

/* Hieroglyphic Border Animation */
.hieroglyphic-border {
    border: 4px solid transparent;
    border-image: repeating-linear-gradient(
        90deg,
        #f7a440,
        #e1701a 10px,
        transparent 10px,
        transparent 20px
    ) 1;
    animation: hieroglyphic-pulse 2s ease-in-out infinite;
}

@keyframes hieroglyphic-pulse {
    0%, 100% { border-color: #f7a440; }
    50% { border-color: #e1701a; }
}
        /* ============================================
   SOUND TOGGLE - ADD THIS
   ============================================ */

.sound-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(67, 97, 238, 0.7);
    padding: 10px 15px;
    border-radius: 25px;
    cursor: pointer;
    border: 2px solid #4cc9f0;
    font-size: 1.5rem;
    z-index: 1000;
    transition: all 0.3s ease;
}

.sound-toggle:hover {
    background: rgba(67, 97, 238, 0.9);
    transform: scale(1.1);
}
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* TAU Connection Banner */
        .tau-banner {
            background: linear-gradient(45deg, #4169e1, #2ecc71);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tau-banner.guest {
            background: linear-gradient(45deg, #ffd700, #f39c12);
            color: #333;
        }

        .tau-info {
            flex: 1;
        }

        .tau-info strong {
            display: block;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .tau-info small {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .tau-actions {
            display: flex;
            gap: 10px;
        }

        .tau-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .tau-btn:hover {
            transform: scale(1.05);
        }

        .tau-btn.primary {
            background: white;
            color: #4169e1;
        }

        .tau-btn.secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid white;
        }

        .tau-btn.guest-register {
            background: #333;
            color: #ffd700;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid #e1701a;
        }

        h1 {
            color: #f7a440;
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            color: #f7d560;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .earnings-display {
            background: linear-gradient(135deg, #f7a440, #e1701a);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .player-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-card {
            background: rgba(30, 60, 114, 0.7);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #4cc9f0;
        }

        .info-card h3 {
            color: #4cc9f0;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .info-card p {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f7a440;
        }

        .progress-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f7a440, #e1701a);
            width: 0%;
            transition: width 0.5s ease;
        }

        .level-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .level-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .level-dot.active {
            background: #e1701a;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(225, 112, 26, 0.7);
        }

        .level-dot.completed {
            background: #4361ee;
            color: white;
        }

        .level-dot.completed::after {
            content: '‚úì';
            position: absolute;
            top: -5px;
            right: -5px;
            background: #2ecc71;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-container {
            background: rgba(20, 33, 61, 0.8);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #4361ee;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .question-text {
            font-size: 1.4rem;
            line-height: 1.5;
            margin-bottom: 25px;
            color: #f1f1f1;
            min-height: 80px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .option {
            background: rgba(67, 97, 238, 0.2);
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-size: 1.1rem;
        }

        .option:hover {
            background: rgba(67, 97, 238, 0.4);
            transform: translateY(-3px);
        }

        .option.selected {
            background: rgba(225, 112, 26, 0.3);
            border-color: #e1701a;
        }

        .option.correct {
            background: rgba(76, 201, 240, 0.3);
            border-color: #4cc9f0;
        }

        .option.wrong {
            background: rgba(239, 71, 111, 0.3);
            border-color: #ef476f;
        }

        .option.disabled {
            pointer-events: none;
            opacity: 0.6;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-next {
            background: linear-gradient(90deg, #4361ee, #3a56d4);
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            background: linear-gradient(90deg, #3a56d4, #2f48b9);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.4);
        }

        .btn-next:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-submit {
            background: linear-gradient(90deg, #e1701a, #d16617);
            color: white;
        }

        .btn-submit:hover:not(:disabled) {
            background: linear-gradient(90deg, #d16617, #c15c14);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(225, 112, 26, 0.4);
        }

        .btn-submit:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 3px solid #e1701a;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-content h2 {
            color: #f7a440;
            margin-bottom: 20px;
            font-size: 2.2rem;
        }

        .modal-content p {
            font-size: 1.3rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .celebration {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .start-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .mode-selection {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .mode-card {
            background: rgba(30, 60, 114, 0.7);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #4cc9f0;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
        }

        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(76, 201, 240, 0.4);
        }

        .mode-card.selected {
            border-color: #e1701a;
            background: rgba(225, 112, 26, 0.3);
        }

        .mode-card h3 {
            color: #4cc9f0;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .mode-card p {
            color: #f1f1f1;
            margin-bottom: 10px;
        }

        .mode-card .highlight {
            color: #f7a440;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .btn-start {
            background: linear-gradient(90deg, #e1701a, #f7a440);
            color: white;
            font-size: 1.5rem;
            padding: 20px 50px;
            margin-top: 30px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-start:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(225, 112, 26, 0.5);
        }

        .btn-start:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .timer {
            color: #4cc9f0;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .hint {
            margin-top: 15px;
            color: #f7d560;
            font-style: italic;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .player-info {
                grid-template-columns: 1fr;
            }
            
            .level-dot {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
            }

            .mode-selection {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sound Toggle Button -->
        <div class="sound-toggle" onclick="toggleSound()" id="soundToggle">
            üîä
        </div>

        <!-- Achievement Showcase -->
        <div class="achievement-showcase" id="achievementShowcase" style="display: none;">
            <div class="current-rank">
                <div class="rank-icon" id="rankIcon">üå±</div>
                <h3 id="rankTitle">Awakening Seeker</h3>
                <p id="rankDescription">Beginning your Pan-African journey</p>
                <div class="kemetic-progress"></div>
                <p style="font-size: 0.9rem; margin-top: 10px; color: white;">
                    <span id="progressText">Level 1/20</span> ‚Ä¢ 
                    <span id="nextRankText">Next: Conscious Member at Level 5</span>
                </p>
            </div>
            
            <div class="badges-earned" id="badgesContainer">
                <!-- Badges will be dynamically added by JavaScript -->
            </div>
        </div>
        <!-- TAU Member Banner -->
        <div id="tauMemberBanner" class="tau-banner" style="display: none;">
            <div class="tau-info">
                <strong>üîó Connected to TAU Africa</strong>
                <small id="memberInfo">Loading member info...</small>
            </div>
            <div class="tau-actions">
                <button class="tau-btn primary" onclick="syncEarningsToTAU()">üí∞ Sync Earnings</button>
                <button class="tau-btn secondary" onclick="openTAUApp()">Open TAU App</button>
            </div>
        </div>

        <!-- Guest Banner -->
        <div id="guestBanner" class="tau-banner guest" style="display: none;">
            <div class="tau-info">
                <strong>üåç Playing as Guest</strong>
                <small>Play for fun! Register with TAU to earn iKbp rewards.</small>
            </div>
            <div class="tau-actions">
                <button class="tau-btn guest-register" onclick="registerWithTAU()">üéØ Register with TAU</button>
            </div>
        </div>

        <div class="header">
    <h1>Pan African Knowledge Challenge</h1>
    <div class="subtitle">Test your knowledge across 20 challenging levels in 2 stages ‚Ä¢ Earn iKbp rewards as TAU member!</div>
</div>  
        
        <!-- Earnings Display -->
        <div id="earningsDisplay" class="earnings-display" style="display: none;">
            üí∞ Total Earned: <span id="totalEarned">0</span> iKbp
        </div>

        <div id="startScreen" class="start-screen">
            <h2>Welcome to the Challenge!</h2>
<p>Journey through 20 levels of Pan African knowledge across 2 stages!</p>
<p><strong>Stage 1 (Levels 1-10):</strong> Foundations of African history and culture</p>
<p><strong>Stage 2 (Levels 11-20):</strong> Advanced topics - Kemet, colonization, resources, spirituality</p>
<p><strong>Complete each level to earn 250 iKbp!</strong> (TAU Members only)</p>
            <div class="mode-selection">
                <div class="mode-card" onclick="selectMode('guest')">
                    <h3>üåç Guest Mode</h3>
                    <p>‚Ä¢ Play all levels for fun</p>
                    <p>‚Ä¢ No earnings</p>
                    <p>‚Ä¢ Perfect for practice</p>
                    <p class="highlight">Free Play</p>
                </div>
                
                <div class="mode-card" onclick="selectMode('member')">
                    <h3>‚≠ê TAU Member</h3>
                    <p>‚Ä¢ Earn 250 iKbp per level</p>
                    <p>‚Ä¢ Sync to TAU account</p>
                    <p>‚Ä¢ Track your progress</p>
                    <p class="highlight">Earn While Learning!</p>
                </div>
            </div>
            
            <button class="btn-start" id="startBtn" onclick="startGame()" disabled>Select Mode to Begin</button>
        </div>

        <div id="gameScreen" class="game-container" style="display: none;">
            <div class="player-info">
                <div class="info-card">
                    <h3>Current Level</h3>
                    <p id="currentLevel">1</p>
                </div>
                <div class="info-card">
                    <h3>Question</h3>
                    <p id="currentQuestion">1/10</p>
                    <div class="progress-bar">
                        <div id="questionProgress" class="progress-fill"></div>
                    </div>
                </div>
                <div class="info-card">
                    <h3>Score</h3>
                    <p id="score">0</p>
                </div>
                <div class="info-card">
                    <h3>Level iKbp</h3>
                    <p id="levelEarnings">0</p>
                </div>
            </div>

            <div style="text-align: center; margin: 20px 0;">
    <div style="background: rgba(30, 60, 114, 0.7); 
                padding: 20px; 
                border-radius: 15px; 
                border: 2px solid #4cc9f0;
                display: inline-block;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);">
        <h3 style="color: #4cc9f0; 
                   margin-bottom: 10px; 
                   font-size: 1.1rem;">
            ‚è±Ô∏è Level Time Remaining
        </h3>
        <div id="levelTimer" 
             style="font-size: 3rem; 
                    font-weight: bold; 
                    color: #4cc9f0;
                    font-family: 'Courier New', monospace;
                    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
            1:00
        </div>
        <p style="color: #f7d560; 
                  margin-top: 10px; 
                  font-size: 0.9rem;">
            Complete 10 questions before time runs out!
        </p>
    </div>
</div>
            <div class="level-indicator" id="levelIndicator"></div>

            <div class="question-container">
                <div class="question-header">
                    <h2>Level <span id="levelDisplay">1</span> - Question <span id="questionNumber">1</span></h2>
                    <div class="timer">Difficulty: <span id="difficulty">Easy</span></div>
                </div>
                
                <div class="question-text" id="questionText">Loading question...</div>
               
                <div class="options-container" id="optionsContainer"></div>
                
                <div id="hintArea" class="hint"></div>
                
                <div class="buttons">
                    <button class="btn btn-submit" id="submitBtn" onclick="submitAnswer()" disabled>Submit Answer</button>
                    <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()" disabled>Next Question ‚Üí</button>
                </div>
            </div>
        </div>
                
        <div id="resultModal" class="result-modal">
            <div class="modal-content">
                <div class="celebration" id="celebrationEmoji">üéâ</div>
                <h2 id="resultTitle">Level Complete!</h2>
                <p id="resultMessage"></p>
                <p id="resultScore">Score: <span id="finalScore">0</span></p>
                <p id="resultEarnings" style="color: #f7a440; font-size: 1.5rem; font-weight: bold;"></p>
                <div style="margin-top: 30px;">
                    <button class="btn btn-next" onclick="nextLevel()" id="nextLevelBtn">Proceed to Next Level</button>
                </div>
            </div>
        </div>

        <div id="gameCompleteModal" class="result-modal">
            <div class="modal-content">
                <div class="celebration">üèÜ</div>
                <h2>Congratulations!</h2>
                <p>You've completed all 10 levels of the Pan African Knowledge Challenge!</p>
                <p id="completionEarnings"></p>
                <p style="margin-top: 20px; color: #4cc9f0;">
                    üåç <strong>Join the TAU Africa Ecosystem</strong> for expanded earning opportunities and Pan-African awakening!
                </p>
                <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-start" onclick="joinTAUEcosystem()">Join TAU Ecosystem</button>
                    <button class="btn btn-next" onclick="restartGame()">Play for Fun</button>
                </div>
            </div>
        </div>

        <div id="alreadyCompletedModal" class="result-modal">
            <div class="modal-content">
                <div class="celebration">‚è≥</div>
                <h2>Already Completed!</h2>
                <p>You've already earned rewards for all 10 levels.</p>
                <p style="color: #f7a440;">üí∞ Total Earned: <span id="totalEarnedComplete">0</span> iKbp</p>
                <p style="margin-top: 20px;">
                    <strong>Levels 11-20 coming soon!</strong><br>
                    In the meantime, play previous levels for fun as a guest.
                </p>
                <div style="margin-top: 30px;">
                    <button class="btn btn-next" onclick="playAsGuest()">Play as Guest</button>
                    <button class="btn btn-start" onclick="closeModal('alreadyCompletedModal')" style="margin-top: 10px;">Return to Menu</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Certificate Modal -->
        <div class="certificate-modal" id="certificateModal">
            <div class="certificate hieroglyphic-border">
                <div class="certificate-header">
                    <div style="font-size: 3rem; margin-bottom: 10px;">üèÜ</div>
                    <div class="certificate-title">Certificate of Achievement</div>
                    <div style="color: #8b7355; font-size: 1.2rem;">
                        Pan African Knowledge Challenge
                    </div>
                </div>
                
                <div class="certificate-body">
                    <p style="font-size: 1.2rem; margin-bottom: 20px;">
                        This certifies that
                    </p>
                    <div class="certificate-recipient" id="certificateRecipient">
                        TAU Member
                    </div>
                    <p style="font-size: 1.1rem; margin: 20px 0;">
                        has successfully completed
                    </p>
                    <div style="font-size: 1.5rem; color: #e1701a; font-weight: bold; margin: 15px 0;">
                        <span id="certificateStage">Stage 1</span>
                    </div>
                    <p style="font-size: 1rem; margin-top: 20px;">
                        achieving the rank of
                    </p>
                    <div style="font-size: 1.8rem; color: #4361ee; font-weight: bold; margin: 15px 0;">
                        <span id="certificateRank">Teacher of Liberation</span>
                    </div>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 20px;">
                        Date: <span id="certificateDate"></span>
                    </p>
                </div>

                <div class="certificate-seals">
                    <div class="seal">
                        <div>
                            TAU<br>AFRICA<br>OFFICIAL<br>SEAL
                        </div>
                    </div>
                    <div class="seal">
                        <div>
                            iKbp<br>DIGITAL<br>VALUE<br>VERIFIED
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-next" onclick="downloadCertificate()">üì• Download Certificate</button>
                    <button class="btn btn-next" onclick="closeCertificate()">Continue Journey</button>
                </div>
            </div>
        </div>

    <script>
        // ============================================
// ACHIEVEMENT SYSTEM CONSTANTS - ADD THIS
// ============================================

const RANKS = {
    1: { 
        name: "Awakening Seeker", 
        icon: "üå±", 
        description: "Beginning your Pan-African journey", 
        color: "#4cc9f0" 
    },
    5: { 
        name: "Conscious Member", 
        icon: "üëÅÔ∏è", 
        description: "Eyes opening to truth", 
        color: "#4361ee" 
    },
    8: { 
        name: "Member of Change", 
        icon: "‚ö°", 
        description: "Agent of transformation", 
        color: "#f7a440" 
    },
    11: { 
        name: "Teacher of Liberation", 
        icon: "üìö", 
        description: "Stage 2: Sharing knowledge", 
        color: "#e1701a" 
    },
    14: { 
        name: "Leader of Awakening", 
        icon: "üî•", 
        description: "Guiding others to light", 
        color: "#ef476f" 
    },
    17: { 
        name: "Creator & Master", 
        icon: "üëë", 
        description: "Shaping the future", 
        color: "#8b7355" 
    },
    20: { 
        name: "Deity of Pan-Africanism", 
        icon: "‚≠ê", 
        description: "Highest honor achieved", 
        color: "#ffd700" 
    }
};

const BADGES = [
    { id: "first_level", icon: "üéØ", name: "First Steps", requirement: 1 },
    { id: "perfect_level", icon: "üíØ", name: "Perfectionist", requirement: "perfect" },
    { id: "stage1_complete", icon: "üéì", name: "Foundation Master", requirement: 10 },
    { id: "stage2_unlock", icon: "üîì", name: "Advanced Seeker", requirement: 11 },
    { id: "speed_demon", icon: "‚ö°", name: "Lightning Mind", requirement: "speed" },
    { id: "scholar", icon: "üìñ", name: "Knowledge Scholar", requirement: 15 },
    { id: "ultimate", icon: "üëë", name: "Pan-African Deity", requirement: 20 }
];
        let gameState = {
    currentLevel: 1,
    currentQuestion: 1,
    score: 0,
    selectedOption: null,
    correctAnswer: null,
    questionsAnswered: 0,
    correctAnswers: 0,
    timerInterval: null,
    gameStarted: false,
    levelQuestions: [],
    // UPDATED: 20 levels with increasing difficulty
    difficultyMultipliers: [
        1.0, 1.2, 1.5, 1.8, 2.0, 2.3, 2.7, 3.1, 3.6, 4.0,  // Levels 1-10
        4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0   // Levels 11-20
    ],
    answerSubmitted: false,
    playMode: null,
    memberId: null,
    levelEarnings: 0,
    completedLevels: [],
    soundEnabled: true,
    earnedBadges: [],
    currentRank: "Awakening Seeker"
};
        window.iKbpTracker = {
    totalEarned: 0,
    levelEarnings: {},
    pendingSync: 0,      // Track unsynced earnings
    lastSynced: 0,       // Last synced amount
    
    addEarnings: function(amount, level, reason) {
        if (gameState.playMode !== 'member') return 0;
        
        this.totalEarned += amount;
        this.pendingSync += amount; // Track pending
        
        if (!this.levelEarnings[level]) {
            this.levelEarnings[level] = 0;
        }
        this.levelEarnings[level] += amount;
        
        console.log(`üí∞ +${amount} iKbp earned! (${reason})`);
        this.saveToStorage();
        this.updateDisplay();
        
        return amount;
    },
    
    getTotalEarned: function() {
        return this.totalEarned;
    },
    
    getCurrentLevelEarnings: function() {
        return this.levelEarnings[gameState.currentLevel] || 0;
    },
    
    getPendingSync: function() {
        return this.pendingSync;
    },
    
    markAsSynced: function() {
        this.lastSynced = this.totalEarned;
        this.pendingSync = 0;
        this.saveToStorage();
        console.log('‚úÖ Marked as synced:', this.lastSynced);
    },
    
    saveToStorage: function() {
        const earningData = {
            version: '2.0',
            totalEarned: this.totalEarned,
            pendingSync: this.pendingSync,
            lastSynced: this.lastSynced,
            levelEarnings: this.levelEarnings,
            completedLevels: gameState.completedLevels,
            earnedBadges: gameState.earnedBadges,  // ADD THIS LINE
            lastUpdated: new Date().toISOString()
        };
        
        const key = gameState.playMode === 'member' && gameState.memberId 
            ? `tauKnowledge_${gameState.memberId}` 
            : 'tauKnowledgeGuest';
            
        localStorage.setItem(key, JSON.stringify(earningData));
        console.log('üíæ Saved:', earningData);
    },
    
    loadFromStorage: function() {
        const key = gameState.playMode === 'member' && gameState.memberId 
            ? `tauKnowledge_${gameState.memberId}` 
            : 'tauKnowledgeGuest';
            
        const saved = localStorage.getItem(key);
        if (saved) {
            try {
                const data = JSON.parse(saved);
                
                this.totalEarned = data.totalEarned || 0;
                this.pendingSync = data.pendingSync || 0;
                this.lastSynced = data.lastSynced || 0;
                this.levelEarnings = data.levelEarnings || {};
                gameState.completedLevels = data.completedLevels || [];
                gameState.earnedBadges = data.earnedBadges || [];  // ADD THIS LINE
                
                this.updateDisplay();
                console.log('‚úÖ Loaded:', data);
            } catch (e) {
                console.log('Load error:', e);
            }
        }
    },
            
    
    updateDisplay: function() {
        const totalEl = document.getElementById('totalEarned');
        const levelEl = document.getElementById('levelEarnings');
        
        if (totalEl) totalEl.textContent = this.totalEarned;
        if (levelEl) levelEl.textContent = gameState.levelEarnings;
        
        console.log('üñ•Ô∏è Display updated - Total:', this.totalEarned);
    }
};
    function syncEarningsToTAU() {
    const pendingAmount = iKbpTracker.getPendingSync();
    
    console.log('üîÑ Attempting to sync:', pendingAmount, 'iKbp pending');
    
    if (pendingAmount === 0) {
        alert('‚úÖ All earnings already synced!\n\n' +
              'Total earned: ' + iKbpTracker.getTotalEarned() + ' iKbp\n' +
              'Pending sync: 0 iKbp\n\n' +
              'Complete more levels to earn more.');
        return;
    }
    
    const syncData = {
        memberId: gameState.memberId,
        amountToSync: pendingAmount,
        totalLifetimeEarned: iKbpTracker.getTotalEarned(),
        levelEarnings: iKbpTracker.levelEarnings,
        completedLevels: gameState.completedLevels,
        timestamp: new Date().toISOString(),
        source: 'knowledge_challenge',
        appVersion: '2.0'
    };
    
    localStorage.setItem('tauSyncData', JSON.stringify(syncData));
    
    const breakdown = Object.entries(iKbpTracker.levelEarnings)
        .map(([level, amt]) => `Level ${level}: ${amt} iKbp`)
        .join('\n');
    
    const confirmMsg = `‚úÖ Ready to sync ${pendingAmount} iKbp!\n\n` +
                      `üìä Breakdown:\n${breakdown}\n\n` +
                      `üîÑ Opening TAU App...`;
    
    alert(confirmMsg);
    
    // Mark as synced BEFORE redirect
    iKbpTracker.markAsSynced();
    
    const syncParams = new URLSearchParams({
        sync: 'true',
        memberId: gameState.memberId,
        earned: pendingAmount,
        source: 'knowledge',
        timestamp: Date.now()
    });
    
    setTimeout(() => {
        window.open(`https://magero1985.github.io/Tau-Africa/?${syncParams.toString()}`, '_blank');
    }, 1000);
}
// Now override the global reference
Object.assign(iKbpTracker, window.iKbpTracker);

        const questionsDatabase = {
            level1: [
                {
                    question: "Which ancient African civilization built the Great Pyramids of Giza?",
                    options: ["Kingdom of Kush", "Ancient Egyptians", "Kingdom of Aksum", "Carthaginian Empire"],
                    correct: 1,
                    hint: "This civilization flourished along the Nile River.",
                    category: "History"
                },
                {
                    question: "Which African country was never colonized by European powers?",
                    options: ["Ethiopia", "South Africa", "Nigeria", "Kenya"],
                    correct: 0,
                    hint: "This country successfully resisted Italian colonization at the Battle of Adwa.",
                    category: "History"
                },
                {
                    question: "Who was the first president of Ghana?",
                    options: ["Jerry Rawlings", "Kwame Nkrumah", "John Kufuor", "John Atta Mills"],
                    correct: 1,
                    hint: "He led Ghana to independence in 1957.",
                    category: "Politics"
                },
                {
                    question: "Which river is the longest in Africa?",
                    options: ["Congo River", "Niger River", "Nile River", "Zambezi River"],
                    correct: 2,
                    hint: "It flows through 11 countries and is approximately 6,650 km long.",
                    category: "Geography"
                },
                {
                    question: "The Swahili language is primarily spoken in which African region?",
                    options: ["West Africa", "Southern Africa", "East Africa", "North Africa"],
                    correct: 2,
                    hint: "It's a Bantu language with Arabic influences.",
                    category: "Culture"
                },
                {
                    question: "Which African leader won the Nobel Peace Prize in 1993?",
                    options: ["Nelson Mandela", "Julius Nyerere", "Kofi Annan", "Wangari Maathai"],
                    correct: 0,
                    hint: "He was the first black president of South Africa.",
                    category: "Politics"
                },
                {
                    question: "The ancient city of Timbuktu is located in which modern-day country?",
                    options: ["Mali", "Niger", "Chad", "Sudan"],
                    correct: 0,
                    hint: "It was a major center of learning during the Mali Empire.",
                    category: "History"
                },
                {
                    question: "Which African country is known as the 'Pearl of Africa'?",
                    options: ["Tanzania", "Uganda", "Rwanda", "Zambia"],
                    correct: 1,
                    hint: "Winston Churchill gave it this nickname.",
                    category: "Geography"
                },
                {
                    question: "Who wrote the novel 'Things Fall Apart'?",
                    options: ["Wole Soyinka", "Chinua Achebe", "Ng≈©gƒ© wa Thiong'o", "Chimamanda Ngozi Adichie"],
                    correct: 1,
                    hint: "This Nigerian author is considered the father of modern African literature.",
                    category: "Literature"
                },
                {
                    question: "The Ashanti Empire was located in present-day which country?",
                    options: ["Nigeria", "Ghana", "Ivory Coast", "Benin"],
                    correct: 1,
                    hint: "This empire was known for its gold trade and military prowess.",
                    category: "History"
                }
            ],
            level2: [
                {
                    question: "Which African empire was known as the 'Land of Gold'?",
                    options: ["Mali Empire", "Songhai Empire", "Ghana Empire", "Benin Empire"],
                    correct: 2,
                    hint: "This empire controlled gold trade in West Africa from the 6th to 13th centuries.",
                    category: "History"
                },
                {
                    question: "Who was the Ethiopian emperor who modernized the country in the early 20th century?",
                    options: ["Haile Selassie", "Menelik II", "Tewodros II", "Yohannes IV"],
                    correct: 1,
                    hint: "He established Ethiopia's first modern schools, hospitals, and infrastructure.",
                    category: "History"
                },
                {
                    question: "The 'Year of Africa' when 17 African nations gained independence was:",
                    options: ["1957", "1960", "1963", "1965"],
                    correct: 1,
                    hint: "This was a pivotal year in the decolonization of Africa.",
                    category: "History"
                },
                {
                    question: "Which African country is the largest producer of cocoa?",
                    options: ["Ghana", "Nigeria", "Ivory Coast", "Cameroon"],
                    correct: 2,
                    hint: "This West African country produces about 40% of the world's cocoa.",
                    category: "Economy"
                },
                {
                   question: "The ancient Nubian civilization was located in present-day:",
                    options: ["Egypt and Sudan", "Ethiopia and Eritrea", "Libya and Tunisia", "Morocco and Algeria"],
                    correct: 0,
                    hint: "Nubia was located along the Nile, south of Ancient Egypt.",
                    category: "History"
                },
                {
                    question: "Who founded the Organization of African Unity (OAU) in 1963?",
                    options: ["Kwame Nkrumah", "Haile Selassie", "Julius Nyerere", "Gamal Abdel Nasser"],
                    correct: 1,
                    hint: "The Ethiopian emperor played a key role in establishing this pan-African organization.",
                    category: "Politics"
                },
                {
                    question: "The 'Mfecane' refers to a period of widespread disruption and migration in which region?",
                    options: ["West Africa", "Horn of Africa", "Southern Africa", "Central Africa"],
                    correct: 2,
                    hint: "This period occurred in the early 19th century among Bantu-speaking communities.",
                    category: "History"
                },
                {
                    question: "Which African city hosted the first FIFA World Cup on the continent?",
                    options: ["Cairo, Egypt", "Johannesburg, South Africa", "Lagos, Nigeria", "Nairobi, Kenya"],
                    correct: 1,
                    hint: "The 2010 World Cup was held in South Africa.",
                    category: "Sports"
                },
                {
                    question: "The 'Berber' people are indigenous to which region of Africa?",
                    options: ["Southern Africa", "West Africa", "North Africa", "East Africa"],
                    correct: 2,
                    hint: "They have inhabited North Africa since at least 3000 BCE.",
                    category: "Culture"
                },
                {
                    question: "Who was the first African woman to win the Nobel Peace Prize?",
                    options: ["Wangari Maathai", "Ellen Johnson Sirleaf", "Leymah Gbowee", "Miriam Makeba"],
                    correct: 0,
                    hint: "She won in 2004 for her contribution to sustainable development, democracy, and peace.",
                    category: "Politics"
                },
            ],
        level3: [
        {question: "Which African leader introduced 'Ujamaa' (African socialism) in Tanzania?", options: ["Kenneth Kaunda", "Julius Nyerere", "Jomo Kenyatta", "Kwame Nkrumah"], correct: 1, hint: "He promoted villagization and collective farming.", category: "Politics"},
        {question: "The Great Zimbabwe ruins were built by which civilization?", options: ["Shona people", "Zulu Kingdom", "Swahili traders", "Portuguese settlers"], correct: 0, hint: "These stone structures date from 11th-15th centuries.", category: "History"},
        {question: "Which African country has the most official languages (11)?", options: ["Nigeria", "South Africa", "Kenya", "Ethiopia"], correct: 1, hint: "Its constitution recognizes multiple indigenous languages.", category: "Culture"},
        {question: "Lake Victoria is shared by three countries. Which is NOT one?", options: ["Kenya", "Tanzania", "Rwanda", "Uganda"], correct: 2, hint: "It's Africa's largest lake by area.", category: "Geography"},
        {question: "Who was the first woman president in Africa?", options: ["Ellen Johnson Sirleaf", "Joyce Banda", "Sahle-Work Zewde", "Sylvie Kinigi"], correct: 0, hint: "She led Liberia from 2006-2018.", category: "Politics"},
        {question: "The ancient University of Sankore was in which city?", options: ["Cairo", "Timbuktu", "Gao", "Djenn√©"], correct: 1, hint: "Major center of Islamic learning in medieval West Africa.", category: "History"},
        {question: "Which African nation was formed by freed American slaves?", options: ["Sierra Leone", "Liberia", "Equatorial Guinea", "S√£o Tom√©"], correct: 1, hint: "Capital Monrovia is named after a U.S. president.", category: "History"},
        {question: "The Maasai people traditionally live in which two countries?", options: ["Kenya and Tanzania", "Uganda and Rwanda", "Ethiopia and Somalia", "Zambia and Malawi"], correct: 0, hint: "Semi-nomadic pastoralists with distinctive red clothing.", category: "Culture"},
        {question: "Which African country produces the most oil?", options: ["Angola", "Nigeria", "Libya", "Algeria"], correct: 1, hint: "Also the most populous nation on the continent.", category: "Economy"},
        {question: "Pan-African colors were inspired by which flag?", options: ["Ethiopian flag", "Ghanaian flag", "Kenyan flag", "Marcus Garvey's flag"], correct: 3, hint: "Red, black, and green represent blood, people, and land.", category: "Culture"}
    ],
    
    level4: [
        {question: "The Scramble for Africa was formalized at which conference?", options: ["Congress of Vienna", "Berlin Conference", "Treaty of Versailles", "Paris Peace"], correct: 1, hint: "1884-1885 meeting divided Africa among Europeans.", category: "History"},
        {question: "Which woman led armed resistance against Italian colonization?", options: ["Yaa Asantewaa", "Queen Nzinga", "Nehanda Nyakasikana", "Taytu Betul"], correct: 3, hint: "Wife of Emperor Menelik II of Ethiopia.", category: "History"},
        {question: "Sahara Desert covers what percentage of Africa?", options: ["15%", "25%", "35%", "45%"], correct: 1, hint: "World's largest hot desert.", category: "Geography"},
        {question: "Which country was formerly Rhodesia?", options: ["Zambia", "Zimbabwe", "Malawi", "Botswana"], correct: 1, hint: "Gained independence in 1980.", category: "History"},
        {question: "AfCFTA was established in which year?", options: ["2015", "2018", "2021", "2023"], correct: 1, hint: "Trading began in 2021.", category: "Economy"},
        {question: "Who is the 'Father of Afrobeat'?", options: ["Miriam Makeba", "Fela Kuti", "Youssou N'Dour", "Salif Keita"], correct: 1, hint: "Nigerian musician combined jazz, funk, and traditional rhythms.", category: "Culture"},
        {question: "Mount Kilimanjaro has how many volcanic cones?", options: ["One", "Two", "Three", "Four"], correct: 2, hint: "Kibo, Mawenzi, and Shira.", category: "Geography"},
        {question: "Apartheid officially ended in which year?", options: ["1990", "1991", "1994", "1996"], correct: 2, hint: "Year of first democratic elections.", category: "History"},
        {question: "Which country has highest GDP per capita in Africa?", options: ["Seychelles", "Mauritius", "Botswana", "South Africa"], correct: 0, hint: "Island nation with thriving tourism.", category: "Economy"},
        {question: "Dogon people, known for astronomy, live where?", options: ["Burkina Faso", "Mali", "Niger", "Senegal"], correct: 1, hint: "Bandiagara Escarpment region.", category: "Culture"}
    ],
    
    level5: [
        {question: "Which kingdom resisted Portuguese for 400+ years?", options: ["Kingdom of Kongo", "Kingdom of Benin", "Kingdom of Aksum", "Ashanti"], correct: 1, hint: "Located in present-day Nigeria.", category: "History"},
        {question: "Independent African nations by 1914?", options: ["None", "Two", "Five", "Ten"], correct: 1, hint: "Ethiopia and Liberia only.", category: "History"},
        {question: "Second-largest river flow rate in world?", options: ["Nile", "Niger", "Congo", "Zambezi"], correct: 2, hint: "Second only to Amazon.", category: "Geography"},
        {question: "Mau Mau uprising occurred where?", options: ["Kenya", "Zimbabwe", "South Africa", "Algeria"], correct: 0, hint: "Against British in 1950s.", category: "History"},
        {question: "First African Nobel Literature Prize (1986)?", options: ["Chinua Achebe", "Wole Soyinka", "Nadine Gordimer", "Ngugi wa Thiong'o"], correct: 1, hint: "First African to win.", category: "Literature"},
        {question: "Battle of Adwa (1896): Ethiopia defeated?", options: ["Britain", "France", "Italy", "Germany"], correct: 2, hint: "Preserved Ethiopian independence.", category: "History"},
        {question: "Most UNESCO World Heritage Sites in Africa?", options: ["Egypt", "Ethiopia", "South Africa", "Morocco"], correct: 0, hint: "Ancient monuments and sites.", category: "Culture"},
        {question: "World's largest inland delta location?", options: ["Namibia", "Botswana", "Zimbabwe", "Zambia"], correct: 1, hint: "Okavango Delta ecosystem.", category: "Geography"},
        {question: "First AU Summit 2002 location?", options: ["Ethiopia", "South Africa", "Senegal", "Egypt"], correct: 1, hint: "AU replaced OAU here.", category: "Politics"},
        {question: "Ancient Ge'ez script still used where?", options: ["Egypt", "Ethiopia", "Sudan", "Eritrea"], correct: 1, hint: "Script over 2,000 years old.", category: "Culture"}
    ],
    
    level6: [
        {question: "Kingdom with 'Dahomey Amazons' female regiment?", options: ["Ashanti", "Dahomey", "Zulu", "Kongo"], correct: 1, hint: "Present-day Benin.", category: "History"},
        {question: "Rosetta Stone found in which year?", options: ["1699", "1755", "1799", "1822"], correct: 2, hint: "Napoleon's troops discovered it.", category: "History"},
        {question: "Which country has most pyramids?", options: ["Egypt", "Sudan", "Ethiopia", "Libya"], correct: 1, hint: "Nubian pyramids outnumber Egypt's.", category: "History"},
        {question: "Barbary Coast refers to which region?", options: ["East Africa", "West Africa", "North Africa", "Southern Africa"], correct: 2, hint: "Morocco, Algeria, Tunisia, Libya.", category: "Geography"},
        {question: "Who coined 'African Personality'?", options: ["Kwame Nkrumah", "L√©opold Senghor", "Patrice Lumumba", "Jomo Kenyatta"], correct: 0, hint: "Promoted Pan-Africanism.", category: "Politics"},
        {question: "Olduvai Gorge location?", options: ["Kenya", "Ethiopia", "Tanzania", "South Africa"], correct: 2, hint: "Leakey family discoveries.", category: "History"},
        {question: "First African independence in 20th century?", options: ["Ghana", "Libya", "Morocco", "Tunisia"], correct: 1, hint: "Independence in 1951.", category: "History"},
        {question: "Trans-Saharan trade: gold for what?", options: ["Spices", "Salt", "Ivory", "Textiles"], correct: 1, hint: "As valuable as gold in some regions.", category: "History"},
        {question: "World's largest vanilla producer?", options: ["Kenya", "Tanzania", "Madagascar", "Uganda"], correct: 2, hint: "Produces 80% of world's vanilla.", category: "Economy"},
        {question: "Who developed 'N√©gritude' concept?", options: ["Aim√© C√©saire", "L√©opold Senghor", "L√©on-Gontran Damas", "Frantz Fanon"], correct: 1, hint: "First president of Senegal.", category: "Culture"}
    ],
    
    level7: [
        {question: "Kingdom with cowrie shell record-keeping?", options: ["Benin", "Yoruba", "Ashanti", "Kongo"], correct: 2, hint: "Used for currency and records.", category: "History"},
        {question: "Undeciphered Meroitic script civilization?", options: ["Ancient Egypt", "Kingdom of Kush", "Aksum", "Carthage"], correct: 1, hint: "Nubian kingdom after 25th Dynasty.", category: "History"},
        {question: "Lowest population density in Africa?", options: ["Namibia", "Botswana", "Libya", "Mauritania"], correct: 0, hint: "Covered by Namib Desert.", category: "Geography"},
        {question: "Kilwa Sultanate present-day location?", options: ["Kenya", "Tanzania", "Mozambique", "Somalia"], correct: 1, hint: "Controlled Indian Ocean trade.", category: "History"},
        {question: "African scientist: gamma knife development?", options: ["Philip Emeagwali", "Cheikh Anta Diop", "Wangari Maathai", "Lars Leksell"], correct: 0, hint: "Also contributed to supercomputing.", category: "Science"},
        {question: "Rift Valley extends through how many countries?", options: ["6", "9", "12", "15"], correct: 1, hint: "Lebanon to Mozambique.", category: "Geography"},
        {question: "Tanganyika + Zanzibar formed?", options: ["Kenya", "Tanzania", "Uganda", "Malawi"], correct: 1, hint: "Merged in 1964.", category: "History"},
        {question: "Sahelian kingdoms' primary resource?", options: ["Gold", "Salt", "Ivory", "Iron"], correct: 0, hint: "Ghana, Mali, Songhai empires.", category: "History"},
        {question: "Most active volcanoes in Africa?", options: ["Kenya", "Tanzania", "Ethiopia", "DR Congo"], correct: 3, hint: "Mount Nyiragongo is active.", category: "Geography"},
        {question: "'Ubuntu' philosophy means?", options: ["'I am because we are'", "'Unity is strength'", "'Knowledge is power'", "'Freedom or death'"], correct: 0, hint: "Southern African interconnectedness.", category: "Culture"}
    ],
    
    level8: [
        {question: "Emperor's pilgrimage caused Cairo inflation?", options: ["Ghana", "Mali", "Songhai", "Kanem-Bornu"], correct: 1, hint: "Mansa Musa's 1324 pilgrimage.", category: "History"},
        {question: "Khoisan language unique feature?", options: ["Tonal variations", "Click consonants", "Whistled speech", "Sign integration"], correct: 1, hint: "Among Africa's oldest languages.", category: "Culture"},
        {question: "'Father of African Historiography'?", options: ["Joseph Ki-Zerbo", "Cheikh Anta Diop", "Ali Mazrui", "Walter Rodney"], correct: 1, hint: "Argued for African origin of Egypt.", category: "History"},
        {question: "Swahili fusion of which cultures?", options: ["Bantu and Arab", "Cushitic and Persian", "Nilotic and Indian", "Berber and Egyptian"], correct: 0, hint: "Coastal trading culture.", category: "History"},
        {question: "Most diverse ecosystem per km¬≤?", options: ["Madagascar", "Tanzania", "Kenya", "South Africa"], correct: 0, hint: "90% wildlife found nowhere else.", category: "Geography"},
        {question: "Hannibal attacked which empire?", options: ["Greek", "Roman", "Persian", "Macedonian"], correct: 1, hint: "Used war elephants.", category: "History"},
        {question: "First 50% female parliament?", options: ["Rwanda", "South Africa", "Senegal", "Namibia"], correct: 0, hint: "Leads world in gender parity.", category: "Politics"},
        {question: "Library of Alexandria dynasty?", options: ["Ptolemaic", "Roman", "Persian", "Nubian"], correct: 0, hint: "After Alexander the Great.", category: "History"},
        {question: "'Cradle of Humankind' location?", options: ["Rift Valley", "Olduvai Gorge", "Sterkfontein Caves", "Afar Triangle"], correct: 2, hint: "South African hominin fossils.", category: "History"},
        {question: "'Lost City of Kalahari' country?", options: ["Botswana", "Namibia", "South Africa", "Zimbabwe"], correct: 0, hint: "Legendary Kalahari civilization.", category: "Culture"}
    ],
    
    level9: [
        {question: "Advanced bronze casting before Europeans?", options: ["Benin", "Ashanti", "Kongo", "Zulu"], correct: 0, hint: "Benin Bronzes masterpieces.", category: "History"},
        {question: "Kebra Nagast claims Ark in which city?", options: ["Addis Ababa", "Gondar", "Lalibela", "Axum"], correct: 3, hint: "Ancient Aksumite capital.", category: "Culture"},
        {question: "Ishango bone developers?", options: ["Ancient Egyptians", "Nubians", "Ishango people", "Yoruba"], correct: 2, hint: "20,000-year-old math tool.", category: "Science"},
        {question: "Kush conquered Egypt: which dynasty?", options: ["23rd", "24th", "25th", "26th"], correct: 2, hint: "Ruled 100 years (744-656 BCE).", category: "History"},
        {question: "Highest linguistic diversity region?", options: ["West Africa", "East Africa", "Central Africa", "Southern Africa"], correct: 0, hint: "Nigeria has 500+ languages.", category: "Culture"},
        {question: "Igbo-Ukwu bronze artifacts date?", options: ["5th century", "7th century", "9th century", "11th century"], correct: 2, hint: "Predate European contact.", category: "History"},
        {question: "First paperless parliament?", options: ["Kenya", "Rwanda", "Ghana", "South Africa"], correct: 1, hint: "Rapid technological advancement.", category: "Politics"},
        {question: "Sankore Madrasah manuscripts count?", options: ["100,000", "400,000", "700,000", "1,000,000"], correct: 2, hint: "Largest medieval libraries.", category: "History"},
        {question: "Nobel Chemistry 1999 African scientist?", options: ["Ahmed Zewail", "Sydney Brenner", "Aaron Klug", "Max Theiler"], correct: 0, hint: "Egyptian chemist, femtochemistry.", category: "Science"},
        {question: "Great Zimbabwe building technique?", options: ["Mortared stone", "Dry stone walling", "Mud brick", "Wood framework"], correct: 1, hint: "No mortar used.", category: "History"}
    ],
    
    level10: [
        {question: "Philosopher developed 'Conscientism'?", options: ["Kwame Nkrumah", "Julius Nyerere", "Cheikh Anta Diop", "L√©opold Senghor"], correct: 0, hint: "Reconcile tradition with modernity.", category: "Philosophy"},
        {question: "Mapungubwe traded what with China?", options: ["Gold", "Ivory", "Copper", "Iron"], correct: 0, hint: "Chinese porcelain found at site.", category: "History"},
        {question: "Oldest sub-Saharan inhabited city?", options: ["Ethiopia", "Sudan", "Nigeria", "Senegal"], correct: 0, hint: "Harar, 4th holiest Islamic city.", category: "History"},
        {question: "Ajuran Sultanate hydraulic engineering location?", options: ["Kenya", "Tanzania", "Somalia", "Ethiopia"], correct: 2, hint: "Sophisticated irrigation systems.", category: "History"},
        {question: "First African country to ban plastic bags?", options: ["Kenya", "Rwanda", "Tanzania", "Uganda"], correct: 1, hint: "2008 environmental policy.", category: "Politics"},
        {question: "Which African script predates Arabic in region?", options: ["Tifinagh", "N'Ko", "Vai", "Ge'ez"], correct: 3, hint: "Ethiopian ancient script.", category: "Culture"},
        {question: "Africa's oldest university (859 CE)?", options: ["Al-Azhar", "University of Al Quaraouiyine", "Sankore", "University of Timbuktu"], correct: 1, hint: "Located in Fez, Morocco.", category: "History"},
        {question: "First African satellite launched by?", options: ["South Africa", "Nigeria", "Egypt", "Kenya"], correct: 1, hint: "NigeriaSat-1 in 2003.", category: "Science"},
        {question: "Pan-African Parliament headquarters?", options: ["Addis Ababa", "Johannesburg", "Midrand", "Nairobi"], correct: 2, hint: "South African city.", category: "Politics"},
        {question: "Which civilization built Lalibela's rock churches?", options: ["Aksumites", "Zagwe dynasty", "Solomonic dynasty", "Beta Israel"], correct: 1, hint: "12th-13th century Ethiopian dynasty.", category: "History"}
    
            ],
           level11: [
    {question: "Kemet is the ancient name for which civilization?", options: ["Nubia", "Ancient Egypt", "Ethiopia", "Carthage"], correct: 1, hint: "Means 'Black Land' referring to the Nile's fertile soil.", category: "History"},
    {question: "The Axumite Empire created which famous structures?", options: ["Pyramids", "Stone circles", "Obelisks/Stelae", "Rock churches"], correct: 2, hint: "Tall stone monuments, some over 30 meters high.", category: "History"},
    {question: "Which African language has the most native speakers?", options: ["Swahili", "Hausa", "Yoruba", "Amharic"], correct: 0, hint: "Spoken by 100+ million across East Africa.", category: "Culture"},
    {question: "The Mau Mau uprising fought against colonial rule in:", options: ["Kenya", "Zimbabwe", "Algeria", "Ghana"], correct: 0, hint: "1952-1960 rebellion led by Kikuyu people.", category: "History"},
    {question: "Africa has what percentage of world's mineral reserves?", options: ["15%", "30%", "50%", "65%"], correct: 1, hint: "Holds vast reserves of gold, diamonds, coltan, cobalt.", category: "Economy"},
    {question: "Which African country was a staging ground for the transatlantic slave trade?", options: ["Senegal (Gor√©e Island)", "Morocco", "Egypt", "South Africa"], correct: 0, hint: "Island fortress served as major departure point.", category: "History"},
    {question: "Ubuntu philosophy originates from which language group?", options: ["Nilotic", "Cushitic", "Bantu", "Afro-Asiatic"], correct: 2, hint: "Southern and Central African philosophy.", category: "Culture"},
    {question: "The Great Mosque of Djenn√© is built using which material?", options: ["Stone", "Wood", "Adobe/Mud brick", "Coral"], correct: 2, hint: "Must be replastered annually, world's largest mud structure.", category: "Construction"},
    {question: "Which resource has caused most conflict in modern Africa?", options: ["Diamonds", "Oil", "Coltan", "Gold"], correct: 1, hint: "Nigeria, Angola, Sudan conflicts linked to this.", category: "Economy"},
    {question: "Vodun (Voodoo) religion originated in which region?", options: ["West Africa", "North Africa", "East Africa", "Central Africa"], correct: 0, hint: "Benin, Togo, Ghana traditional spiritual practice.", category: "Religion"}
],

level12: [
    {question: "Neocolonialism primarily operates through:", options: ["Military occupation", "Economic dependency", "Cultural erasure", "Religious conversion"], correct: 1, hint: "Control through debt, aid conditions, unfair trade.", category: "Politics"},
    {question: "Which Kemetic deity represented resurrection and afterlife?", options: ["Ra", "Osiris", "Horus", "Anubis"], correct: 1, hint: "Brother of Set, father of Horus.", category: "Religion"},
    {question: "The San people are indigenous to which region?", options: ["Horn of Africa", "Sahel", "Kalahari Desert", "Congo Basin"], correct: 2, hint: "Among Africa's oldest populations, hunter-gatherers.", category: "Culture"},
    {question: "Africa produces what percentage of world's cocoa?", options: ["50%", "60%", "70%", "80%"], correct: 2, hint: "Ivory Coast and Ghana are top producers.", category: "Economy"},
    {question: "The Scramble for Africa resulted in how many artificial borders?", options: ["Hundreds", "Thousands", "Tens of thousands", "Over 100,000 km"], correct: 3, hint: "Colonial borders ignored ethnic and cultural boundaries.", category: "History"},
    {question: "Which African script was used in Timbuktu manuscripts?", options: ["Arabic", "Ge'ez", "Tifinagh", "N'Ko"], correct: 0, hint: "Modified Arabic script for African languages.", category: "Culture"},
    {question: "The Mfecane resulted from:", options: ["Drought", "European invasion", "Zulu expansion", "Slave trade"], correct: 2, hint: "Shaka Zulu's military campaigns caused mass migration.", category: "History"},
    {question: "Great Zimbabwe's walls were built without:", options: ["Tools", "Mortar", "Planning", "Labor"], correct: 1, hint: "Dry-stone construction technique perfected.", category: "Construction"},
    {question: "Which mineral is essential for smartphones, mostly from Congo?", options: ["Lithium", "Cobalt", "Coltan", "Copper"], correct: 2, hint: "Conflict mineral, 60% from DRC.", category: "Economy"},
    {question: "Ifa divination system originates from which people?", options: ["Yoruba", "Igbo", "Akan", "Zulu"], correct: 0, hint: "Complex spiritual knowledge system, UNESCO heritage.", category: "Religion"}
],

level13: [
    {question: "The term 'Middle Passage' refers to:", options: ["Trans-Saharan trade route", "Slave ship journey", "Colonial highway", "Nile navigation"], correct: 1, hint: "Horrific Atlantic crossing, millions died.", category: "History"},
    {question: "Kemet's greatest architectural achievement?", options: ["Sphinx", "Pyramids of Giza", "Valley of Kings", "Abu Simbel"], correct: 1, hint: "Built 4,500 years ago, one of Seven Wonders.", category: "Construction"},
    {question: "How many indigenous African languages exist?", options: ["500", "1,000", "2,000+", "5,000"], correct: 2, hint: "Over 2,000 distinct languages, most diverse continent.", category: "Culture"},
    {question: "Which European power colonized the most African territory?", options: ["Britain", "France", "Portugal", "Belgium"], correct: 1, hint: "Controlled vast West and Central African regions.", category: "History"},
    {question: "The Dogon people accurately mapped which celestial object?", options: ["Mars", "Sirius B", "Jupiter's moons", "Saturn's rings"], correct: 1, hint: "Knew of invisible companion star before telescopes.", category: "Science"},
    {question: "African Union headquarters funded by which country?", options: ["USA", "China", "France", "Saudi Arabia"], correct: 1, hint: "Built in Addis Ababa, raises neocolonial concerns.", category: "Politics"},
    {question: "Rastafarianism considers which leader as messiah?", options: ["Marcus Garvey", "Haile Selassie", "Bob Marley", "Malcolm X"], correct: 1, hint: "Ethiopian emperor Ras Tafari Makonnen.", category: "Religion"},
    {question: "Lalibela's rock churches carved from:", options: ["Granite", "Volcanic rock", "Single stone blocks", "Sandstone"], correct: 2, hint: "11 churches hewn from solid rock, 12th century.", category: "Construction"},
    {question: "What percentage of Europe's industrial revolution funded by African resources?", options: ["10-20%", "30-40%", "50-60%", "Over 70%"], correct: 3, hint: "Slavery, gold, raw materials built European wealth.", category: "Economy"},
    {question: "Which spiritual practice links African diaspora worldwide?", options: ["Christianity", "Islam", "Ancestral veneration", "Buddhism"], correct: 2, hint: "Honoring ancestors common across African traditions.", category: "Religion"}
],

level14: [
    {question: "The Berlin Conference (1884-85) divided Africa among how many European powers?", options: ["5", "7", "14", "21"], correct: 2, hint: "No Africans invited to decide continent's fate.", category: "History"},
    {question: "Axum controlled trade between which regions?", options: ["Europe and Asia", "Africa and Arabia", "Mediterranean and India", "All of above"], correct: 3, hint: "Major trading empire, 1st-7th century CE.", category: "History"},
    {question: "The Khoisan click languages have how many distinct clicks?", options: ["3-5", "10-15", "20-30", "Over 40"], correct: 3, hint: "Most complex phonetic system in world.", category: "Culture"},
    {question: "French still controls currency of how many African countries?", options: ["2", "8", "14", "22"], correct: 2, hint: "CFA Franc zone, modern colonialism.", category: "Economy"},
    {question: "Mau Mau fighters' primary grievance was:", options: ["Taxation", "Land theft", "Forced labor", "Cultural suppression"], correct: 1, hint: "British seized fertile Kikuyu lands for settlers.", category: "History"},
    {question: "The Nok culture (500 BCE) excelled in:", options: ["Navigation", "Iron smelting", "Astronomy", "Mathematics"], correct: 1, hint: "Advanced iron technology in Nigeria.", category: "Science"},
    {question: "Which African resource powers electric vehicle batteries?", options: ["Lithium", "Cobalt", "Nickel", "Graphite"], correct: 1, hint: "DRC has 70% of world's reserves, child labor concerns.", category: "Economy"},
    {question: "The Egungun masquerade tradition honors:", options: ["Harvest", "Ancestors", "Royalty", "Warriors"], correct: 1, hint: "Yoruba tradition, masked dancers embody departed souls.", category: "Culture"},
    {question: "Great Mosque of Djenn√© rebuilt how often?", options: ["Every 5 years", "Annually", "Every 10 years", "When damaged"], correct: 1, hint: "Community replastering festival maintains structure.", category: "Construction"},
    {question: "Estimated Africans enslaved in transatlantic trade:", options: ["2-5 million", "8-10 million", "12-15 million", "20+ million"], correct: 2, hint: "Millions more died during capture and passage.", category: "History"}
],

level15: [
    {question: "Kemet means 'Black Land,' Ta-Seti means:", options: ["Red Land", "Land of the Bow", "Upper Kingdom", "Divine Land"], correct: 1, hint: "Ancient Nubia, south of Kemet.", category: "History"},
    {question: "The Akan Goldweight system measured:", options: ["Distance", "Time", "Gold dust currency", "Grain"], correct: 2, hint: "Precise brass weights, also proverbs in metal.", category: "Economy"},
    {question: "How many years did Haitian Revolution take to defeat France?", options: ["3", "7", "13", "20"], correct: 2, hint: "1791-1804, first Black republic, led by enslaved.", category: "History"},
    {question: "African philosophy emphasizes:", options: ["Individualism", "Communalism", "Materialism", "Nihilism"], correct: 1, hint: "Community over individual, Ubuntu worldview.", category: "Culture"},
    {question: "Which dam project displaced millions in Africa?", options: ["Aswan Dam", "Kariba Dam", "Akosombo Dam", "All above"], correct: 3, hint: "Development without consent, neocolonial projects.", category: "Politics"},
    {question: "The Igbo-Ukwu bronze castings date to:", options: ["5th century CE", "9th century CE", "13th century CE", "15th century CE"], correct: 1, hint: "Predates European contact, complex metalwork.", category: "Science"},
    {question: "Swahili language is mixture of Bantu and:", options: ["Arabic", "Portuguese", "Hindi", "Persian"], correct: 0, hint: "Indian Ocean trade created linguistic fusion.", category: "Culture"},
    {question: "The Saadian Tombs in Marrakech use which architectural style?", options: ["Gothic", "Islamic-Andalusian", "Byzantine", "Romanesque"], correct: 1, hint: "Intricate tilework, cedar ceilings, 16th century.", category: "Construction"},
    {question: "Structural Adjustment Programs (SAPs) forced Africa to:", options: ["Industrialize", "Privatize resources", "Build schools", "Reject aid"], correct: 1, hint: "IMF/World Bank policies, debt trap diplomacy.", category: "Economy"},
    {question: "Which orisha (deity) represents iron, war, and technology?", options: ["Shango", "Ogun", "Obatala", "Yemoja"], correct: 1, hint: "Yoruba blacksmith god, patron of civilization.", category: "Religion"}
],

level16: [
    {question: "The Kingdom of Kush conquered and ruled Egypt as which dynasty?", options: ["21st", "23rd", "25th", "27th"], correct: 2, hint: "744-656 BCE, Nubian pharaohs unified Nile Valley.", category: "History"},
    {question: "Africa loses how much annually to illicit financial flows?", options: ["$10 billion", "$50 billion", "$88 billion+", "$200 billion"], correct: 2, hint: "Tax evasion, corruption, resource theft by multinationals.", category: "Economy"},
    {question: "The Maafa refers to:", options: ["Great drought", "African Holocaust/slavery", "Colonial wars", "Berlin Conference"], correct: 1, hint: "Swahili for 'great disaster,' slavery and colonization.", category: "History"},
    {question: "Which African writing system has over 260 characters?", options: ["Ge'ez", "Vai", "N'Ko", "Adlam"], correct: 0, hint: "Ethiopian script, used for Amharic and Tigrinya.", category: "Culture"},
    {question: "The Meroitic pyramids are:", options: ["Larger than Giza", "More numerous than Egypt's", "Made of gold", "Underground"], correct: 1, hint: "Sudan has 200+ pyramids, Egypt has ~120.", category: "History"},
    {question: "Which African scientist developed blood plasma storage?", options: ["Charles Drew", "Philip Emeagwali", "Wangari Maathai", "Cheikh Anta Diop"], correct: 0, hint: "African-American pioneer, blood banking during WWII.", category: "Science"},
    {question: "The Sankore University in Timbuktu had how many students at peak?", options: ["5,000", "15,000", "25,000", "50,000"], correct: 2, hint: "Medieval Africa's Harvard, 12th-16th century.", category: "History"},
    {question: "Ndebele houses are famous for:", options: ["Height", "Geometric painted patterns", "Underground rooms", "Thatched domes"], correct: 1, hint: "South African women's vibrant wall art tradition.", category: "Culture"},
    {question: "Leopold II killed how many Congolese for rubber?", options: ["100,000", "1 million", "5-10 million", "20 million"], correct: 2, hint: "Belgian Congo genocide, hands cut for quotas.", category: "History"},
    {question: "The concept of Ma'at in Kemet represents:", options: ["Death", "Truth, justice, cosmic balance", "Warfare", "Wealth"], correct: 1, hint: "Foundational principle, weighing heart against feather.", category: "Religion"}
],

level17: [
    {question: "Which resource curse affects Nigeria most?", options: ["Diamond wars", "Oil corruption", "Gold smuggling", "Timber exploitation"], correct: 1, hint: "Vast oil wealth, little development, extreme inequality.", category: "Economy"},
    {question: "The Zulu impi formation used which revolutionary tactic?", options: ["Cavalry charge", "Horns of the Bull", "Phalanx", "Guerrilla warfare"], correct: 1, hint: "Encirclement strategy, devastating effectiveness.", category: "History"},
    {question: "Africa has what fraction of world's remaining wilderness?", options: ["1/10", "1/4", "1/3", "1/2"], correct: 2, hint: "Last great wildlife habitats, under threat.", category: "Geography"},
    {question: "The Manden Charter (1222 CE) established:", options: ["Trade rules", "Human rights principles", "Religious law", "Military code"], correct: 1, hint: "Mali Empire, abolition of slavery, women's rights.", category: "History"},
    {question: "How many African artifacts are in European museums?", options: ["Thousands", "Hundreds of thousands", "Millions", "Unknown"], correct: 2, hint: "Looted during colonization, calls for repatriation.", category: "Culture"},
    {question: "The Ishango bone (20,000 BCE) suggests knowledge of:", options: ["Writing", "Mathematics/prime numbers", "Navigation", "Medicine"], correct: 1, hint: "DRC discovery, possible lunar calendar, math notation.", category: "Science"},
    {question: "Which healing tradition uses divination and herbs?", options: ["Western medicine", "Traditional African medicine", "Ayurveda", "Chinese medicine"], correct: 1, hint: "Sangomas, herbalists, 80% Africans use traditional healers.", category: "Culture"},
    {question: "The ancient city of Meroe specialized in:", options: ["Glass making", "Iron production", "Silk weaving", "Pottery"], correct: 1, hint: "Sudan's 'Birmingham of Africa,' massive iron industry.", category: "Science"},
    {question: "Fran√ßafrique refers to:", options: ["French culture in Africa", "French neocolonial control", "French aid programs", "Language policy"], correct: 1, hint: "Shadow agreements maintaining French dominance.", category: "Politics"},
    {question: "The baobab tree is sacred in many traditions because:", options: ["Immortal", "Provides food, water, medicine", "Home to spirits", "All above"], correct: 3, hint: "Tree of Life, lives thousands of years.", category: "Culture"}
],

level18: [
    {question: "The Axumite King Ezana converted to Christianity in:", options: ["100 CE", "330 CE", "500 CE", "700 CE"], correct: 1, hint: "Before Roman Empire officially adopted it.", category: "History"},
    {question: "Land grabs in Africa total how many hectares since 2000?", options: ["1 million", "10 million", "50 million", "100+ million"], correct: 2, hint: "Foreign governments and corporations seizing farmland.", category: "Economy"},
    {question: "The Mau Mau oath-taking ceremonies emphasized:", options: ["Loyalty to Britain", "Unity against colonizers", "Religious conversion", "Trade agreements"], correct: 1, hint: "Sacred oaths binding fighters to liberation struggle.", category: "History"},
    {question: "Which African language family is largest?", options: ["Afro-Asiatic", "Nilo-Saharan", "Niger-Congo", "Khoisan"], correct: 2, hint: "Includes Bantu languages, 1,500+ languages.", category: "Culture"},
    {question: "The African Renaissance Monument in Senegal is:", options: ["Tallest statue in Africa", "Made of gold", "Underground", "Floating"], correct: 0, hint: "49 meters, controversial Chinese-built project.", category: "Construction"},
    {question: "Which Egyptian deity represents wisdom and writing?", options: ["Thoth", "Ptah", "Bes", "Sekhmet"], correct: 0, hint: "Ibis-headed god, inventor of hieroglyphics.", category: "Religion"},
    {question: "Colonial education in Africa primarily taught:", options: ["Traditional knowledge", "Subservience and labor", "Science and technology", "Indigenous languages"], correct: 1, hint: "Designed to create docile workers, not leaders.", category: "History"},
    {question: "The Benin Bronzes were looted during:", options: ["1897 British invasion", "Slave trade", "WWI", "WWII"], correct: 0, hint: "Punitive expedition destroyed Benin City.", category: "History"},
    {question: "How much does Africa spend importing food it could grow?", options: ["$10 billion", "$35 billion+", "$50 billion", "$100 billion"], correct: 1, hint: "Neocolonial agriculture focused on export crops.", category: "Economy"},
    {question: "The Lemba people of Southern Africa claim descent from:", options: ["Ancient Egypt", "Lost tribe of Israel", "Phoenicians", "Romans"], correct: 1, hint: "DNA evidence supports Hebrew ancestry claims.", category: "Culture"}
],

level19: [
    {question: "Kemet's Book of Coming Forth by Day (Book of Dead) contains:", options: ["Laws", "Spells for afterlife journey", "Poetry", "History"], correct: 1, hint: "Guide through Duat (underworld), 42 declarations.", category: "Religion"},
    {question: "The Haitian Revolution cost France how much in modern value?", options: ["$1 billion", "$21 billion", "$100 billion", "$300+ billion"], correct: 3, hint: "Lost richest colony, Napoleon sold Louisiana as result.", category: "History"},
    {question: "Which African university is oldest in continuous operation?", options: ["Al-Azhar (Egypt)", "Al Quaraouiyine (Morocco)", "Timbuktu", "Alexandria"], correct: 1, hint: "Founded 859 CE, still operating, Fez, Morocco.", category: "History"},
    {question: "Colonizers justified slavery through:", options: ["Economic need", "Racial pseudoscience", "Religious doctrine", "All above"], correct: 3, hint: "Constructed racism to justify exploitation.", category: "History"},
    {question: "The Himba people of Namibia are known for:", options: ["Stilt houses", "Otjize paste beauty practice", "Underwater homes", "Tree dwellings"], correct: 1, hint: "Red ochre paste, traditional pastoralist culture.", category: "Culture"},
    {question: "Which African invented the gamma electric cell?", options: ["Samuel Kounessi", "Thomas Mensah", "George Carruthers", "Lonnie Johnson"], correct: 0, hint: "Togolese inventor, improved battery technology.", category: "Science"},
    {question: "The Great Enclosure at Great Zimbabwe had walls:", options: ["5 meters high", "11 meters high", "20 meters high", "30 meters high"], correct: 1, hint: "Without mortar, precise stonework, 15th century.", category: "Construction"},
    {question: "Debt servicing costs Africa what percentage of government budgets?", options: ["5-10%", "15-20%", "25-40%", "50%+"], correct: 2, hint: "Paying Western banks instead of schools, hospitals.", category: "Economy"},
    {question: "The Odinani spirituality of Igbo people centers on:", options: ["One supreme god", "Chi (personal god) and Ala (earth goddess)", "Ancestor worship only", "Nature spirits"], correct: 1, hint: "Complex cosmology, individual destiny (chi).", category: "Religion"},
    {question: "How many Africans died during colonialism (1885-1945)??", options: ["5 million", "15 million", "50 million+", "100 million"], correct: 2, hint: "Genocide, forced labor, famine, disease from colonial rule.", category: "History"}
],

level20: [
    {question: "The 25th Dynasty pharaohs were known as:", options: ["Sea peoples", "Black Pharaohs/Nubian Dynasty", "Persian rulers", "Greek dynasty"], correct: 1, hint: "Kushite rulers who saved Egypt from Assyrians.", category: "History"},
    {question: "Pan-Africanism was founded by:", options: ["Kwame Nkrumah", "W.E.B. Du Bois & Marcus Garvey", "Haile Selassie", "Thomas Sankara"], correct: 1, hint: "Diaspora leaders connecting all African peoples.", category: "Politics"},
    {question: "The Timbuktu manuscripts contain knowledge on:", options: ["Astronomy", "Medicine", "Law and philosophy", "All above"], correct: 3, hint: "700,000+ manuscripts, medieval African scholarship.", category: "History"},
    {question: "Resource extraction from Africa creates:", options: ["Development", "Conflict and poverty", "Infrastructure", "Education"], correct: 1, hint: "Wealth flows out, corruption and war remain.", category: "Economy"},
    {question: "The talking drum can communicate:", options: ["Rhythms only", "Tonal languages/complete sentences", "Morse code", "Music only"], correct: 1, hint: "Mimics speech tones, sends messages across distances.", category: "Culture"},
    {question: "Who proved ancient Egyptians were Black Africans through science?", options: ["Cheikh Anta Diop", "Carter G. Woodson", "Yosef Ben-Jochannan", "John Henrik Clarke"], correct: 0, hint: "Senegalese scientist, melanin tests, cultural analysis.", category: "Science"},
    {question: "The Kasubi Tombs in Uganda are built using:", options: ["Stone", "Organic materials (bark, reeds)", "Mud brick", "Concrete"], correct: 1, hint: "Traditional Buganda architecture, UNESCO site.", category: "Construction"},
    {question: "Africa's youth population (under 25) is approximately:", options: ["30%", "45%", "60%", "75%"], correct: 2, hint: "Youngest continent, demographic dividend potential.", category: "Demographics"},
    {question: "The Vodun concept of 'Mami Wata' represents:", options: ["Earth mother", "Water spirit/deity", "War goddess", "Harvest spirit"], correct: 1, hint: "Mermaid-like deity, wealth and danger, pan-African.", category: "Religion"},
    {question: "Patrice Lumumba was assassinated for:", options: ["Corruption", "Wanting Congo's independence and resources", "Religious views", "Tribal conflicts"], correct: 1, hint: "CIA/Belgium killed first democratically elected leader, 1961.", category: "History"}
]
        };
        function initGame() {
    // No longer need to generate questions - all defined now
    
    const levelIndicator = document.getElementById('levelIndicator');
    levelIndicator.innerHTML = '';
    
    // UPDATED: Create 20 level dots
    for (let i = 1; i <= 20; i++) {
        const levelDot = document.createElement('div');
        levelDot.className = 'level-dot';
        levelDot.id = `level${i}`;
        levelDot.textContent = i;
        
        // Add stage indicator
        if (i === 11) {
            const stageLabel = document.createElement('div');
            stageLabel.style.cssText = 'width: 100%; text-align: center; color: #f7a440; font-weight: bold; margin: 10px 0;';
            stageLabel.textContent = '‚ö° Stage 2';
            levelIndicator.appendChild(stageLabel);
        }
        
        levelIndicator.appendChild(levelDot);
    }
    
    updateLevelIndicator();
}

        function startGame() {
    // Find the first uncompleted level
    let startLevel = 1;
    if (gameState.playMode === 'member') {
        for (let i = 1; i <= 20; i++) {  // FIXED: 20 levels
            if (!gameState.completedLevels.includes(i)) {
                startLevel = i;
                break;
            }
        }
    }
    
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'flex';
    
    gameState.gameStarted = true;
    gameState.currentLevel = startLevel;
    gameState.currentQuestion = 1;
    gameState.score = 0;
    gameState.questionsAnswered = 0;
    gameState.correctAnswers = 0;
    gameState.levelEarnings = 0;
    
    updateGameDisplay();
    loadQuestion();
    startTimer();
    
    if (typeof startLevelTimer === 'function') {
        startLevelTimer();
    }
    
    // Show helpful message if starting from middle
    if (startLevel > 1) {
        const stage = startLevel <= 10 ? 1 : 2;  // FIXED: Stage detection
        setTimeout(() => {
            alert(`üîç Continuing from Level ${startLevel} (Stage ${stage})\n\nYou've already completed levels 1-${startLevel - 1}.\n\nTotal earnings so far: ${iKbpTracker.getTotalEarned()} iKbp`);
        }, 500);
    }
        
console.log('‚úÖ Successfully advanced to level', gameState.currentLevel);
        }
        // ============================================
    // INITIALIZE ACHIEVEMENT SYSTEM - ADD THIS
    // ============================================
    
    // Update rank display
    updateRank(gameState.currentLevel);
    
    // Initialize badges
    initBadges();
    
    // Show achievement showcase
    document.getElementById('achievementShowcase').style.display = 'block';
        console.log('‚úÖ Successfully advanced to level', gameState.currentLevel);
        }
    
        // Replace your selectOption function with this:
function selectOption(index, element) {

    // Check if answer already submitted
    if (gameState.answerSubmitted) return;
    
    // Remove selected class from all options
    document.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
    });
    
    // Add selected class to clicked option
    element.classList.add('selected');
    gameState.selectedOption = index;
    
    // Enable submit button
    document.getElementById('submitBtn').disabled = false;
    
    // Clear any existing timeout
    if (window.answerTimeout) {
        clearTimeout(window.answerTimeout);
    }
    
    // AUTO-SUBMIT: Submit answer after 1 second delay
    window.answerTimeout = setTimeout(() => {
        if (!gameState.answerSubmitted) {
            submitAnswer();
        }
    }, 1000);
}


// Also make sure your submitAnswer function looks like this:
function submitAnswer() {
    if (gameState.selectedOption === null || gameState.answerSubmitted) return;
    
    gameState.answerSubmitted = true;
    
    const options = document.querySelectorAll('.option');
    const correctIndex = gameState.correctAnswer;
    
    // Clear any pending timeout
    if (window.answerTimeout) {
        clearTimeout(window.answerTimeout);
        window.answerTimeout = null;
    }
    
    // Add visual feedback and disable options
    options.forEach((option, index) => {
        option.classList.add('disabled');
        if (index === correctIndex) {
            option.classList.add('correct');
        } else if (index === gameState.selectedOption && index !== correctIndex) {
            option.classList.add('wrong');
        }
    });
    
    const difficultyMultiplier = gameState.difficultyMultipliers[gameState.currentLevel - 1];
    const basePoints = 100;
    
    if (gameState.selectedOption === correctIndex) {
        gameState.correctAnswers++;
        const pointsEarned = Math.round(basePoints * difficultyMultiplier);
        gameState.score += pointsEarned;
        // Play correct answer sound
        SOUNDS.correct();
        
        // Calculate iKbp for this question (25 iKbp per correct answer for members)
        if (gameState.playMode === 'member') {
            const iKbpEarned = 25;
            gameState.levelEarnings += iKbpEarned;
            document.getElementById('levelEarnings').textContent = gameState.levelEarnings;
            
            document.getElementById('hintArea').innerHTML = 
                `<span style="color: #4cc9f0">‚úì Correct! +${pointsEarned} points | +${iKbpEarned} iKbp</span>`;
        } else {
            document.getElementById('hintArea').innerHTML = 
                `<span style="color: #4cc9f0">‚úì Correct! +${pointsEarned} points</span>`;
        }} else {
        document.getElementById('hintArea').innerHTML = 
            `<span style="color: #ef476f">‚úó Incorrect. The correct answer was: ${options[correctIndex].textContent}</span>`;
        
        // Play wrong answer sound
        SOUNDS.wrong();
    }
    gameState.questionsAnswered++;
    document.getElementById('score').textContent = gameState.score;
    
    document.getElementById('submitBtn').disabled = true;
    document.getElementById('nextBtn').disabled = false;
    
    clearInterval(gameState.timerInterval);
    
    // Auto-advance after 2 seconds
    setTimeout(() => {
        if (gameState.currentQuestion < 10) {
            nextQuestion();
        } else {
            completeLevel();
        }
    }, 2000);
}

// Make sure loadQuestion resets everything properly:
function loadQuestion() {
    const levelKey = `level${gameState.currentLevel}`;
    gameState.levelQuestions = questionsDatabase[levelKey];
    
    if (!gameState.levelQuestions || gameState.levelQuestions.length === 0) {
        console.error(`No questions found for ${levelKey}`);
        return;
    }
    
    const questionIndex = gameState.currentQuestion - 1;
    const question = gameState.levelQuestions[questionIndex];
    
    if (!question) {
        console.error(`No question found at index ${questionIndex}`);
        return;
    }
    
    document.getElementById('questionText').textContent = question.question;
    document.getElementById('difficulty').textContent = getDifficultyText(gameState.currentLevel);
    
    const progressPercent = (gameState.currentQuestion / 10) * 100;
    document.getElementById('questionProgress').style.width = `${progressPercent}%`;
    
    const optionsContainer = document.getElementById('optionsContainer');
    optionsContainer.innerHTML = '';
    
    gameState.correctAnswer = question.correct;
    gameState.selectedOption = null;
    gameState.answerSubmitted = false; // IMPORTANT: Reset this
    
    question.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'option';
        optionElement.textContent = option;
        optionElement.onclick = () => selectOption(index, optionElement);
        optionsContainer.appendChild(optionElement);
    });
    
    document.getElementById('hintArea').textContent = `Category: ${question.category} | ${question.hint}`;
    
    document.getElementById('submitBtn').disabled = true;
    document.getElementById('nextBtn').disabled = true;
    
    resetTimer();
}

        function nextQuestion() {
            if (gameState.currentQuestion < 10) {
                gameState.currentQuestion++;
                updateGameDisplay();
                loadQuestion();
            } else {
                completeLevel();
            }
        }function completeLevel() {
    console.log('üéØ Level completion triggered');
    
    clearInterval(gameState.levelTimerInterval);
    clearInterval(gameState.timerInterval);
    
    // Calculate performance
    const totalQuestions = 10;
    const correctAnswers = gameState.correctAnswers;
    const missedQuestions = totalQuestions - correctAnswers;
    const accuracy = (correctAnswers / totalQuestions) * 100;
    
    // Calculate earnings with penalty for missed questions
    const baseBonus = 250;
    const penaltyPerMiss = 25; // 25 iKbp deducted per wrong answer
    const levelBonus = Math.max(0, baseBonus - (missedQuestions * penaltyPerMiss));
    
    let celebrationEmoji = "üéâ";
    let celebrationMessage = "";
    
    if (accuracy === 100) {
        celebrationEmoji = "üèÜ";
        celebrationMessage = "Perfect score! Full 250 iKbp bonus!";
    } else if (accuracy >= 80) {
        celebrationEmoji = "‚≠ê";
        celebrationMessage = `Great work! ${correctAnswers}/10 correct`;
    } else if (accuracy >= 60) {
        celebrationEmoji = "üëç";
        celebrationMessage = `Good effort! ${correctAnswers}/10 correct`;
    } else {
        celebrationEmoji = "üí™";
        celebrationMessage = `Keep practicing! ${correctAnswers}/10 correct`;
    }
    
    // Award proportional bonus for TAU members
    if (gameState.playMode === 'member' && !gameState.completedLevels.includes(gameState.currentLevel)) {
        
        // Add the proportional bonus
        iKbpTracker.addEarnings(levelBonus, gameState.currentLevel, `Level ${gameState.currentLevel} completion`);
        
        gameState.completedLevels.push(gameState.currentLevel);
        gameState.completedLevels.sort((a, b) => a - b);
        
        iKbpTracker.saveToStorage();
        
        // Show detailed breakdown
        const questionEarnings = correctAnswers * 25; // 25 per correct
        const totalLevelEarnings = questionEarnings + levelBonus;
        
        document.getElementById('resultEarnings').innerHTML = 
            `<div style="background: rgba(67, 97, 238, 0.2); padding: 15px; border-radius: 10px; margin: 15px 0;">
                <div style="font-size: 1.8rem; color: #f7a440; margin-bottom: 10px;">
                    üí∞ Level ${gameState.currentLevel} Earnings
                </div>
                <div style="text-align: left; color: #f1f1f1; margin: 10px 0;">
                    ‚úÖ Correct Answers: ${correctAnswers}/10 √ó 25 = <strong>${questionEarnings} iKbp</strong><br>
                    ${missedQuestions > 0 ? 
                        `‚ùå Missed Questions: ${missedQuestions} √ó -25 = <strong style="color: #ef476f">-${missedQuestions * 25} iKbp penalty</strong><br>` 
                        : ''}
                    üéÅ Level Bonus: <strong style="color: ${levelBonus === baseBonus ? '#4cc9f0' : '#f7a440'}">${levelBonus} iKbp</strong> ${levelBonus < baseBonus ? '(reduced)' : ''}
                </div>
                <div style="font-size: 1.5rem; color: #4cc9f0; border-top: 2px solid rgba(255,255,255,0.2); padding-top: 10px; margin-top: 10px;">
                    üìä Total This Level: <strong>${totalLevelEarnings} iKbp</strong>
                </div>
                <div style="font-size: 1.2rem; color: #f7d560; margin-top: 10px;">
                    üíé Lifetime Total: <strong>${iKbpTracker.getTotalEarned()} iKbp</strong>
                </div>
            </div>`;
            
    } else if (gameState.playMode === 'guest') {
        document.getElementById('resultEarnings').innerHTML = 
            `<div style="padding: 15px;">
                Playing as Guest - No earnings<br>
                <small>You answered ${correctAnswers}/10 correctly. Register with TAU to earn iKbp!</small>
            </div>`;
    } else {
        document.getElementById('resultEarnings').innerHTML = 
            `Already completed this level<br>
            <small>Earnings claimed previously</small>`;
    }
    
    const levelDot = document.getElementById(`level${gameState.currentLevel}`);
    if (levelDot) levelDot.classList.add('completed');
    
    if  (gameState.currentLevel >= 20) {
    completeGame();
    return;
}
    if (gameState.currentLevel === 10) {
    setTimeout(() => {
        alert(`üéì Stage 1 Complete!\n\nWeldone Your journey to Pan African awakening has begun , continue.\n\n‚ö° Stage 2 Unlocked: Levels 11-20\n\nDeeper knowledge awaits: Kemet, colonization, resources, spirituality, and advanced African history!`);
    }, 500);
            }
    
    document.getElementById('resultTitle').textContent = `Level ${gameState.currentLevel} Complete! ${celebrationEmoji}`;
    document.getElementById('resultMessage').innerHTML = celebrationMessage;
    document.getElementById('finalScore').textContent = gameState.score;
    document.getElementById('celebrationEmoji').textContent = celebrationEmoji;
    document.getElementById('nextLevelBtn').textContent = `Proceed to Level ${gameState.currentLevel + 1}`;
    // ============================================
    // ACHIEVEMENT INTEGRATION - ADD THIS
    // ============================================
    
    // Update rank
    updateRank(gameState.currentLevel);
    
    // Check for badge unlocks
    const isPerfect = correctAnswers === 10;
    const completionTime = 60 - (gameState.levelTimer || 0);
    checkBadgeUnlock(gameState.currentLevel, isPerfect, completionTime);
    
    // Check if we should show certificate
    const shouldShowCertificate = (gameState.currentLevel === 10 || gameState.currentLevel === 20);
    
    if (shouldShowCertificate) {
        // Delay certificate to show after result modal
        setTimeout(() => {
            const stage = gameState.currentLevel === 10 ? 1 : 2;
            showCertificate(stage, gameState.currentLevel);
        }, 3000); // Show 3 seconds after result modal
    }
    // Play level completion sound
    SOUNDS.levelUp();
    
    document.getElementById('resultModal').style.display = 'flex';
    
    console.log('‚úÖ Level completion modal displayed');
        }
        function restartGame() {
            document.getElementById('gameCompleteModal').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            
            document.querySelectorAll('.level-dot').forEach(dot => {
                dot.classList.remove('active', 'completed');
            });
            
            gameState.gameStarted = false;
            gameState.currentLevel = 1;
            gameState.score = 0;
        }

        function updateGameDisplay() {
            document.getElementById('currentLevel').textContent = gameState.currentLevel;
            document.getElementById('currentQuestion').textContent = `${gameState.currentQuestion}/10`;
            document.getElementById('levelDisplay').textContent = gameState.currentLevel;
            document.getElementById('questionNumber').textContent = gameState.currentQuestion;
            document.getElementById('score').textContent = gameState.score;
            
            updateLevelIndicator();
        }

        function updateLevelIndicator() {
            document.querySelectorAll('.level-dot').forEach(dot => {
                dot.classList.remove('active');
            });
            
            const currentLevelDot = document.getElementById(`level${gameState.currentLevel}`);
            if (currentLevelDot) {
                currentLevelDot.classList.add('active');
            }
        }

        function startTimer() {
            gameState.timer = 30;
            updateTimerDisplay();
            
            clearInterval(gameState.timerInterval);
            gameState.timerInterval = setInterval(() => {
                gameState.timer--;
                updateTimerDisplay();
                
                if (gameState.timer <= 0) {
                    clearInterval(gameState.timerInterval);
                    if (gameState.selectedOption === null && !gameState.answerSubmitted) {
                        submitAnswer();
                    }
                }
            }, 1000);
        }

        function resetTimer() {
            gameState.timer = 30;
            updateTimerDisplay();
            startTimer();
        }

        function updateTimerDisplay() {
            const timerElement = document.getElementById('timer');
            if (gameState.timer <= 10) {
                timerElement.style.color = '#ef476f';
            } else if (gameState.timer <= 20) {
                timerElement.style.color = '#f7a440';
            } else {
                timerElement.style.color = '#4cc9f0';
            }
            timerElement.textContent = `${gameState.timer}s`;
        }

        function getDifficultyText(level) {
    if (level <= 2) return "Easy";
    if (level <= 4) return "Medium";
    if (level <= 7) return "Hard";
    if (level <= 10) return "Expert";
    if (level <= 13) return "Master";
    if (level <= 16) return "Advanced Master";
    if (level <= 19) return "Elite";
    return "Legendary";
}

        // TAU Integration Functions
        function selectMode(mode) {
    gameState.playMode = mode;
    
    document.querySelectorAll('.mode-card').forEach(card => {
        card.classList.remove('selected');
    });
    event.target.closest('.mode-card').classList.add('selected');
    
    document.getElementById('startBtn').disabled = false;
    
    if (mode === 'member') {
        const urlParams = new URLSearchParams(window.location.search);
        gameState.memberId = urlParams.get('memberId') || prompt('Enter your TAU Member ID:') || 'TEMP_' + Date.now();
        
        iKbpTracker.loadFromStorage();
        
        // UPDATED: Check for 20 levels instead of 10
        if (gameState.completedLevels.length >= 20) {
            document.getElementById('totalEarnedComplete').textContent = iKbpTracker.getTotalEarned();
            document.getElementById('alreadyCompletedModal').style.display = 'flex';
            return;
        }
        
        document.getElementById('tauMemberBanner').style.display = 'flex';
        document.getElementById('guestBanner').style.display = 'none';
        document.getElementById('earningsDisplay').style.display = 'block';
        document.getElementById('memberInfo').textContent = `Member ID: ${gameState.memberId} | Completed: ${gameState.completedLevels.length}/20 levels`;
    } else {
        document.getElementById('tauMemberBanner').style.display = 'none';
        document.getElementById('guestBanner').style.display = 'flex';
        document.getElementById('earningsDisplay').style.display = 'none';
    }
}  // ‚Üê ONLY ONE CLOSING BRACE!
                                                                                                             
        
        function openTAUApp() {
            window.open('https://magero1985.github.io/Tau-Africa/', '_blank');
        }

        function registerWithTAU() {
            if (confirm('Join TAU Africa to start earning iKbp rewards while learning!\n\nProceed to registration?')) {
                window.open('https://magero1985.github.io/Tau-Africa/', '_blank');
            }
        }

        function joinTAUEcosystem() {
            window.open('https://magero1985.github.io/Tau-Africa/', '_blank');
        }

        function playAsGuest() {
            closeModal('alreadyCompletedModal');
            gameState.playMode = 'guest';
            gameState.completedLevels = [];
            document.getElementById('startScreen').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        window.onload = function() {
    initGame();
    
    // Initialize achievement system
    initBadges();
    updateRank(1);
    
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('memberId')) {
        selectMode('member');
    }
    
    console.log('‚úÖ Game initialized with achievement system');
    console.log('üéÆ Sound enabled:', gameState.soundEnabled);
    console.log('üèÖ Badges earned:', gameState.earnedBadges.length);
};

// Update gameState with timer properties if not already present
if (!gameState.hasOwnProperty('levelTimer')) {
    gameState.levelTimer = 60;
    gameState.levelTimerInterval = null;
    gameState.levelTimeoutCount = 0;
    console.log('‚úÖ Added timer properties to gameState');
}
// REPLACE completeGame function:
function completeGame() {
    console.log('üèÜ Game completion triggered!');
    
    clearInterval(gameState.levelTimerInterval);
    clearInterval(gameState.timerInterval);
    
    const totalEarned = iKbpTracker.getTotalEarned();
    const pendingSync = iKbpTracker.getPendingSync();
    
    if (gameState.playMode === 'member') {
        document.getElementById('completionEarnings').innerHTML = 
            `<div style="margin-bottom: 20px;">
                <div style="font-size: 3rem; margin-bottom: 15px;">üéì</div>
                <div style="font-size: 1.8rem; color: #4cc9f0; margin-bottom: 15px;">
                    <strong>All 10 Levels Complete!</strong>
                </div>
            </div>
            <div style="background: rgba(67, 97, 238, 0.2); padding: 20px; border-radius: 15px; margin: 20px 0;">
                <div style="font-size: 2rem; color: #f7a440; margin-bottom: 15px;">
                    üí∞ Total Earned: <strong>${totalEarned} iKbp</strong>
                </div>
                ${pendingSync > 0 ? 
                    `<div style="font-size: 1.3rem; color: #4cc9f0; margin-top: 10px;">
                        üîÑ Pending Sync: <strong>${pendingSync} iKbp</strong>
                    </div>` 
                    : 
                    `<div style="font-size: 1.1rem; color: #2ecc71; margin-top: 10px;">
                        ‚úÖ All earnings synced!
                    </div>`
                }
            </div>
            <div style="color: #f7d560; margin-top: 15px;">
                ${pendingSync > 0 ? 
                    'üëâ Click "Sync to TAU" below to transfer your earnings!' 
                    : 
                    'üéâ Your earnings are in your TAU account. Levels 11-20 coming soon!'
                }
            </div>`;
    } else {
        document.getElementById('completionEarnings').innerHTML = 
            `<div style="margin-bottom: 20px;">
                <div style="font-size: 1.8rem; color: #4cc9f0; margin-bottom: 15px;">
                    <strong>Congratulations! All Levels Completed!</strong>
                </div>
            </div>
            <span style="color: #f7d560;">
                Playing as Guest - Register with TAU to earn rewards next time!
            </span>`;
    }
    
    // UPDATE: Show modal with sync button
    const modalButtonsDiv = document.querySelector('#gameCompleteModal .modal-content > div:last-child');
    if (modalButtonsDiv) {
        modalButtonsDiv.innerHTML = `
            ${gameState.playMode === 'member' && pendingSync > 0 ? 
                `<button class="btn btn-start" onclick="syncEarningsToTAU()" style="background: linear-gradient(90deg, #2ecc71, #27ae60);">
                    üîÑ Sync ${pendingSync} iKbp to TAU
                </button>`
                : ''
            }
            <button class="btn btn-start" onclick="joinTAUEcosystem()">
                Join TAU Ecosystem
            </button>
            <button class="btn btn-next" onclick="restartGame()">
                Play Again
            </button>
        `;
    }
    // Play final achievement anthem
    SOUNDS.anthem();
    
    // Show final certificate after a delay
    setTimeout(() => {
        showCertificate(2, 20);
    }, 2000);
    document.getElementById('gameCompleteModal').style.display = 'flex';
}
function nextLevel() {
    console.log('üîç nextLevel() called - Current level:', gameState.currentLevel);
    
    const modal = document.getElementById('resultModal');
    if (modal) {
        modal.style.display = 'none';
    }
    
    gameState.currentLevel++;
    console.log('üìà Incremented to level:', gameState.currentLevel);
    
    // Check if member already completed this level
    if (gameState.playMode === 'member' && gameState.completedLevels.includes(gameState.currentLevel)) {
        console.log('‚ö†Ô∏è Level already completed, finding next...');
        alert(`‚ö†Ô∏è Level ${gameState.currentLevel} Already Completed!\n\nYou've already earned rewards for this level.\n\nSkipping to next uncompleted level...`);
        
        // Find next uncompleted level
        let foundNext = false;
        for (let i = gameState.currentLevel; i <= 20; i++) {  // FIXED: 20 levels
            if (!gameState.completedLevels.includes(i)) {
                gameState.currentLevel = i;
                foundNext = true;
                console.log('‚úÖ Found uncompleted level:', i);
                break;
            }
        }
        
        if (!foundNext) {
            console.log('üèÜ All levels complete!');
            completeGame();
            return;
        }
    }
    
    // Reset for new level
    gameState.currentQuestion = 1;
    gameState.questionsAnswered = 0;
    gameState.correctAnswers = 0;
    gameState.selectedOption = null;
    gameState.correctAnswer = null;
    gameState.answerSubmitted = false;
    gameState.levelEarnings = 0;
    
    updateGameDisplay();
    loadQuestion();
    
    if (typeof startLevelTimer === 'function') {
        startLevelTimer();
    }
    
    console.log('‚úÖ Successfully advanced to level', gameState.currentLevel);
    // Update rank for new level
    updateRank(gameState.currentLevel);
    
    // Play level start sound
    if (gameState.soundEnabled) {
        playTone(440, 100);
    }
        }
// ========================================
// LEVEL TIMER FUNCTIONS - NEW
// ========================================
function startLevelTimer() {
    gameState.levelTimer = 60;
    updateLevelTimerDisplay();
    
    clearInterval(gameState.levelTimerInterval);
    gameState.levelTimerInterval = setInterval(() => {
        gameState.levelTimer--;
        updateLevelTimerDisplay();
        
        if (gameState.levelTimer <= 0) {
            clearInterval(gameState.levelTimerInterval);
            handleLevelTimeout();
        }
    }, 1000);
        }

function updateLevelTimerDisplay() {
    const timerElement = document.getElementById('levelTimer');
    if (!timerElement) return;
    
    const minutes = Math.floor(gameState.levelTimer / 60);
    const seconds = gameState.levelTimer % 60;
    const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    timerElement.textContent = timeString;
    
    if (gameState.levelTimer <= 10) {
        timerElement.style.color = '#ef476f';
    } else if (gameState.levelTimer <= 30) {
        timerElement.style.color = '#f7a440';
    } else {
        timerElement.style.color = '#4cc9f0';
    }
}

function handleLevelTimeout() {
    alert('√¢¬è¬∞ Time\'s up! Level timeout. Restarting level.');
    
    gameState.currentQuestion = 1;
    gameState.questionsAnswered = 0;
    gameState.correctAnswers = 0;
    gameState.levelEarnings = 0;
    
    updateGameDisplay();
    loadQuestion();
    startLevelTimer();
}
window.restartCurrentLevel = function() {
    gameState.currentQuestion = 1;
    gameState.questionsAnswered = 0;
    gameState.correctAnswers = 0;
    gameState.selectedOption = null;
    gameState.correctAnswer = null;
    gameState.answerSubmitted = false;
    gameState.levelEarnings = 0;
    
    updateGameDisplay();
    loadQuestion();
    startLevelTimer();
};

window.restartFromBeginning = function() {
    gameState.currentLevel = 1;
    gameState.currentQuestion = 1;
    gameState.score = 0;
    gameState.questionsAnswered = 0;
    gameState.correctAnswers = 0;
    gameState.levelEarnings = 0;
    gameState.levelTimeoutCount = 0;
    
    document.querySelectorAll('.level-dot').forEach(dot => {
        dot.classList.remove('active', 'completed');
    });
    
    updateGameDisplay();
    loadQuestion();
    startLevelTimer();
};

// ========================================
// OVERRIDE EXISTING FUNCTIONS
// ========================================

// Override startGame to include timer
const originalStartGame = window.startGame;
window.startGame = function() {
    if (originalStartGame) originalStartGame();
    
    gameState.levelTimeoutCount = 0;
    
    // Start level timer if timer element exists
    if (document.getElementById('levelTimer')) {
        startLevelTimer();
    }
    
    console.log('üéÆ Game started with timer');
};

// Override submitAnswer to track earnings properly
const originalSubmitAnswer = window.submitAnswer;
window.submitAnswer = function() {
    if (gameState.selectedOption === null || gameState.answerSubmitted) return;
    
    gameState.answerSubmitted = true;
    
    const options = document.querySelectorAll('.option');
    const correctIndex = gameState.correctAnswer;
    
    if (window.answerTimeout) {
        clearTimeout(window.answerTimeout);
        window.answerTimeout = null;
    }
    
    options.forEach((option, index) => {
        option.classList.add('disabled');
        if (index === correctIndex) {
            option.classList.add('correct');
        } else if (index === gameState.selectedOption && index !== correctIndex) {
            option.classList.add('wrong');
        }
    });
    
    const difficultyMultiplier = gameState.difficultyMultipliers[gameState.currentLevel - 1];
    const basePoints = 100;
    
    if (gameState.selectedOption === correctIndex) {
        gameState.correctAnswers++;
        const pointsEarned = Math.round(basePoints * difficultyMultiplier);
        gameState.score += pointsEarned;
        
        // Award iKbp for correct answers (members only)
        if (gameState.playMode === 'member') {
            const iKbpEarned = 25;
            gameState.levelEarnings += iKbpEarned;
            
            const levelEl = document.getElementById('levelEarnings');
            if (levelEl) levelEl.textContent = gameState.levelEarnings;
            
            document.getElementById('hintArea').innerHTML = 
                `<span style="color: #4cc9f0">‚úì Correct! +${pointsEarned} points | +${iKbpEarned} iKbp</span>`;
            
            console.log(`‚úÖ Earned ${iKbpEarned} iKbp (Total this level: ${gameState.levelEarnings})`);
        } else {
            document.getElementById('hintArea').innerHTML = 
                `<span style="color: #4cc9f0">‚úì Correct! +${pointsEarned} points</span>`;
        }
    } else {
        document.getElementById('hintArea').innerHTML = 
            `<span style="color: #ef476f">‚úó Incorrect. The correct answer was: ${options[correctIndex].textContent}</span>`;
    }
    
    gameState.questionsAnswered++;
    document.getElementById('score').textContent = gameState.score;
    
    document.getElementById('submitBtn').disabled = true;
    document.getElementById('nextBtn').disabled = false;
    
    clearInterval(gameState.timerInterval);
    
    setTimeout(() => {
        if (gameState.currentQuestion < 10) {
            nextQuestion();
        } else {
            completeLevel();
        }
    }, 2000);
};

// ========================================
// ENHANCED SYNC FUNCTION
// ========================================
window.syncEarningsToTAU = function() {
    const totalEarned = iKbpTracker.getTotalEarned();
    
    console.log('üîÑ Attempting to sync:', totalEarned, 'iKbp');
    
    if (totalEarned === 0) {
        alert('‚ùå No earnings to sync yet!\n\nTips:\n‚Ä¢ Make sure you selected "TAU Member" mode\n‚Ä¢ Complete some levels to earn iKbp\n‚Ä¢ Each correct answer = 25 iKbp\n‚Ä¢ Level completion = 250 iKbp bonus');
        return;
    }
    
    const syncData = {
        memberId: gameState.memberId,
        totalEarned: totalEarned,
        levelEarnings: iKbpTracker.levelEarnings,
        completedLevels: gameState.completedLevels,
        timestamp: new Date().toISOString(),
        source: 'knowledge_challenge',
        appVersion: '1.0'
    };
    
    localStorage.setItem('tauSyncData', JSON.stringify(syncData));
    
    const breakdown = Object.entries(iKbpTracker.levelEarnings)
        .map(([level, amt]) => `Level ${level}: ${amt} iKbp`)
        .join('\n');
    
    const syncParams = new URLSearchParams({
        sync: 'true',
        memberId: gameState.memberId,
        earned: totalEarned,
        source: 'knowledge',
        timestamp: Date.now()
    });
    
    alert(`‚úÖ ${totalEarned} iKbp prepared for sync!\n\nBreakdown:\n${breakdown}\n\nRedirecting to TAU app...`);
    
    setTimeout(() => {
        window.open(`https://magero1985.github.io/Tau-Africa/?${syncParams.toString()}`, '_blank');
    }, 1000);
};

console.log('‚úÖ All function overrides loaded successfully!');
        // ============================================
// SOUND SYSTEM - ADD THIS
// ============================================

function playTone(frequency, duration) {
    if (!gameState.soundEnabled) return;
    
    try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration / 1000);
    } catch (e) {
        console.log('Audio not supported:', e);
    }
}

function playMelody(frequencies, duration) {
    frequencies.forEach((freq, index) => {
        setTimeout(() => playTone(freq, duration), index * duration);
    });
}

function playKenyanAnthem() {
    // Simplified "Ee Mungu Nguvu Yetu" first verse melody
    const melody = [
        { freq: 392, dur: 400 },  // G - Ee
        { freq: 440, dur: 400 },  // A - Mun
        { freq: 494, dur: 400 },  // B - gu
        { freq: 523, dur: 600 },  // C - Ngu
        { freq: 494, dur: 400 },  // B - vu
        { freq: 440, dur: 400 },  // A - Ye
        { freq: 392, dur: 800 },  // G - tu
        { freq: 349, dur: 400 },  // F
        { freq: 392, dur: 400 },  // G
        { freq: 440, dur: 600 }   // A
    ];
    
    if (!gameState.soundEnabled) return;
    
    let totalTime = 0;
    melody.forEach((note) => {
        setTimeout(() => playTone(note.freq, note.dur), totalTime);
        totalTime += note.dur;
    });
}

const SOUNDS = {
    correct: () => playTone(523.25, 150),           // C note
    wrong: () => playTone(220, 300),                // A note
    levelUp: () => playMelody([523.25, 659.25, 783.99], 200),
    achievement: () => playMelody([523.25, 659.25, 783.99, 1046.50], 150),
    anthem: () => playKenyanAnthem()
};

function toggleSound() {
    gameState.soundEnabled = !gameState.soundEnabled;
    const toggleBtn = document.getElementById('soundToggle');
    if (toggleBtn) {
        toggleBtn.textContent = gameState.soundEnabled ? 'üîä' : 'üîá';
    }
    
    // Play confirmation sound
    if (gameState.soundEnabled) {
        playTone(523.25, 100);
    }
    
    console.log('üîä Sound', gameState.soundEnabled ? 'enabled' : 'disabled');
        }
        // ============================================
// RANK SYSTEM - ADD THIS
// ============================================

function updateRank(level) {
    const rankKeys = Object.keys(RANKS).map(Number).sort((a,b) => a-b);
    let currentRank = RANKS[1];
    
    for (let rankLevel of rankKeys) {
        if (level >= rankLevel) {
            currentRank = RANKS[rankLevel];
        }
    }
    
    gameState.currentRank = currentRank.name;
    
    document.getElementById('rankIcon').textContent = currentRank.icon;
    document.getElementById('rankTitle').textContent = currentRank.name;
    document.getElementById('rankDescription').textContent = currentRank.description;
    document.getElementById('progressText').textContent = `Level ${level}/20`;
    
    // Find next rank
    const nextRankLevel = rankKeys.find(l => l > level);
    if (nextRankLevel) {
        const nextRank = RANKS[nextRankLevel];
        document.getElementById('nextRankText').textContent = 
            `Next: ${nextRank.name} at Level ${nextRankLevel}`;
    } else {
        document.getElementById('nextRankText').textContent = 'üèÜ Maximum rank achieved!';
    }
    
    // Show the achievement showcase
    document.getElementById('achievementShowcase').style.display = 'block';
    
    console.log('üìä Rank updated:', currentRank.name);
}

// ============================================
// BADGE SYSTEM - ADD THIS
// ============================================

function initBadges() {
    const container = document.getElementById('badgesContainer');
    if (!container) return;
    
    container.innerHTML = '';
    
    BADGES.forEach(badge => {
        const isEarned = gameState.earnedBadges.includes(badge.id);
        const badgeEl = document.createElement('div');
        badgeEl.className = 'badge' + (isEarned ? '' : ' locked');
        badgeEl.innerHTML = `
            ${badge.icon}
            <div class="badge-tooltip">${badge.name}</div>
        `;
        container.appendChild(badgeEl);
    });
    
    console.log('üèÖ Badges initialized:', gameState.earnedBadges.length, 'earned');
}

function checkBadgeUnlock(level, isPerfect, completionTime) {
    const newBadges = [];
    
    // First level badge
    if (level === 1 && !gameState.earnedBadges.includes('first_level')) {
        newBadges.push('first_level');
    }
    
    // Perfect score badge
    if (isPerfect && !gameState.earnedBadges.includes('perfect_level')) {
        newBadges.push('perfect_level');
    }
    
    // Stage 1 complete badge
    if (level === 10 && !gameState.earnedBadges.includes('stage1_complete')) {
        newBadges.push('stage1_complete');
    }
    
    // Stage 2 unlock badge
    if (level === 11 && !gameState.earnedBadges.includes('stage2_unlock')) {
        newBadges.push('stage2_unlock');
    }
    
    // Speed demon badge (completed in under 30 seconds)
    if (completionTime < 30 && !gameState.earnedBadges.includes('speed_demon')) {
        newBadges.push('speed_demon');
    }
    
    // Scholar badge
    if (level === 15 && !gameState.earnedBadges.includes('scholar')) {
        newBadges.push('scholar');
    }
    
    // Ultimate badge
    if (level === 20 && !gameState.earnedBadges.includes('ultimate')) {
        newBadges.push('ultimate');
    }
    
    // Award new badges
    newBadges.forEach(badgeId => {
        gameState.earnedBadges.push(badgeId);
        SOUNDS.achievement();
        showBadgeUnlock(badgeId);
    });
    
    // Save to storage
    if (newBadges.length > 0) {
        iKbpTracker.saveToStorage();
    }
    
    // Refresh badge display
    initBadges();
}

function showBadgeUnlock(badgeId) {
    const badge = BADGES.find(b => b.id === badgeId);
    if (!badge) return;
    
    setTimeout(() => {
        alert(`üèÜ BADGE UNLOCKED!\n\n${badge.icon} ${badge.name}\n\nYour collection grows!`);
    }, 500);
}

// ============================================
// CERTIFICATE SYSTEM - ADD THIS
// ============================================

function showCertificate(stage, level) {
    const rankKeys = Object.keys(RANKS).map(Number).sort((a,b) => a-b);
    let rankName = RANKS[1].name;
    
    for (let rankLevel of rankKeys) {
        if (level >= rankLevel) {
            rankName = RANKS[rankLevel].name;
        }
    }
    
    // Set certificate details
    const memberIdDisplay = gameState.memberId || 'Guest Player';
    document.getElementById('certificateRecipient').textContent = memberIdDisplay;
    document.getElementById('certificateStage').textContent = `Stage ${stage}`;
    document.getElementById('certificateRank').textContent = rankName;
    document.getElementById('certificateDate').textContent = new Date().toLocaleDateString();
    
    // Show modal
    document.getElementById('certificateModal').style.display = 'flex';
    
    // Play special sound
    if (level === 20) {
        SOUNDS.anthem();
    } else {
        SOUNDS.achievement();
    }
    
    console.log('üìú Certificate shown for stage', stage);
}

function closeCertificate() {
    document.getElementById('certificateModal').style.display = 'none';
}

function downloadCertificate() {
    alert('üì• Certificate Download\n\n' +
          'In the full production version, this would:\n\n' +
          '‚Ä¢ Generate a PDF certificate\n' +
          '‚Ä¢ Include TAU Africa official seal\n' +
          '‚Ä¢ Add iKbp verification QR code\n' +
          '‚Ä¢ Include unique certificate number\n' +
          '‚Ä¢ Add your achievement details\n\n' +
          'For now, take a screenshot of your certificate!');
        }
console.log('üìä iKbpTracker ready:', iKbpTracker.getTotalEarned(), 'iKbp');
    </script>
</body>
    </html>
